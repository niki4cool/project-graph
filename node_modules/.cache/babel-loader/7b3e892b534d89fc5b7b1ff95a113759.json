{"ast":null,"code":"/**\n * 3dof (Gear VR, Daydream) controls for mobile.\n */\nmodule.exports = AFRAME.registerComponent('trackpad-controls', {\n  schema: {\n    enabled: {\n      default: true\n    },\n    enableNegX: {\n      default: true\n    },\n    enablePosX: {\n      default: true\n    },\n    enableNegZ: {\n      default: true\n    },\n    enablePosZ: {\n      default: true\n    },\n    mode: {\n      default: 'touch',\n      oneOf: ['swipe', 'touch', 'press']\n    }\n  },\n  init: function init() {\n    this.dVelocity = new THREE.Vector3();\n    this.zVel = 0;\n    this.xVel = 0;\n    this.bindMethods();\n  },\n  play: function play() {\n    this.addEventListeners();\n  },\n  pause: function pause() {\n    this.removeEventListeners();\n    this.dVelocity.set(0, 0, 0);\n  },\n  remove: function remove() {\n    this.pause();\n  },\n  addEventListeners: function addEventListeners() {\n    var data = this.data;\n    var sceneEl = this.el.sceneEl;\n    sceneEl.addEventListener('axismove', this.onAxisMove);\n\n    switch (data.mode) {\n      case 'swipe':\n      case 'touch':\n        sceneEl.addEventListener('trackpadtouchstart', this.onTouchStart);\n        sceneEl.addEventListener('trackpadtouchend', this.onTouchEnd);\n        break;\n\n      case 'press':\n        sceneEl.addEventListener('trackpaddown', this.onTouchStart);\n        sceneEl.addEventListener('trackpadup', this.onTouchEnd);\n        break;\n    }\n  },\n  removeEventListeners: function removeEventListeners() {\n    var sceneEl = this.el.sceneEl;\n    sceneEl.removeEventListener('axismove', this.onAxisMove);\n    sceneEl.removeEventListener('trackpadtouchstart', this.onTouchStart);\n    sceneEl.removeEventListener('trackpadtouchend', this.onTouchEnd);\n    sceneEl.removeEventListener('trackpaddown', this.onTouchStart);\n    sceneEl.removeEventListener('trackpadup', this.onTouchEnd);\n  },\n  isVelocityActive: function isVelocityActive() {\n    return this.data.enabled && this.isMoving;\n  },\n  getVelocityDelta: function getVelocityDelta() {\n    this.dVelocity.z = this.isMoving ? -this.zVel : 1;\n    this.dVelocity.x = this.isMoving ? this.xVel : 1;\n    return this.dVelocity.clone();\n  },\n  bindMethods: function bindMethods() {\n    this.onTouchStart = this.onTouchStart.bind(this);\n    this.onTouchEnd = this.onTouchEnd.bind(this);\n    this.onAxisMove = this.onAxisMove.bind(this);\n  },\n  onTouchStart: function onTouchStart(e) {\n    switch (this.data.mode) {\n      case 'swipe':\n        this.canRecordAxis = true;\n        this.startingAxisData = [];\n        break;\n\n      case 'touch':\n        this.isMoving = true;\n        break;\n\n      case 'press':\n        this.isMoving = true;\n        break;\n    }\n\n    e.preventDefault();\n  },\n  onTouchEnd: function onTouchEnd(e) {\n    if (this.data.mode == 'swipe') {\n      this.startingAxisData = [];\n    }\n\n    this.isMoving = false;\n    e.preventDefault();\n  },\n  onAxisMove: function onAxisMove(e) {\n    switch (this.data.mode) {\n      case 'swipe':\n        return this.handleSwipeAxis(e);\n\n      case 'touch':\n      case 'press':\n        return this.handleTouchAxis(e);\n    }\n  },\n  handleSwipeAxis: function handleSwipeAxis(e) {\n    var data = this.data;\n    var axisData = e.detail.axis;\n\n    if (this.startingAxisData.length === 0 && this.canRecordAxis) {\n      this.canRecordAxis = false;\n      this.startingAxisData[0] = axisData[0];\n      this.startingAxisData[1] = axisData[1];\n    }\n\n    if (this.startingAxisData.length > 0) {\n      var velX = 0;\n      var velZ = 0;\n\n      if (data.enableNegX && axisData[0] < this.startingAxisData[0]) {\n        velX = -1;\n      }\n\n      if (data.enablePosX && axisData[0] > this.startingAxisData[0]) {\n        velX = 1;\n      }\n\n      if (data.enablePosZ && axisData[1] > this.startingAxisData[1]) {\n        velZ = -1;\n      }\n\n      if (data.enableNegZ && axisData[1] < this.startingAxisData[1]) {\n        velZ = 1;\n      }\n\n      var absChangeZ = Math.abs(this.startingAxisData[1] - axisData[1]);\n      var absChangeX = Math.abs(this.startingAxisData[0] - axisData[0]);\n\n      if (absChangeX > absChangeZ) {\n        this.zVel = 0;\n        this.xVel = velX;\n        this.isMoving = true;\n      } else {\n        this.xVel = 0;\n        this.zVel = velZ;\n        this.isMoving = true;\n      }\n    }\n  },\n  handleTouchAxis: function handleTouchAxis(e) {\n    var data = this.data;\n    var axisData = e.detail.axis;\n    var velX = 0;\n    var velZ = 0;\n\n    if (data.enableNegX && axisData[0] < 0) {\n      velX = -1;\n    }\n\n    if (data.enablePosX && axisData[0] > 0) {\n      velX = 1;\n    }\n\n    if (data.enablePosZ && axisData[1] > 0) {\n      velZ = -1;\n    }\n\n    if (data.enableNegZ && axisData[1] < 0) {\n      velZ = 1;\n    }\n\n    if (Math.abs(axisData[0]) > Math.abs(axisData[1])) {\n      this.zVel = 0;\n      this.xVel = velX;\n    } else {\n      this.xVel = 0;\n      this.zVel = velZ;\n    }\n  }\n});","map":{"version":3,"names":["module","exports","AFRAME","registerComponent","schema","enabled","default","enableNegX","enablePosX","enableNegZ","enablePosZ","mode","oneOf","init","dVelocity","THREE","Vector3","zVel","xVel","bindMethods","play","addEventListeners","pause","removeEventListeners","set","remove","data","sceneEl","el","addEventListener","onAxisMove","onTouchStart","onTouchEnd","removeEventListener","isVelocityActive","isMoving","getVelocityDelta","z","x","clone","bind","e","canRecordAxis","startingAxisData","preventDefault","handleSwipeAxis","handleTouchAxis","axisData","detail","axis","length","velX","velZ","absChangeZ","Math","abs","absChangeX"],"sources":["X:/Project/back/node_modules/aframe-extras/src/controls/trackpad-controls.js"],"sourcesContent":["/**\n * 3dof (Gear VR, Daydream) controls for mobile.\n */\nmodule.exports = AFRAME.registerComponent('trackpad-controls', {\n  schema: {\n    enabled: { default: true },\n    enableNegX: { default: true },\n    enablePosX: { default: true },\n    enableNegZ: { default: true },\n    enablePosZ: { default: true },\n    mode: { default: 'touch', oneOf: ['swipe', 'touch', 'press'] }\n\n  },\n\n  init: function () {\n    this.dVelocity = new THREE.Vector3();\n    this.zVel      = 0;\n    this.xVel      = 0;\n    this.bindMethods();\n  },\n\n  play: function () {\n    this.addEventListeners();\n  },\n\n  pause: function () {\n    this.removeEventListeners();\n    this.dVelocity.set(0, 0, 0);\n  },\n\n  remove: function () {\n    this.pause();\n  },\n\n  addEventListeners: function () {\n    const data = this.data;\n    const sceneEl = this.el.sceneEl;\n\n    sceneEl.addEventListener('axismove', this.onAxisMove);\n\n    switch (data.mode) {\n      case 'swipe':\n      case 'touch':\n        sceneEl.addEventListener('trackpadtouchstart', this.onTouchStart);\n        sceneEl.addEventListener('trackpadtouchend', this.onTouchEnd);\n        break;\n\n      case 'press':\n        sceneEl.addEventListener('trackpaddown', this.onTouchStart);\n        sceneEl.addEventListener('trackpadup', this.onTouchEnd);\n        break;\n    }\n\n  },\n\n  removeEventListeners: function () {\n    const sceneEl = this.el.sceneEl;\n\n    sceneEl.removeEventListener('axismove', this.onAxisMove);\n    sceneEl.removeEventListener('trackpadtouchstart', this.onTouchStart);\n    sceneEl.removeEventListener('trackpadtouchend', this.onTouchEnd);\n    sceneEl.removeEventListener('trackpaddown', this.onTouchStart);\n    sceneEl.removeEventListener('trackpadup', this.onTouchEnd);\n  },\n\n  isVelocityActive: function () {\n    return this.data.enabled && this.isMoving;\n  },\n\n  getVelocityDelta: function () {\n    this.dVelocity.z = this.isMoving ? -this.zVel : 1;\n    this.dVelocity.x = this.isMoving ? this.xVel : 1;\n    return this.dVelocity.clone();\n  },\n\n  bindMethods: function () {\n    this.onTouchStart = this.onTouchStart.bind(this);\n    this.onTouchEnd = this.onTouchEnd.bind(this);\n    this.onAxisMove = this.onAxisMove.bind(this);\n  },\n\n  onTouchStart: function (e) {\n    switch(this.data.mode){\n      case 'swipe':\n        this.canRecordAxis = true;\n        this.startingAxisData = [];\n        break;\n      case 'touch':\n        this.isMoving = true;\n        break;\n      case 'press':\n        this.isMoving = true;\n        break;\n    }\n\n    e.preventDefault();\n  },\n\n  onTouchEnd: function (e) {\n    if(this.data.mode == 'swipe') {\n        this.startingAxisData = [];\n    }\n\n    this.isMoving = false;\n    e.preventDefault();\n  },\n\n  onAxisMove: function(e){\n    switch (this.data.mode) {\n      case 'swipe':\n        return this.handleSwipeAxis(e);\n      case 'touch':\n      case 'press':\n        return this.handleTouchAxis(e);\n    }\n  },\n\n  handleSwipeAxis: function(e) {\n    const data = this.data;\n    const axisData = e.detail.axis;\n\n    if(this.startingAxisData.length === 0 && this.canRecordAxis){\n      this.canRecordAxis = false;\n      this.startingAxisData[0] = axisData[0];\n      this.startingAxisData[1] = axisData[1];\n    }\n\n    if(this.startingAxisData.length > 0){\n      let velX = 0;\n      let velZ = 0;\n\n      if (data.enableNegX && axisData[0] < this.startingAxisData[0]) {\n        velX = -1;\n      }\n\n      if (data.enablePosX && axisData[0] > this.startingAxisData[0]) {\n        velX = 1;\n      }\n\n      if (data.enablePosZ && axisData[1] > this.startingAxisData[1]) {\n        velZ = -1;\n      }\n\n      if (data.enableNegZ && axisData[1] < this.startingAxisData[1]) {\n        velZ = 1;\n      }\n\n      const absChangeZ  = Math.abs(this.startingAxisData[1] - axisData[1]);\n      const absChangeX  = Math.abs(this.startingAxisData[0] - axisData[0]);\n\n      if (absChangeX > absChangeZ) {\n        this.zVel = 0;\n        this.xVel = velX;\n        this.isMoving = true;\n      } else {\n        this.xVel = 0;\n        this.zVel = velZ;\n        this.isMoving = true;\n      }\n\n    }\n  },\n\n  handleTouchAxis: function(e) {\n    const data = this.data;\n    const axisData = e.detail.axis;\n\n    let velX = 0;\n    let velZ = 0;\n\n    if (data.enableNegX && axisData[0] < 0) {\n      velX = -1;\n    }\n\n    if (data.enablePosX && axisData[0] > 0) {\n      velX = 1;\n    }\n\n    if (data.enablePosZ && axisData[1] > 0) {\n      velZ = -1;\n    }\n\n    if (data.enableNegZ && axisData[1] < 0) {\n      velZ = 1;\n    }\n\n    if (Math.abs(axisData[0]) > Math.abs(axisData[1])) {\n      this.zVel = 0;\n      this.xVel = velX;\n    } else {\n      this.xVel = 0;\n      this.zVel = velZ;\n    }\n\n  }\n\n});\n\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}