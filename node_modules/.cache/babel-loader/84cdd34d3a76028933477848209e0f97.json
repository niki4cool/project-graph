{"ast":null,"code":"module.exports = function eventify(subject) {\n  validateSubject(subject);\n  var eventsStorage = createEventsStorage(subject);\n  subject.on = eventsStorage.on;\n  subject.off = eventsStorage.off;\n  subject.fire = eventsStorage.fire;\n  return subject;\n};\n\nfunction createEventsStorage(subject) {\n  // Store all event listeners to this hash. Key is event name, value is array\n  // of callback records.\n  //\n  // A callback record consists of callback function and its optional context:\n  // { 'eventName' => [{callback: function, ctx: object}] }\n  var registeredEvents = Object.create(null);\n  return {\n    on: function on(eventName, callback, ctx) {\n      if (typeof callback !== 'function') {\n        throw new Error('callback is expected to be a function');\n      }\n\n      var handlers = registeredEvents[eventName];\n\n      if (!handlers) {\n        handlers = registeredEvents[eventName] = [];\n      }\n\n      handlers.push({\n        callback: callback,\n        ctx: ctx\n      });\n      return subject;\n    },\n    off: function off(eventName, callback) {\n      var wantToRemoveAll = typeof eventName === 'undefined';\n\n      if (wantToRemoveAll) {\n        // Killing old events storage should be enough in this case:\n        registeredEvents = Object.create(null);\n        return subject;\n      }\n\n      if (registeredEvents[eventName]) {\n        var deleteAllCallbacksForEvent = typeof callback !== 'function';\n\n        if (deleteAllCallbacksForEvent) {\n          delete registeredEvents[eventName];\n        } else {\n          var callbacks = registeredEvents[eventName];\n\n          for (var i = 0; i < callbacks.length; ++i) {\n            if (callbacks[i].callback === callback) {\n              callbacks.splice(i, 1);\n            }\n          }\n        }\n      }\n\n      return subject;\n    },\n    fire: function fire(eventName) {\n      var callbacks = registeredEvents[eventName];\n\n      if (!callbacks) {\n        return subject;\n      }\n\n      var fireArguments;\n\n      if (arguments.length > 1) {\n        fireArguments = Array.prototype.splice.call(arguments, 1);\n      }\n\n      for (var i = 0; i < callbacks.length; ++i) {\n        var callbackInfo = callbacks[i];\n        callbackInfo.callback.apply(callbackInfo.ctx, fireArguments);\n      }\n\n      return subject;\n    }\n  };\n}\n\nfunction validateSubject(subject) {\n  if (!subject) {\n    throw new Error('Eventify cannot use falsy object as events subject');\n  }\n\n  var reservedWords = ['on', 'fire', 'off'];\n\n  for (var i = 0; i < reservedWords.length; ++i) {\n    if (subject.hasOwnProperty(reservedWords[i])) {\n      throw new Error(\"Subject cannot be eventified, since it already has property '\" + reservedWords[i] + \"'\");\n    }\n  }\n}","map":{"version":3,"names":["module","exports","eventify","subject","validateSubject","eventsStorage","createEventsStorage","on","off","fire","registeredEvents","Object","create","eventName","callback","ctx","Error","handlers","push","wantToRemoveAll","deleteAllCallbacksForEvent","callbacks","i","length","splice","fireArguments","arguments","Array","prototype","call","callbackInfo","apply","reservedWords","hasOwnProperty"],"sources":["X:/Project/graph/node_modules/ngraph.events/index.js"],"sourcesContent":["module.exports = function eventify(subject) {\n  validateSubject(subject);\n\n  var eventsStorage = createEventsStorage(subject);\n  subject.on = eventsStorage.on;\n  subject.off = eventsStorage.off;\n  subject.fire = eventsStorage.fire;\n  return subject;\n};\n\nfunction createEventsStorage(subject) {\n  // Store all event listeners to this hash. Key is event name, value is array\n  // of callback records.\n  //\n  // A callback record consists of callback function and its optional context:\n  // { 'eventName' => [{callback: function, ctx: object}] }\n  var registeredEvents = Object.create(null);\n\n  return {\n    on: function (eventName, callback, ctx) {\n      if (typeof callback !== 'function') {\n        throw new Error('callback is expected to be a function');\n      }\n      var handlers = registeredEvents[eventName];\n      if (!handlers) {\n        handlers = registeredEvents[eventName] = [];\n      }\n      handlers.push({callback: callback, ctx: ctx});\n\n      return subject;\n    },\n\n    off: function (eventName, callback) {\n      var wantToRemoveAll = (typeof eventName === 'undefined');\n      if (wantToRemoveAll) {\n        // Killing old events storage should be enough in this case:\n        registeredEvents = Object.create(null);\n        return subject;\n      }\n\n      if (registeredEvents[eventName]) {\n        var deleteAllCallbacksForEvent = (typeof callback !== 'function');\n        if (deleteAllCallbacksForEvent) {\n          delete registeredEvents[eventName];\n        } else {\n          var callbacks = registeredEvents[eventName];\n          for (var i = 0; i < callbacks.length; ++i) {\n            if (callbacks[i].callback === callback) {\n              callbacks.splice(i, 1);\n            }\n          }\n        }\n      }\n\n      return subject;\n    },\n\n    fire: function (eventName) {\n      var callbacks = registeredEvents[eventName];\n      if (!callbacks) {\n        return subject;\n      }\n\n      var fireArguments;\n      if (arguments.length > 1) {\n        fireArguments = Array.prototype.splice.call(arguments, 1);\n      }\n      for(var i = 0; i < callbacks.length; ++i) {\n        var callbackInfo = callbacks[i];\n        callbackInfo.callback.apply(callbackInfo.ctx, fireArguments);\n      }\n\n      return subject;\n    }\n  };\n}\n\nfunction validateSubject(subject) {\n  if (!subject) {\n    throw new Error('Eventify cannot use falsy object as events subject');\n  }\n  var reservedWords = ['on', 'fire', 'off'];\n  for (var i = 0; i < reservedWords.length; ++i) {\n    if (subject.hasOwnProperty(reservedWords[i])) {\n      throw new Error(\"Subject cannot be eventified, since it already has property '\" + reservedWords[i] + \"'\");\n    }\n  }\n}\n"],"mappings":"AAAAA,MAAM,CAACC,OAAP,GAAiB,SAASC,QAAT,CAAkBC,OAAlB,EAA2B;EAC1CC,eAAe,CAACD,OAAD,CAAf;EAEA,IAAIE,aAAa,GAAGC,mBAAmB,CAACH,OAAD,CAAvC;EACAA,OAAO,CAACI,EAAR,GAAaF,aAAa,CAACE,EAA3B;EACAJ,OAAO,CAACK,GAAR,GAAcH,aAAa,CAACG,GAA5B;EACAL,OAAO,CAACM,IAAR,GAAeJ,aAAa,CAACI,IAA7B;EACA,OAAON,OAAP;AACD,CARD;;AAUA,SAASG,mBAAT,CAA6BH,OAA7B,EAAsC;EACpC;EACA;EACA;EACA;EACA;EACA,IAAIO,gBAAgB,GAAGC,MAAM,CAACC,MAAP,CAAc,IAAd,CAAvB;EAEA,OAAO;IACLL,EAAE,EAAE,YAAUM,SAAV,EAAqBC,QAArB,EAA+BC,GAA/B,EAAoC;MACtC,IAAI,OAAOD,QAAP,KAAoB,UAAxB,EAAoC;QAClC,MAAM,IAAIE,KAAJ,CAAU,uCAAV,CAAN;MACD;;MACD,IAAIC,QAAQ,GAAGP,gBAAgB,CAACG,SAAD,CAA/B;;MACA,IAAI,CAACI,QAAL,EAAe;QACbA,QAAQ,GAAGP,gBAAgB,CAACG,SAAD,CAAhB,GAA8B,EAAzC;MACD;;MACDI,QAAQ,CAACC,IAAT,CAAc;QAACJ,QAAQ,EAAEA,QAAX;QAAqBC,GAAG,EAAEA;MAA1B,CAAd;MAEA,OAAOZ,OAAP;IACD,CAZI;IAcLK,GAAG,EAAE,aAAUK,SAAV,EAAqBC,QAArB,EAA+B;MAClC,IAAIK,eAAe,GAAI,OAAON,SAAP,KAAqB,WAA5C;;MACA,IAAIM,eAAJ,EAAqB;QACnB;QACAT,gBAAgB,GAAGC,MAAM,CAACC,MAAP,CAAc,IAAd,CAAnB;QACA,OAAOT,OAAP;MACD;;MAED,IAAIO,gBAAgB,CAACG,SAAD,CAApB,EAAiC;QAC/B,IAAIO,0BAA0B,GAAI,OAAON,QAAP,KAAoB,UAAtD;;QACA,IAAIM,0BAAJ,EAAgC;UAC9B,OAAOV,gBAAgB,CAACG,SAAD,CAAvB;QACD,CAFD,MAEO;UACL,IAAIQ,SAAS,GAAGX,gBAAgB,CAACG,SAAD,CAAhC;;UACA,KAAK,IAAIS,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGD,SAAS,CAACE,MAA9B,EAAsC,EAAED,CAAxC,EAA2C;YACzC,IAAID,SAAS,CAACC,CAAD,CAAT,CAAaR,QAAb,KAA0BA,QAA9B,EAAwC;cACtCO,SAAS,CAACG,MAAV,CAAiBF,CAAjB,EAAoB,CAApB;YACD;UACF;QACF;MACF;;MAED,OAAOnB,OAAP;IACD,CArCI;IAuCLM,IAAI,EAAE,cAAUI,SAAV,EAAqB;MACzB,IAAIQ,SAAS,GAAGX,gBAAgB,CAACG,SAAD,CAAhC;;MACA,IAAI,CAACQ,SAAL,EAAgB;QACd,OAAOlB,OAAP;MACD;;MAED,IAAIsB,aAAJ;;MACA,IAAIC,SAAS,CAACH,MAAV,GAAmB,CAAvB,EAA0B;QACxBE,aAAa,GAAGE,KAAK,CAACC,SAAN,CAAgBJ,MAAhB,CAAuBK,IAAvB,CAA4BH,SAA5B,EAAuC,CAAvC,CAAhB;MACD;;MACD,KAAI,IAAIJ,CAAC,GAAG,CAAZ,EAAeA,CAAC,GAAGD,SAAS,CAACE,MAA7B,EAAqC,EAAED,CAAvC,EAA0C;QACxC,IAAIQ,YAAY,GAAGT,SAAS,CAACC,CAAD,CAA5B;QACAQ,YAAY,CAAChB,QAAb,CAAsBiB,KAAtB,CAA4BD,YAAY,CAACf,GAAzC,EAA8CU,aAA9C;MACD;;MAED,OAAOtB,OAAP;IACD;EAvDI,CAAP;AAyDD;;AAED,SAASC,eAAT,CAAyBD,OAAzB,EAAkC;EAChC,IAAI,CAACA,OAAL,EAAc;IACZ,MAAM,IAAIa,KAAJ,CAAU,oDAAV,CAAN;EACD;;EACD,IAAIgB,aAAa,GAAG,CAAC,IAAD,EAAO,MAAP,EAAe,KAAf,CAApB;;EACA,KAAK,IAAIV,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGU,aAAa,CAACT,MAAlC,EAA0C,EAAED,CAA5C,EAA+C;IAC7C,IAAInB,OAAO,CAAC8B,cAAR,CAAuBD,aAAa,CAACV,CAAD,CAApC,CAAJ,EAA8C;MAC5C,MAAM,IAAIN,KAAJ,CAAU,kEAAkEgB,aAAa,CAACV,CAAD,CAA/E,GAAqF,GAA/F,CAAN;IACD;EACF;AACF"},"metadata":{},"sourceType":"script"}