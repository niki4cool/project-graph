{"ast":null,"code":"import { AmbientLight, DirectionalLight, Vector3 } from 'three';\nimport { DragControls } from 'three/examples/jsm/controls/DragControls.js';\nimport ThreeForceGraph from 'three-forcegraph';\nimport ThreeRenderObjects from 'three-render-objects';\nimport accessorFn from 'accessor-fn';\nimport Kapsule from 'kapsule';\n\nfunction styleInject(css, ref) {\n  if (ref === void 0) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') {\n    return;\n  }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nvar css_248z = \".graph-info-msg {\\n  top: 50%;\\n  width: 100%;\\n  text-align: center;\\n  color: lavender;\\n  opacity: 0.7;\\n  font-size: 22px;\\n  position: absolute;\\n  font-family: Sans-serif;\\n}\\n\\n.scene-container .clickable {\\n  cursor: pointer;\\n}\\n\\n.scene-container .grabbable {\\n  cursor: move;\\n  cursor: grab;\\n  cursor: -moz-grab;\\n  cursor: -webkit-grab;\\n}\\n\\n.scene-container .grabbable:active {\\n  cursor: grabbing;\\n  cursor: -moz-grabbing;\\n  cursor: -webkit-grabbing;\\n}\";\nstyleInject(css_248z);\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    enumerableOnly && (symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    })), keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = null != arguments[i] ? arguments[i] : {};\n    i % 2 ? ownKeys(Object(source), !0).forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) {\n      Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n    });\n  }\n\n  return target;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\n\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction linkKapsule(kapsulePropName, kapsuleType) {\n  var dummyK = new kapsuleType(); // To extract defaults\n\n  return {\n    linkProp: function linkProp(prop) {\n      // link property config\n      return {\n        \"default\": dummyK[prop](),\n        onChange: function onChange(v, state) {\n          state[kapsulePropName][prop](v);\n        },\n        triggerUpdate: false\n      };\n    },\n    linkMethod: function linkMethod(method) {\n      // link method pass-through\n      return function (state) {\n        var kapsuleInstance = state[kapsulePropName];\n\n        for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n          args[_key - 1] = arguments[_key];\n        }\n\n        var returnVal = kapsuleInstance[method].apply(kapsuleInstance, args);\n        return returnVal === kapsuleInstance ? this // chain based on the parent object, not the inner kapsule\n        : returnVal;\n      };\n    }\n  };\n}\n\nvar three = window.THREE ? window.THREE // Prefer consumption from global THREE, if exists\n: {\n  AmbientLight: AmbientLight,\n  DirectionalLight: DirectionalLight,\n  Vector3: Vector3\n};\nvar CAMERA_DISTANCE2NODES_FACTOR = 170; //\n// Expose config from forceGraph\n\nvar bindFG = linkKapsule('forceGraph', ThreeForceGraph);\nvar linkedFGProps = Object.assign.apply(Object, _toConsumableArray(['jsonUrl', 'graphData', 'numDimensions', 'dagMode', 'dagLevelDistance', 'dagNodeFilter', 'onDagError', 'nodeRelSize', 'nodeId', 'nodeVal', 'nodeResolution', 'nodeColor', 'nodeAutoColorBy', 'nodeOpacity', 'nodeVisibility', 'nodeThreeObject', 'nodeThreeObjectExtend', 'linkSource', 'linkTarget', 'linkVisibility', 'linkColor', 'linkAutoColorBy', 'linkOpacity', 'linkWidth', 'linkResolution', 'linkCurvature', 'linkCurveRotation', 'linkMaterial', 'linkThreeObject', 'linkThreeObjectExtend', 'linkPositionUpdate', 'linkDirectionalArrowLength', 'linkDirectionalArrowColor', 'linkDirectionalArrowRelPos', 'linkDirectionalArrowResolution', 'linkDirectionalParticles', 'linkDirectionalParticleSpeed', 'linkDirectionalParticleWidth', 'linkDirectionalParticleColor', 'linkDirectionalParticleResolution', 'forceEngine', 'd3AlphaDecay', 'd3VelocityDecay', 'd3AlphaMin', 'ngraphPhysics', 'warmupTicks', 'cooldownTicks', 'cooldownTime', 'onEngineTick', 'onEngineStop'].map(function (p) {\n  return _defineProperty({}, p, bindFG.linkProp(p));\n})));\nvar linkedFGMethods = Object.assign.apply(Object, _toConsumableArray(['refresh', 'getGraphBbox', 'd3Force', 'd3ReheatSimulation', 'emitParticle'].map(function (p) {\n  return _defineProperty({}, p, bindFG.linkMethod(p));\n}))); // Expose config from renderObjs\n\nvar bindRenderObjs = linkKapsule('renderObjs', ThreeRenderObjects);\nvar linkedRenderObjsProps = Object.assign.apply(Object, _toConsumableArray(['width', 'height', 'backgroundColor', 'showNavInfo', 'enablePointerInteraction'].map(function (p) {\n  return _defineProperty({}, p, bindRenderObjs.linkProp(p));\n})));\nvar linkedRenderObjsMethods = Object.assign.apply(Object, _toConsumableArray(['cameraPosition', 'postProcessingComposer'].map(function (p) {\n  return _defineProperty({}, p, bindRenderObjs.linkMethod(p));\n})).concat([{\n  graph2ScreenCoords: bindRenderObjs.linkMethod('getScreenCoords'),\n  screen2GraphCoords: bindRenderObjs.linkMethod('getSceneCoords')\n}])); //\n\nvar _3dForceGraph = Kapsule({\n  props: _objectSpread2(_objectSpread2({\n    nodeLabel: {\n      \"default\": 'name',\n      triggerUpdate: false\n    },\n    linkLabel: {\n      \"default\": 'name',\n      triggerUpdate: false\n    },\n    linkHoverPrecision: {\n      \"default\": 1,\n      onChange: function onChange(p, state) {\n        return state.renderObjs.lineHoverPrecision(p);\n      },\n      triggerUpdate: false\n    },\n    enableNavigationControls: {\n      \"default\": true,\n      onChange: function onChange(enable, state) {\n        var controls = state.renderObjs.controls();\n\n        if (controls) {\n          controls.enabled = enable;\n        }\n      },\n      triggerUpdate: false\n    },\n    enableNodeDrag: {\n      \"default\": true,\n      triggerUpdate: false\n    },\n    onNodeDrag: {\n      \"default\": function _default() {},\n      triggerUpdate: false\n    },\n    onNodeDragEnd: {\n      \"default\": function _default() {},\n      triggerUpdate: false\n    },\n    onNodeClick: {\n      triggerUpdate: false\n    },\n    onNodeRightClick: {\n      triggerUpdate: false\n    },\n    onNodeHover: {\n      triggerUpdate: false\n    },\n    onLinkClick: {\n      triggerUpdate: false\n    },\n    onLinkRightClick: {\n      triggerUpdate: false\n    },\n    onLinkHover: {\n      triggerUpdate: false\n    },\n    onBackgroundClick: {\n      triggerUpdate: false\n    },\n    onBackgroundRightClick: {\n      triggerUpdate: false\n    }\n  }, linkedFGProps), linkedRenderObjsProps),\n  methods: _objectSpread2(_objectSpread2({\n    zoomToFit: function zoomToFit(state, transitionDuration, padding) {\n      var _state$forceGraph;\n\n      for (var _len = arguments.length, bboxArgs = new Array(_len > 3 ? _len - 3 : 0), _key = 3; _key < _len; _key++) {\n        bboxArgs[_key - 3] = arguments[_key];\n      }\n\n      state.renderObjs.fitToBbox((_state$forceGraph = state.forceGraph).getGraphBbox.apply(_state$forceGraph, bboxArgs), transitionDuration, padding);\n      return this;\n    },\n    pauseAnimation: function pauseAnimation(state) {\n      if (state.animationFrameRequestId !== null) {\n        cancelAnimationFrame(state.animationFrameRequestId);\n        state.animationFrameRequestId = null;\n      }\n\n      return this;\n    },\n    resumeAnimation: function resumeAnimation(state) {\n      if (state.animationFrameRequestId === null) {\n        this._animationCycle();\n      }\n\n      return this;\n    },\n    _animationCycle: function _animationCycle(state) {\n      if (state.enablePointerInteraction) {\n        // reset canvas cursor (override dragControls cursor)\n        this.renderer().domElement.style.cursor = null;\n      } // Frame cycle\n\n\n      state.forceGraph.tickFrame();\n      state.renderObjs.tick();\n      state.animationFrameRequestId = requestAnimationFrame(this._animationCycle);\n    },\n    scene: function scene(state) {\n      return state.renderObjs.scene();\n    },\n    // Expose scene\n    camera: function camera(state) {\n      return state.renderObjs.camera();\n    },\n    // Expose camera\n    renderer: function renderer(state) {\n      return state.renderObjs.renderer();\n    },\n    // Expose renderer\n    controls: function controls(state) {\n      return state.renderObjs.controls();\n    },\n    // Expose controls\n    tbControls: function tbControls(state) {\n      return state.renderObjs.tbControls();\n    },\n    // To be deprecated\n    _destructor: function _destructor() {\n      this.pauseAnimation();\n      this.graphData({\n        nodes: [],\n        links: []\n      });\n    }\n  }, linkedFGMethods), linkedRenderObjsMethods),\n  stateInit: function stateInit(_ref5) {\n    var controlType = _ref5.controlType,\n        rendererConfig = _ref5.rendererConfig,\n        extraRenderers = _ref5.extraRenderers;\n    return {\n      forceGraph: new ThreeForceGraph(),\n      renderObjs: ThreeRenderObjects({\n        controlType: controlType,\n        rendererConfig: rendererConfig,\n        extraRenderers: extraRenderers\n      })\n    };\n  },\n  init: function init(domNode, state) {\n    // Wipe DOM\n    domNode.innerHTML = ''; // Add relative container\n\n    domNode.appendChild(state.container = document.createElement('div'));\n    state.container.style.position = 'relative'; // Add renderObjs\n\n    var roDomNode = document.createElement('div');\n    state.container.appendChild(roDomNode);\n    state.renderObjs(roDomNode);\n    var camera = state.renderObjs.camera();\n    var renderer = state.renderObjs.renderer();\n    var controls = state.renderObjs.controls();\n    controls.enabled = !!state.enableNavigationControls;\n    state.lastSetCameraZ = camera.position.z; // Add info space\n\n    var infoElem;\n    state.container.appendChild(infoElem = document.createElement('div'));\n    infoElem.className = 'graph-info-msg';\n    infoElem.textContent = ''; // config forcegraph\n\n    state.forceGraph.onLoading(function () {\n      infoElem.textContent = 'Loading...';\n    }).onFinishLoading(function () {\n      infoElem.textContent = '';\n    }).onUpdate(function () {\n      // sync graph data structures\n      state.graphData = state.forceGraph.graphData(); // re-aim camera, if still in default position (not user modified)\n\n      if (camera.position.x === 0 && camera.position.y === 0 && camera.position.z === state.lastSetCameraZ && state.graphData.nodes.length) {\n        camera.lookAt(state.forceGraph.position);\n        state.lastSetCameraZ = camera.position.z = Math.cbrt(state.graphData.nodes.length) * CAMERA_DISTANCE2NODES_FACTOR;\n      }\n    }).onFinishUpdate(function () {\n      // Setup node drag interaction\n      if (state._dragControls) {\n        var curNodeDrag = state.graphData.nodes.find(function (node) {\n          return node.__initialFixedPos && !node.__disposeControlsAfterDrag;\n        }); // detect if there's a node being dragged using the existing drag controls\n\n        if (curNodeDrag) {\n          curNodeDrag.__disposeControlsAfterDrag = true; // postpone previous controls disposal until drag ends\n        } else {\n          state._dragControls.dispose(); // cancel previous drag controls\n\n        }\n\n        state._dragControls = undefined;\n      }\n\n      if (state.enableNodeDrag && state.enablePointerInteraction && state.forceEngine === 'd3') {\n        // Can't access node positions programatically in ngraph\n        var dragControls = state._dragControls = new DragControls(state.graphData.nodes.map(function (node) {\n          return node.__threeObj;\n        }).filter(function (obj) {\n          return obj;\n        }), camera, renderer.domElement);\n        dragControls.addEventListener('dragstart', function (event) {\n          controls.enabled = false; // Disable controls while dragging\n          // track drag object movement\n\n          event.object.__initialPos = event.object.position.clone();\n          event.object.__prevPos = event.object.position.clone();\n\n          var node = getGraphObj(event.object).__data;\n\n          !node.__initialFixedPos && (node.__initialFixedPos = {\n            fx: node.fx,\n            fy: node.fy,\n            fz: node.fz\n          });\n          !node.__initialPos && (node.__initialPos = {\n            x: node.x,\n            y: node.y,\n            z: node.z\n          }); // lock node\n\n          ['x', 'y', 'z'].forEach(function (c) {\n            return node[\"f\".concat(c)] = node[c];\n          }); // drag cursor\n\n          renderer.domElement.classList.add('grabbable');\n        });\n        dragControls.addEventListener('drag', function (event) {\n          var nodeObj = getGraphObj(event.object);\n\n          if (!event.object.hasOwnProperty('__graphObjType')) {\n            // If dragging a child of the node, update the node object instead\n            var initPos = event.object.__initialPos;\n            var prevPos = event.object.__prevPos;\n            var _newPos = event.object.position;\n            nodeObj.position.add(_newPos.clone().sub(prevPos)); // translate node object by the motion delta\n\n            prevPos.copy(_newPos);\n\n            _newPos.copy(initPos); // reset child back to its initial position\n\n          }\n\n          var node = nodeObj.__data;\n          var newPos = nodeObj.position;\n          var translate = {\n            x: newPos.x - node.x,\n            y: newPos.y - node.y,\n            z: newPos.z - node.z\n          }; // Move fx/fy/fz (and x/y/z) of nodes based on object new position\n\n          ['x', 'y', 'z'].forEach(function (c) {\n            return node[\"f\".concat(c)] = node[c] = newPos[c];\n          });\n          state.forceGraph.d3AlphaTarget(0.3) // keep engine running at low intensity throughout drag\n          .resetCountdown(); // prevent freeze while dragging\n\n          node.__dragged = true;\n          state.onNodeDrag(node, translate);\n        });\n        dragControls.addEventListener('dragend', function (event) {\n          delete event.object.__initialPos; // remove tracking attributes\n\n          delete event.object.__prevPos;\n\n          var node = getGraphObj(event.object).__data; // dispose previous controls if needed\n\n\n          if (node.__disposeControlsAfterDrag) {\n            dragControls.dispose();\n            delete node.__disposeControlsAfterDrag;\n          }\n\n          var initFixedPos = node.__initialFixedPos;\n          var initPos = node.__initialPos;\n          var translate = {\n            x: initPos.x - node.x,\n            y: initPos.y - node.y,\n            z: initPos.z - node.z\n          };\n\n          if (initFixedPos) {\n            ['x', 'y', 'z'].forEach(function (c) {\n              var fc = \"f\".concat(c);\n\n              if (initFixedPos[fc] === undefined) {\n                delete node[fc];\n              }\n            });\n            delete node.__initialFixedPos;\n            delete node.__initialPos;\n\n            if (node.__dragged) {\n              delete node.__dragged;\n              state.onNodeDragEnd(node, translate);\n            }\n          }\n\n          state.forceGraph.d3AlphaTarget(0) // release engine low intensity\n          .resetCountdown(); // let the engine readjust after releasing fixed nodes\n\n          if (state.enableNavigationControls) {\n            controls.enabled = true; // Re-enable controls\n\n            controls.domElement && controls.domElement.ownerDocument && controls.domElement.ownerDocument.dispatchEvent( // simulate mouseup to ensure the controls don't take over after dragend\n            new PointerEvent('pointerup', {\n              pointerType: 'touch'\n            }));\n          } // clear cursor\n\n\n          renderer.domElement.classList.remove('grabbable');\n        });\n      }\n    }); // config renderObjs\n\n    state.renderObjs.objects([// Populate scene\n    new three.AmbientLight(0xbbbbbb), new three.DirectionalLight(0xffffff, 0.6), state.forceGraph]).hoverOrderComparator(function (a, b) {\n      // Prioritize graph objects\n      var aObj = getGraphObj(a);\n      if (!aObj) return 1;\n      var bObj = getGraphObj(b);\n      if (!bObj) return -1; // Prioritize nodes over links\n\n      var isNode = function isNode(o) {\n        return o.__graphObjType === 'node';\n      };\n\n      return isNode(bObj) - isNode(aObj);\n    }).tooltipContent(function (obj) {\n      var graphObj = getGraphObj(obj);\n      return graphObj ? accessorFn(state[\"\".concat(graphObj.__graphObjType, \"Label\")])(graphObj.__data) || '' : '';\n    }).hoverDuringDrag(false).onHover(function (obj) {\n      // Update tooltip and trigger onHover events\n      var hoverObj = getGraphObj(obj);\n\n      if (hoverObj !== state.hoverObj) {\n        var prevObjType = state.hoverObj ? state.hoverObj.__graphObjType : null;\n        var prevObjData = state.hoverObj ? state.hoverObj.__data : null;\n        var objType = hoverObj ? hoverObj.__graphObjType : null;\n        var objData = hoverObj ? hoverObj.__data : null;\n\n        if (prevObjType && prevObjType !== objType) {\n          // Hover out\n          var fn = state[\"on\".concat(prevObjType === 'node' ? 'Node' : 'Link', \"Hover\")];\n          fn && fn(null, prevObjData);\n        }\n\n        if (objType) {\n          // Hover in\n          var _fn = state[\"on\".concat(objType === 'node' ? 'Node' : 'Link', \"Hover\")];\n          _fn && _fn(objData, prevObjType === objType ? prevObjData : null);\n        } // set pointer if hovered object is clickable\n\n\n        renderer.domElement.classList[hoverObj && state[\"on\".concat(objType === 'node' ? 'Node' : 'Link', \"Click\")] || !hoverObj && state.onBackgroundClick ? 'add' : 'remove']('clickable');\n        state.hoverObj = hoverObj;\n      }\n    }).clickAfterDrag(false).onClick(function (obj, ev) {\n      var graphObj = getGraphObj(obj);\n\n      if (graphObj) {\n        var fn = state[\"on\".concat(graphObj.__graphObjType === 'node' ? 'Node' : 'Link', \"Click\")];\n        fn && fn(graphObj.__data, ev);\n      } else {\n        state.onBackgroundClick && state.onBackgroundClick(ev);\n      }\n    }).onRightClick(function (obj, ev) {\n      // Handle right-click events\n      var graphObj = getGraphObj(obj);\n\n      if (graphObj) {\n        var fn = state[\"on\".concat(graphObj.__graphObjType === 'node' ? 'Node' : 'Link', \"RightClick\")];\n        fn && fn(graphObj.__data, ev);\n      } else {\n        state.onBackgroundRightClick && state.onBackgroundRightClick(ev);\n      }\n    }); //\n    // Kick-off renderer\n\n    this._animationCycle();\n  }\n}); //\n\n\nfunction getGraphObj(object) {\n  var obj = object; // recurse up object chain until finding the graph object\n\n  while (obj && !obj.hasOwnProperty('__graphObjType')) {\n    obj = obj.parent;\n  }\n\n  return obj;\n}\n\nexport { _3dForceGraph as default };","map":{"version":3,"names":["AmbientLight","DirectionalLight","Vector3","DragControls","ThreeForceGraph","ThreeRenderObjects","accessorFn","Kapsule","styleInject","css","ref","insertAt","document","head","getElementsByTagName","style","createElement","type","firstChild","insertBefore","appendChild","styleSheet","cssText","createTextNode","css_248z","ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread2","target","i","arguments","length","source","forEach","key","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","obj","value","configurable","writable","_toConsumableArray","arr","_arrayWithoutHoles","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","Array","isArray","_arrayLikeToArray","iter","Symbol","iterator","from","o","minLen","n","prototype","toString","call","slice","constructor","name","test","len","arr2","TypeError","linkKapsule","kapsulePropName","kapsuleType","dummyK","linkProp","prop","onChange","v","state","triggerUpdate","linkMethod","method","kapsuleInstance","_len","args","_key","returnVal","three","window","THREE","CAMERA_DISTANCE2NODES_FACTOR","bindFG","linkedFGProps","assign","map","p","linkedFGMethods","bindRenderObjs","linkedRenderObjsProps","linkedRenderObjsMethods","concat","graph2ScreenCoords","screen2GraphCoords","_3dForceGraph","props","nodeLabel","linkLabel","linkHoverPrecision","renderObjs","lineHoverPrecision","enableNavigationControls","enable","controls","enabled","enableNodeDrag","onNodeDrag","_default","onNodeDragEnd","onNodeClick","onNodeRightClick","onNodeHover","onLinkClick","onLinkRightClick","onLinkHover","onBackgroundClick","onBackgroundRightClick","methods","zoomToFit","transitionDuration","padding","_state$forceGraph","bboxArgs","fitToBbox","forceGraph","getGraphBbox","pauseAnimation","animationFrameRequestId","cancelAnimationFrame","resumeAnimation","_animationCycle","enablePointerInteraction","renderer","domElement","cursor","tickFrame","tick","requestAnimationFrame","scene","camera","tbControls","_destructor","graphData","nodes","links","stateInit","_ref5","controlType","rendererConfig","extraRenderers","init","domNode","innerHTML","container","position","roDomNode","lastSetCameraZ","z","infoElem","className","textContent","onLoading","onFinishLoading","onUpdate","x","y","lookAt","Math","cbrt","onFinishUpdate","_dragControls","curNodeDrag","find","node","__initialFixedPos","__disposeControlsAfterDrag","dispose","undefined","forceEngine","dragControls","__threeObj","addEventListener","event","__initialPos","clone","__prevPos","getGraphObj","__data","fx","fy","fz","c","classList","add","nodeObj","hasOwnProperty","initPos","prevPos","_newPos","sub","copy","newPos","translate","d3AlphaTarget","resetCountdown","__dragged","initFixedPos","fc","ownerDocument","dispatchEvent","PointerEvent","pointerType","remove","objects","hoverOrderComparator","a","b","aObj","bObj","isNode","__graphObjType","tooltipContent","graphObj","hoverDuringDrag","onHover","hoverObj","prevObjType","prevObjData","objType","objData","fn","_fn","clickAfterDrag","onClick","ev","onRightClick","parent","default"],"sources":["X:/Project/graph/node_modules/3d-force-graph/dist/3d-force-graph.module.js"],"sourcesContent":["import { AmbientLight, DirectionalLight, Vector3 } from 'three';\nimport { DragControls } from 'three/examples/jsm/controls/DragControls.js';\nimport ThreeForceGraph from 'three-forcegraph';\nimport ThreeRenderObjects from 'three-render-objects';\nimport accessorFn from 'accessor-fn';\nimport Kapsule from 'kapsule';\n\nfunction styleInject(css, ref) {\n  if (ref === void 0) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') {\n    return;\n  }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nvar css_248z = \".graph-info-msg {\\n  top: 50%;\\n  width: 100%;\\n  text-align: center;\\n  color: lavender;\\n  opacity: 0.7;\\n  font-size: 22px;\\n  position: absolute;\\n  font-family: Sans-serif;\\n}\\n\\n.scene-container .clickable {\\n  cursor: pointer;\\n}\\n\\n.scene-container .grabbable {\\n  cursor: move;\\n  cursor: grab;\\n  cursor: -moz-grab;\\n  cursor: -webkit-grab;\\n}\\n\\n.scene-container .grabbable:active {\\n  cursor: grabbing;\\n  cursor: -moz-grabbing;\\n  cursor: -webkit-grabbing;\\n}\";\nstyleInject(css_248z);\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    enumerableOnly && (symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    })), keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = null != arguments[i] ? arguments[i] : {};\n    i % 2 ? ownKeys(Object(source), !0).forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) {\n      Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n    });\n  }\n\n  return target;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\n\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n  return arr2;\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction linkKapsule (kapsulePropName, kapsuleType) {\n  var dummyK = new kapsuleType(); // To extract defaults\n\n  return {\n    linkProp: function linkProp(prop) {\n      // link property config\n      return {\n        \"default\": dummyK[prop](),\n        onChange: function onChange(v, state) {\n          state[kapsulePropName][prop](v);\n        },\n        triggerUpdate: false\n      };\n    },\n    linkMethod: function linkMethod(method) {\n      // link method pass-through\n      return function (state) {\n        var kapsuleInstance = state[kapsulePropName];\n\n        for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n          args[_key - 1] = arguments[_key];\n        }\n\n        var returnVal = kapsuleInstance[method].apply(kapsuleInstance, args);\n        return returnVal === kapsuleInstance ? this // chain based on the parent object, not the inner kapsule\n        : returnVal;\n      };\n    }\n  };\n}\n\nvar three = window.THREE ? window.THREE // Prefer consumption from global THREE, if exists\n: {\n  AmbientLight: AmbientLight,\n  DirectionalLight: DirectionalLight,\n  Vector3: Vector3\n};\n\nvar CAMERA_DISTANCE2NODES_FACTOR = 170; //\n// Expose config from forceGraph\n\nvar bindFG = linkKapsule('forceGraph', ThreeForceGraph);\nvar linkedFGProps = Object.assign.apply(Object, _toConsumableArray(['jsonUrl', 'graphData', 'numDimensions', 'dagMode', 'dagLevelDistance', 'dagNodeFilter', 'onDagError', 'nodeRelSize', 'nodeId', 'nodeVal', 'nodeResolution', 'nodeColor', 'nodeAutoColorBy', 'nodeOpacity', 'nodeVisibility', 'nodeThreeObject', 'nodeThreeObjectExtend', 'linkSource', 'linkTarget', 'linkVisibility', 'linkColor', 'linkAutoColorBy', 'linkOpacity', 'linkWidth', 'linkResolution', 'linkCurvature', 'linkCurveRotation', 'linkMaterial', 'linkThreeObject', 'linkThreeObjectExtend', 'linkPositionUpdate', 'linkDirectionalArrowLength', 'linkDirectionalArrowColor', 'linkDirectionalArrowRelPos', 'linkDirectionalArrowResolution', 'linkDirectionalParticles', 'linkDirectionalParticleSpeed', 'linkDirectionalParticleWidth', 'linkDirectionalParticleColor', 'linkDirectionalParticleResolution', 'forceEngine', 'd3AlphaDecay', 'd3VelocityDecay', 'd3AlphaMin', 'ngraphPhysics', 'warmupTicks', 'cooldownTicks', 'cooldownTime', 'onEngineTick', 'onEngineStop'].map(function (p) {\n  return _defineProperty({}, p, bindFG.linkProp(p));\n})));\nvar linkedFGMethods = Object.assign.apply(Object, _toConsumableArray(['refresh', 'getGraphBbox', 'd3Force', 'd3ReheatSimulation', 'emitParticle'].map(function (p) {\n  return _defineProperty({}, p, bindFG.linkMethod(p));\n}))); // Expose config from renderObjs\n\nvar bindRenderObjs = linkKapsule('renderObjs', ThreeRenderObjects);\nvar linkedRenderObjsProps = Object.assign.apply(Object, _toConsumableArray(['width', 'height', 'backgroundColor', 'showNavInfo', 'enablePointerInteraction'].map(function (p) {\n  return _defineProperty({}, p, bindRenderObjs.linkProp(p));\n})));\nvar linkedRenderObjsMethods = Object.assign.apply(Object, _toConsumableArray(['cameraPosition', 'postProcessingComposer'].map(function (p) {\n  return _defineProperty({}, p, bindRenderObjs.linkMethod(p));\n})).concat([{\n  graph2ScreenCoords: bindRenderObjs.linkMethod('getScreenCoords'),\n  screen2GraphCoords: bindRenderObjs.linkMethod('getSceneCoords')\n}])); //\n\nvar _3dForceGraph = Kapsule({\n  props: _objectSpread2(_objectSpread2({\n    nodeLabel: {\n      \"default\": 'name',\n      triggerUpdate: false\n    },\n    linkLabel: {\n      \"default\": 'name',\n      triggerUpdate: false\n    },\n    linkHoverPrecision: {\n      \"default\": 1,\n      onChange: function onChange(p, state) {\n        return state.renderObjs.lineHoverPrecision(p);\n      },\n      triggerUpdate: false\n    },\n    enableNavigationControls: {\n      \"default\": true,\n      onChange: function onChange(enable, state) {\n        var controls = state.renderObjs.controls();\n\n        if (controls) {\n          controls.enabled = enable;\n        }\n      },\n      triggerUpdate: false\n    },\n    enableNodeDrag: {\n      \"default\": true,\n      triggerUpdate: false\n    },\n    onNodeDrag: {\n      \"default\": function _default() {},\n      triggerUpdate: false\n    },\n    onNodeDragEnd: {\n      \"default\": function _default() {},\n      triggerUpdate: false\n    },\n    onNodeClick: {\n      triggerUpdate: false\n    },\n    onNodeRightClick: {\n      triggerUpdate: false\n    },\n    onNodeHover: {\n      triggerUpdate: false\n    },\n    onLinkClick: {\n      triggerUpdate: false\n    },\n    onLinkRightClick: {\n      triggerUpdate: false\n    },\n    onLinkHover: {\n      triggerUpdate: false\n    },\n    onBackgroundClick: {\n      triggerUpdate: false\n    },\n    onBackgroundRightClick: {\n      triggerUpdate: false\n    }\n  }, linkedFGProps), linkedRenderObjsProps),\n  methods: _objectSpread2(_objectSpread2({\n    zoomToFit: function zoomToFit(state, transitionDuration, padding) {\n      var _state$forceGraph;\n\n      for (var _len = arguments.length, bboxArgs = new Array(_len > 3 ? _len - 3 : 0), _key = 3; _key < _len; _key++) {\n        bboxArgs[_key - 3] = arguments[_key];\n      }\n\n      state.renderObjs.fitToBbox((_state$forceGraph = state.forceGraph).getGraphBbox.apply(_state$forceGraph, bboxArgs), transitionDuration, padding);\n      return this;\n    },\n    pauseAnimation: function pauseAnimation(state) {\n      if (state.animationFrameRequestId !== null) {\n        cancelAnimationFrame(state.animationFrameRequestId);\n        state.animationFrameRequestId = null;\n      }\n\n      return this;\n    },\n    resumeAnimation: function resumeAnimation(state) {\n      if (state.animationFrameRequestId === null) {\n        this._animationCycle();\n      }\n\n      return this;\n    },\n    _animationCycle: function _animationCycle(state) {\n      if (state.enablePointerInteraction) {\n        // reset canvas cursor (override dragControls cursor)\n        this.renderer().domElement.style.cursor = null;\n      } // Frame cycle\n\n\n      state.forceGraph.tickFrame();\n      state.renderObjs.tick();\n      state.animationFrameRequestId = requestAnimationFrame(this._animationCycle);\n    },\n    scene: function scene(state) {\n      return state.renderObjs.scene();\n    },\n    // Expose scene\n    camera: function camera(state) {\n      return state.renderObjs.camera();\n    },\n    // Expose camera\n    renderer: function renderer(state) {\n      return state.renderObjs.renderer();\n    },\n    // Expose renderer\n    controls: function controls(state) {\n      return state.renderObjs.controls();\n    },\n    // Expose controls\n    tbControls: function tbControls(state) {\n      return state.renderObjs.tbControls();\n    },\n    // To be deprecated\n    _destructor: function _destructor() {\n      this.pauseAnimation();\n      this.graphData({\n        nodes: [],\n        links: []\n      });\n    }\n  }, linkedFGMethods), linkedRenderObjsMethods),\n  stateInit: function stateInit(_ref5) {\n    var controlType = _ref5.controlType,\n        rendererConfig = _ref5.rendererConfig,\n        extraRenderers = _ref5.extraRenderers;\n    return {\n      forceGraph: new ThreeForceGraph(),\n      renderObjs: ThreeRenderObjects({\n        controlType: controlType,\n        rendererConfig: rendererConfig,\n        extraRenderers: extraRenderers\n      })\n    };\n  },\n  init: function init(domNode, state) {\n    // Wipe DOM\n    domNode.innerHTML = ''; // Add relative container\n\n    domNode.appendChild(state.container = document.createElement('div'));\n    state.container.style.position = 'relative'; // Add renderObjs\n\n    var roDomNode = document.createElement('div');\n    state.container.appendChild(roDomNode);\n    state.renderObjs(roDomNode);\n    var camera = state.renderObjs.camera();\n    var renderer = state.renderObjs.renderer();\n    var controls = state.renderObjs.controls();\n    controls.enabled = !!state.enableNavigationControls;\n    state.lastSetCameraZ = camera.position.z; // Add info space\n\n    var infoElem;\n    state.container.appendChild(infoElem = document.createElement('div'));\n    infoElem.className = 'graph-info-msg';\n    infoElem.textContent = ''; // config forcegraph\n\n    state.forceGraph.onLoading(function () {\n      infoElem.textContent = 'Loading...';\n    }).onFinishLoading(function () {\n      infoElem.textContent = '';\n    }).onUpdate(function () {\n      // sync graph data structures\n      state.graphData = state.forceGraph.graphData(); // re-aim camera, if still in default position (not user modified)\n\n      if (camera.position.x === 0 && camera.position.y === 0 && camera.position.z === state.lastSetCameraZ && state.graphData.nodes.length) {\n        camera.lookAt(state.forceGraph.position);\n        state.lastSetCameraZ = camera.position.z = Math.cbrt(state.graphData.nodes.length) * CAMERA_DISTANCE2NODES_FACTOR;\n      }\n    }).onFinishUpdate(function () {\n      // Setup node drag interaction\n      if (state._dragControls) {\n        var curNodeDrag = state.graphData.nodes.find(function (node) {\n          return node.__initialFixedPos && !node.__disposeControlsAfterDrag;\n        }); // detect if there's a node being dragged using the existing drag controls\n\n        if (curNodeDrag) {\n          curNodeDrag.__disposeControlsAfterDrag = true; // postpone previous controls disposal until drag ends\n        } else {\n          state._dragControls.dispose(); // cancel previous drag controls\n\n        }\n\n        state._dragControls = undefined;\n      }\n\n      if (state.enableNodeDrag && state.enablePointerInteraction && state.forceEngine === 'd3') {\n        // Can't access node positions programatically in ngraph\n        var dragControls = state._dragControls = new DragControls(state.graphData.nodes.map(function (node) {\n          return node.__threeObj;\n        }).filter(function (obj) {\n          return obj;\n        }), camera, renderer.domElement);\n        dragControls.addEventListener('dragstart', function (event) {\n          controls.enabled = false; // Disable controls while dragging\n          // track drag object movement\n\n          event.object.__initialPos = event.object.position.clone();\n          event.object.__prevPos = event.object.position.clone();\n\n          var node = getGraphObj(event.object).__data;\n\n          !node.__initialFixedPos && (node.__initialFixedPos = {\n            fx: node.fx,\n            fy: node.fy,\n            fz: node.fz\n          });\n          !node.__initialPos && (node.__initialPos = {\n            x: node.x,\n            y: node.y,\n            z: node.z\n          }); // lock node\n\n          ['x', 'y', 'z'].forEach(function (c) {\n            return node[\"f\".concat(c)] = node[c];\n          }); // drag cursor\n\n          renderer.domElement.classList.add('grabbable');\n        });\n        dragControls.addEventListener('drag', function (event) {\n          var nodeObj = getGraphObj(event.object);\n\n          if (!event.object.hasOwnProperty('__graphObjType')) {\n            // If dragging a child of the node, update the node object instead\n            var initPos = event.object.__initialPos;\n            var prevPos = event.object.__prevPos;\n            var _newPos = event.object.position;\n            nodeObj.position.add(_newPos.clone().sub(prevPos)); // translate node object by the motion delta\n\n            prevPos.copy(_newPos);\n\n            _newPos.copy(initPos); // reset child back to its initial position\n\n          }\n\n          var node = nodeObj.__data;\n          var newPos = nodeObj.position;\n          var translate = {\n            x: newPos.x - node.x,\n            y: newPos.y - node.y,\n            z: newPos.z - node.z\n          }; // Move fx/fy/fz (and x/y/z) of nodes based on object new position\n\n          ['x', 'y', 'z'].forEach(function (c) {\n            return node[\"f\".concat(c)] = node[c] = newPos[c];\n          });\n          state.forceGraph.d3AlphaTarget(0.3) // keep engine running at low intensity throughout drag\n          .resetCountdown(); // prevent freeze while dragging\n\n          node.__dragged = true;\n          state.onNodeDrag(node, translate);\n        });\n        dragControls.addEventListener('dragend', function (event) {\n          delete event.object.__initialPos; // remove tracking attributes\n\n          delete event.object.__prevPos;\n\n          var node = getGraphObj(event.object).__data; // dispose previous controls if needed\n\n\n          if (node.__disposeControlsAfterDrag) {\n            dragControls.dispose();\n            delete node.__disposeControlsAfterDrag;\n          }\n\n          var initFixedPos = node.__initialFixedPos;\n          var initPos = node.__initialPos;\n          var translate = {\n            x: initPos.x - node.x,\n            y: initPos.y - node.y,\n            z: initPos.z - node.z\n          };\n\n          if (initFixedPos) {\n            ['x', 'y', 'z'].forEach(function (c) {\n              var fc = \"f\".concat(c);\n\n              if (initFixedPos[fc] === undefined) {\n                delete node[fc];\n              }\n            });\n            delete node.__initialFixedPos;\n            delete node.__initialPos;\n\n            if (node.__dragged) {\n              delete node.__dragged;\n              state.onNodeDragEnd(node, translate);\n            }\n          }\n\n          state.forceGraph.d3AlphaTarget(0) // release engine low intensity\n          .resetCountdown(); // let the engine readjust after releasing fixed nodes\n\n          if (state.enableNavigationControls) {\n            controls.enabled = true; // Re-enable controls\n\n            controls.domElement && controls.domElement.ownerDocument && controls.domElement.ownerDocument.dispatchEvent( // simulate mouseup to ensure the controls don't take over after dragend\n            new PointerEvent('pointerup', {\n              pointerType: 'touch'\n            }));\n          } // clear cursor\n\n\n          renderer.domElement.classList.remove('grabbable');\n        });\n      }\n    }); // config renderObjs\n\n    state.renderObjs.objects([// Populate scene\n    new three.AmbientLight(0xbbbbbb), new three.DirectionalLight(0xffffff, 0.6), state.forceGraph]).hoverOrderComparator(function (a, b) {\n      // Prioritize graph objects\n      var aObj = getGraphObj(a);\n      if (!aObj) return 1;\n      var bObj = getGraphObj(b);\n      if (!bObj) return -1; // Prioritize nodes over links\n\n      var isNode = function isNode(o) {\n        return o.__graphObjType === 'node';\n      };\n\n      return isNode(bObj) - isNode(aObj);\n    }).tooltipContent(function (obj) {\n      var graphObj = getGraphObj(obj);\n      return graphObj ? accessorFn(state[\"\".concat(graphObj.__graphObjType, \"Label\")])(graphObj.__data) || '' : '';\n    }).hoverDuringDrag(false).onHover(function (obj) {\n      // Update tooltip and trigger onHover events\n      var hoverObj = getGraphObj(obj);\n\n      if (hoverObj !== state.hoverObj) {\n        var prevObjType = state.hoverObj ? state.hoverObj.__graphObjType : null;\n        var prevObjData = state.hoverObj ? state.hoverObj.__data : null;\n        var objType = hoverObj ? hoverObj.__graphObjType : null;\n        var objData = hoverObj ? hoverObj.__data : null;\n\n        if (prevObjType && prevObjType !== objType) {\n          // Hover out\n          var fn = state[\"on\".concat(prevObjType === 'node' ? 'Node' : 'Link', \"Hover\")];\n          fn && fn(null, prevObjData);\n        }\n\n        if (objType) {\n          // Hover in\n          var _fn = state[\"on\".concat(objType === 'node' ? 'Node' : 'Link', \"Hover\")];\n          _fn && _fn(objData, prevObjType === objType ? prevObjData : null);\n        } // set pointer if hovered object is clickable\n\n\n        renderer.domElement.classList[hoverObj && state[\"on\".concat(objType === 'node' ? 'Node' : 'Link', \"Click\")] || !hoverObj && state.onBackgroundClick ? 'add' : 'remove']('clickable');\n        state.hoverObj = hoverObj;\n      }\n    }).clickAfterDrag(false).onClick(function (obj, ev) {\n      var graphObj = getGraphObj(obj);\n\n      if (graphObj) {\n        var fn = state[\"on\".concat(graphObj.__graphObjType === 'node' ? 'Node' : 'Link', \"Click\")];\n        fn && fn(graphObj.__data, ev);\n      } else {\n        state.onBackgroundClick && state.onBackgroundClick(ev);\n      }\n    }).onRightClick(function (obj, ev) {\n      // Handle right-click events\n      var graphObj = getGraphObj(obj);\n\n      if (graphObj) {\n        var fn = state[\"on\".concat(graphObj.__graphObjType === 'node' ? 'Node' : 'Link', \"RightClick\")];\n        fn && fn(graphObj.__data, ev);\n      } else {\n        state.onBackgroundRightClick && state.onBackgroundRightClick(ev);\n      }\n    }); //\n    // Kick-off renderer\n\n    this._animationCycle();\n  }\n}); //\n\nfunction getGraphObj(object) {\n  var obj = object; // recurse up object chain until finding the graph object\n\n  while (obj && !obj.hasOwnProperty('__graphObjType')) {\n    obj = obj.parent;\n  }\n\n  return obj;\n}\n\nexport { _3dForceGraph as default };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}