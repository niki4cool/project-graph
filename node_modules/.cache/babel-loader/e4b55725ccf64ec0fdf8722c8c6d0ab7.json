{"ast":null,"code":"import { Bezier } from \"./bezier.js\"; // math-inlining.\n\nvar abs = Math.abs,\n    cos = Math.cos,\n    sin = Math.sin,\n    acos = Math.acos,\n    atan2 = Math.atan2,\n    sqrt = Math.sqrt,\n    pow = Math.pow; // cube root function yielding real roots\n\nfunction crt(v) {\n  return v < 0 ? -pow(-v, 1 / 3) : pow(v, 1 / 3);\n} // trig constants\n\n\nvar pi = Math.PI,\n    tau = 2 * pi,\n    quart = pi / 2,\n    // float precision significant decimal\nepsilon = 0.000001,\n    // extremas used in bbox calculation and similar algorithms\nnMax = Number.MAX_SAFE_INTEGER || 9007199254740991,\n    nMin = Number.MIN_SAFE_INTEGER || -9007199254740991,\n    // a zero coordinate, which is surprisingly useful\nZERO = {\n  x: 0,\n  y: 0,\n  z: 0\n}; // Bezier utility functions\n\nvar utils = {\n  // Legendre-Gauss abscissae with n=24 (x_i values, defined at i=n as the roots of the nth order Legendre polynomial Pn(x))\n  Tvalues: [-0.0640568928626056260850430826247450385909, 0.0640568928626056260850430826247450385909, -0.1911188674736163091586398207570696318404, 0.1911188674736163091586398207570696318404, -0.3150426796961633743867932913198102407864, 0.3150426796961633743867932913198102407864, -0.4337935076260451384870842319133497124524, 0.4337935076260451384870842319133497124524, -0.5454214713888395356583756172183723700107, 0.5454214713888395356583756172183723700107, -0.6480936519369755692524957869107476266696, 0.6480936519369755692524957869107476266696, -0.7401241915785543642438281030999784255232, 0.7401241915785543642438281030999784255232, -0.8200019859739029219539498726697452080761, 0.8200019859739029219539498726697452080761, -0.8864155270044010342131543419821967550873, 0.8864155270044010342131543419821967550873, -0.9382745520027327585236490017087214496548, 0.9382745520027327585236490017087214496548, -0.9747285559713094981983919930081690617411, 0.9747285559713094981983919930081690617411, -0.9951872199970213601799974097007368118745, 0.9951872199970213601799974097007368118745],\n  // Legendre-Gauss weights with n=24 (w_i values, defined by a function linked to in the Bezier primer article)\n  Cvalues: [0.1279381953467521569740561652246953718517, 0.1279381953467521569740561652246953718517, 0.1258374563468282961213753825111836887264, 0.1258374563468282961213753825111836887264, 0.121670472927803391204463153476262425607, 0.121670472927803391204463153476262425607, 0.1155056680537256013533444839067835598622, 0.1155056680537256013533444839067835598622, 0.1074442701159656347825773424466062227946, 0.1074442701159656347825773424466062227946, 0.0976186521041138882698806644642471544279, 0.0976186521041138882698806644642471544279, 0.086190161531953275917185202983742667185, 0.086190161531953275917185202983742667185, 0.0733464814110803057340336152531165181193, 0.0733464814110803057340336152531165181193, 0.0592985849154367807463677585001085845412, 0.0592985849154367807463677585001085845412, 0.0442774388174198061686027482113382288593, 0.0442774388174198061686027482113382288593, 0.0285313886289336631813078159518782864491, 0.0285313886289336631813078159518782864491, 0.0123412297999871995468056670700372915759, 0.0123412297999871995468056670700372915759],\n  arcfn: function arcfn(t, derivativeFn) {\n    var d = derivativeFn(t);\n    var l = d.x * d.x + d.y * d.y;\n\n    if (typeof d.z !== \"undefined\") {\n      l += d.z * d.z;\n    }\n\n    return sqrt(l);\n  },\n  compute: function compute(t, points, _3d) {\n    // shortcuts\n    if (t === 0) {\n      points[0].t = 0;\n      return points[0];\n    }\n\n    var order = points.length - 1;\n\n    if (t === 1) {\n      points[order].t = 1;\n      return points[order];\n    }\n\n    var mt = 1 - t;\n    var p = points; // constant?\n\n    if (order === 0) {\n      points[0].t = t;\n      return points[0];\n    } // linear?\n\n\n    if (order === 1) {\n      var ret = {\n        x: mt * p[0].x + t * p[1].x,\n        y: mt * p[0].y + t * p[1].y,\n        t: t\n      };\n\n      if (_3d) {\n        ret.z = mt * p[0].z + t * p[1].z;\n      }\n\n      return ret;\n    } // quadratic/cubic curve?\n\n\n    if (order < 4) {\n      var mt2 = mt * mt,\n          t2 = t * t,\n          a,\n          b,\n          c,\n          d = 0;\n\n      if (order === 2) {\n        p = [p[0], p[1], p[2], ZERO];\n        a = mt2;\n        b = mt * t * 2;\n        c = t2;\n      } else if (order === 3) {\n        a = mt2 * mt;\n        b = mt2 * t * 3;\n        c = mt * t2 * 3;\n        d = t * t2;\n      }\n\n      var _ret = {\n        x: a * p[0].x + b * p[1].x + c * p[2].x + d * p[3].x,\n        y: a * p[0].y + b * p[1].y + c * p[2].y + d * p[3].y,\n        t: t\n      };\n\n      if (_3d) {\n        _ret.z = a * p[0].z + b * p[1].z + c * p[2].z + d * p[3].z;\n      }\n\n      return _ret;\n    } // higher order curves: use de Casteljau's computation\n\n\n    var dCpts = JSON.parse(JSON.stringify(points));\n\n    while (dCpts.length > 1) {\n      for (var i = 0; i < dCpts.length - 1; i++) {\n        dCpts[i] = {\n          x: dCpts[i].x + (dCpts[i + 1].x - dCpts[i].x) * t,\n          y: dCpts[i].y + (dCpts[i + 1].y - dCpts[i].y) * t\n        };\n\n        if (typeof dCpts[i].z !== \"undefined\") {\n          dCpts[i] = dCpts[i].z + (dCpts[i + 1].z - dCpts[i].z) * t;\n        }\n      }\n\n      dCpts.splice(dCpts.length - 1, 1);\n    }\n\n    dCpts[0].t = t;\n    return dCpts[0];\n  },\n  computeWithRatios: function computeWithRatios(t, points, ratios, _3d) {\n    var mt = 1 - t,\n        r = ratios,\n        p = points;\n    var f1 = r[0],\n        f2 = r[1],\n        f3 = r[2],\n        f4 = r[3],\n        d; // spec for linear\n\n    f1 *= mt;\n    f2 *= t;\n\n    if (p.length === 2) {\n      d = f1 + f2;\n      return {\n        x: (f1 * p[0].x + f2 * p[1].x) / d,\n        y: (f1 * p[0].y + f2 * p[1].y) / d,\n        z: !_3d ? false : (f1 * p[0].z + f2 * p[1].z) / d,\n        t: t\n      };\n    } // upgrade to quadratic\n\n\n    f1 *= mt;\n    f2 *= 2 * mt;\n    f3 *= t * t;\n\n    if (p.length === 3) {\n      d = f1 + f2 + f3;\n      return {\n        x: (f1 * p[0].x + f2 * p[1].x + f3 * p[2].x) / d,\n        y: (f1 * p[0].y + f2 * p[1].y + f3 * p[2].y) / d,\n        z: !_3d ? false : (f1 * p[0].z + f2 * p[1].z + f3 * p[2].z) / d,\n        t: t\n      };\n    } // upgrade to cubic\n\n\n    f1 *= mt;\n    f2 *= 1.5 * mt;\n    f3 *= 3 * mt;\n    f4 *= t * t * t;\n\n    if (p.length === 4) {\n      d = f1 + f2 + f3 + f4;\n      return {\n        x: (f1 * p[0].x + f2 * p[1].x + f3 * p[2].x + f4 * p[3].x) / d,\n        y: (f1 * p[0].y + f2 * p[1].y + f3 * p[2].y + f4 * p[3].y) / d,\n        z: !_3d ? false : (f1 * p[0].z + f2 * p[1].z + f3 * p[2].z + f4 * p[3].z) / d,\n        t: t\n      };\n    }\n  },\n  derive: function derive(points, _3d) {\n    var dpoints = [];\n\n    for (var p = points, d = p.length, c = d - 1; d > 1; d--, c--) {\n      var list = [];\n\n      for (var j = 0, dpt; j < c; j++) {\n        dpt = {\n          x: c * (p[j + 1].x - p[j].x),\n          y: c * (p[j + 1].y - p[j].y)\n        };\n\n        if (_3d) {\n          dpt.z = c * (p[j + 1].z - p[j].z);\n        }\n\n        list.push(dpt);\n      }\n\n      dpoints.push(list);\n      p = list;\n    }\n\n    return dpoints;\n  },\n  between: function between(v, m, M) {\n    return m <= v && v <= M || utils.approximately(v, m) || utils.approximately(v, M);\n  },\n  approximately: function approximately(a, b, precision) {\n    return abs(a - b) <= (precision || epsilon);\n  },\n  length: function length(derivativeFn) {\n    var z = 0.5,\n        len = utils.Tvalues.length;\n    var sum = 0;\n\n    for (var i = 0, t; i < len; i++) {\n      t = z * utils.Tvalues[i] + z;\n      sum += utils.Cvalues[i] * utils.arcfn(t, derivativeFn);\n    }\n\n    return z * sum;\n  },\n  map: function map(v, ds, de, ts, te) {\n    var d1 = de - ds,\n        d2 = te - ts,\n        v2 = v - ds,\n        r = v2 / d1;\n    return ts + d2 * r;\n  },\n  lerp: function lerp(r, v1, v2) {\n    var ret = {\n      x: v1.x + r * (v2.x - v1.x),\n      y: v1.y + r * (v2.y - v1.y)\n    };\n\n    if (v1.z !== undefined && v2.z !== undefined) {\n      ret.z = v1.z + r * (v2.z - v1.z);\n    }\n\n    return ret;\n  },\n  pointToString: function pointToString(p) {\n    var s = p.x + \"/\" + p.y;\n\n    if (typeof p.z !== \"undefined\") {\n      s += \"/\" + p.z;\n    }\n\n    return s;\n  },\n  pointsToString: function pointsToString(points) {\n    return \"[\" + points.map(utils.pointToString).join(\", \") + \"]\";\n  },\n  copy: function copy(obj) {\n    return JSON.parse(JSON.stringify(obj));\n  },\n  angle: function angle(o, v1, v2) {\n    var dx1 = v1.x - o.x,\n        dy1 = v1.y - o.y,\n        dx2 = v2.x - o.x,\n        dy2 = v2.y - o.y,\n        cross = dx1 * dy2 - dy1 * dx2,\n        dot = dx1 * dx2 + dy1 * dy2;\n    return atan2(cross, dot);\n  },\n  // round as string, to avoid rounding errors\n  round: function round(v, d) {\n    var s = \"\" + v;\n    var pos = s.indexOf(\".\");\n    return parseFloat(s.substring(0, pos + 1 + d));\n  },\n  dist: function dist(p1, p2) {\n    var dx = p1.x - p2.x,\n        dy = p1.y - p2.y;\n    return sqrt(dx * dx + dy * dy);\n  },\n  closest: function closest(LUT, point) {\n    var mdist = pow(2, 63),\n        mpos,\n        d;\n    LUT.forEach(function (p, idx) {\n      d = utils.dist(point, p);\n\n      if (d < mdist) {\n        mdist = d;\n        mpos = idx;\n      }\n    });\n    return {\n      mdist: mdist,\n      mpos: mpos\n    };\n  },\n  abcratio: function abcratio(t, n) {\n    // see ratio(t) note on http://pomax.github.io/bezierinfo/#abc\n    if (n !== 2 && n !== 3) {\n      return false;\n    }\n\n    if (typeof t === \"undefined\") {\n      t = 0.5;\n    } else if (t === 0 || t === 1) {\n      return t;\n    }\n\n    var bottom = pow(t, n) + pow(1 - t, n),\n        top = bottom - 1;\n    return abs(top / bottom);\n  },\n  projectionratio: function projectionratio(t, n) {\n    // see u(t) note on http://pomax.github.io/bezierinfo/#abc\n    if (n !== 2 && n !== 3) {\n      return false;\n    }\n\n    if (typeof t === \"undefined\") {\n      t = 0.5;\n    } else if (t === 0 || t === 1) {\n      return t;\n    }\n\n    var top = pow(1 - t, n),\n        bottom = pow(t, n) + top;\n    return top / bottom;\n  },\n  lli8: function lli8(x1, y1, x2, y2, x3, y3, x4, y4) {\n    var nx = (x1 * y2 - y1 * x2) * (x3 - x4) - (x1 - x2) * (x3 * y4 - y3 * x4),\n        ny = (x1 * y2 - y1 * x2) * (y3 - y4) - (y1 - y2) * (x3 * y4 - y3 * x4),\n        d = (x1 - x2) * (y3 - y4) - (y1 - y2) * (x3 - x4);\n\n    if (d == 0) {\n      return false;\n    }\n\n    return {\n      x: nx / d,\n      y: ny / d\n    };\n  },\n  lli4: function lli4(p1, p2, p3, p4) {\n    var x1 = p1.x,\n        y1 = p1.y,\n        x2 = p2.x,\n        y2 = p2.y,\n        x3 = p3.x,\n        y3 = p3.y,\n        x4 = p4.x,\n        y4 = p4.y;\n    return utils.lli8(x1, y1, x2, y2, x3, y3, x4, y4);\n  },\n  lli: function lli(v1, v2) {\n    return utils.lli4(v1, v1.c, v2, v2.c);\n  },\n  makeline: function makeline(p1, p2) {\n    return new Bezier(p1.x, p1.y, (p1.x + p2.x) / 2, (p1.y + p2.y) / 2, p2.x, p2.y);\n  },\n  findbbox: function findbbox(sections) {\n    var mx = nMax,\n        my = nMax,\n        MX = nMin,\n        MY = nMin;\n    sections.forEach(function (s) {\n      var bbox = s.bbox();\n      if (mx > bbox.x.min) mx = bbox.x.min;\n      if (my > bbox.y.min) my = bbox.y.min;\n      if (MX < bbox.x.max) MX = bbox.x.max;\n      if (MY < bbox.y.max) MY = bbox.y.max;\n    });\n    return {\n      x: {\n        min: mx,\n        mid: (mx + MX) / 2,\n        max: MX,\n        size: MX - mx\n      },\n      y: {\n        min: my,\n        mid: (my + MY) / 2,\n        max: MY,\n        size: MY - my\n      }\n    };\n  },\n  shapeintersections: function shapeintersections(s1, bbox1, s2, bbox2, curveIntersectionThreshold) {\n    if (!utils.bboxoverlap(bbox1, bbox2)) return [];\n    var intersections = [];\n    var a1 = [s1.startcap, s1.forward, s1.back, s1.endcap];\n    var a2 = [s2.startcap, s2.forward, s2.back, s2.endcap];\n    a1.forEach(function (l1) {\n      if (l1.virtual) return;\n      a2.forEach(function (l2) {\n        if (l2.virtual) return;\n        var iss = l1.intersects(l2, curveIntersectionThreshold);\n\n        if (iss.length > 0) {\n          iss.c1 = l1;\n          iss.c2 = l2;\n          iss.s1 = s1;\n          iss.s2 = s2;\n          intersections.push(iss);\n        }\n      });\n    });\n    return intersections;\n  },\n  makeshape: function makeshape(forward, back, curveIntersectionThreshold) {\n    var bpl = back.points.length;\n    var fpl = forward.points.length;\n    var start = utils.makeline(back.points[bpl - 1], forward.points[0]);\n    var end = utils.makeline(forward.points[fpl - 1], back.points[0]);\n    var shape = {\n      startcap: start,\n      forward: forward,\n      back: back,\n      endcap: end,\n      bbox: utils.findbbox([start, forward, back, end])\n    };\n\n    shape.intersections = function (s2) {\n      return utils.shapeintersections(shape, shape.bbox, s2, s2.bbox, curveIntersectionThreshold);\n    };\n\n    return shape;\n  },\n  getminmax: function getminmax(curve, d, list) {\n    if (!list) return {\n      min: 0,\n      max: 0\n    };\n    var min = nMax,\n        max = nMin,\n        t,\n        c;\n\n    if (list.indexOf(0) === -1) {\n      list = [0].concat(list);\n    }\n\n    if (list.indexOf(1) === -1) {\n      list.push(1);\n    }\n\n    for (var i = 0, len = list.length; i < len; i++) {\n      t = list[i];\n      c = curve.get(t);\n\n      if (c[d] < min) {\n        min = c[d];\n      }\n\n      if (c[d] > max) {\n        max = c[d];\n      }\n    }\n\n    return {\n      min: min,\n      mid: (min + max) / 2,\n      max: max,\n      size: max - min\n    };\n  },\n  align: function align(points, line) {\n    var tx = line.p1.x,\n        ty = line.p1.y,\n        a = -atan2(line.p2.y - ty, line.p2.x - tx),\n        d = function d(v) {\n      return {\n        x: (v.x - tx) * cos(a) - (v.y - ty) * sin(a),\n        y: (v.x - tx) * sin(a) + (v.y - ty) * cos(a)\n      };\n    };\n\n    return points.map(d);\n  },\n  roots: function roots(points, line) {\n    line = line || {\n      p1: {\n        x: 0,\n        y: 0\n      },\n      p2: {\n        x: 1,\n        y: 0\n      }\n    };\n    var order = points.length - 1;\n    var aligned = utils.align(points, line);\n\n    var reduce = function reduce(t) {\n      return 0 <= t && t <= 1;\n    };\n\n    if (order === 2) {\n      var _a = aligned[0].y,\n          _b = aligned[1].y,\n          _c = aligned[2].y,\n          _d = _a - 2 * _b + _c;\n\n      if (_d !== 0) {\n        var m1 = -sqrt(_b * _b - _a * _c),\n            m2 = -_a + _b,\n            _v = -(m1 + m2) / _d,\n            v2 = -(-m1 + m2) / _d;\n\n        return [_v, v2].filter(reduce);\n      } else if (_b !== _c && _d === 0) {\n        return [(2 * _b - _c) / (2 * _b - 2 * _c)].filter(reduce);\n      }\n\n      return [];\n    } // see http://www.trans4mind.com/personal_development/mathematics/polynomials/cubicAlgebra.htm\n\n\n    var pa = aligned[0].y,\n        pb = aligned[1].y,\n        pc = aligned[2].y,\n        pd = aligned[3].y;\n    var d = -pa + 3 * pb - 3 * pc + pd,\n        a = 3 * pa - 6 * pb + 3 * pc,\n        b = -3 * pa + 3 * pb,\n        c = pa;\n\n    if (utils.approximately(d, 0)) {\n      // this is not a cubic curve.\n      if (utils.approximately(a, 0)) {\n        // in fact, this is not a quadratic curve either.\n        if (utils.approximately(b, 0)) {\n          // in fact in fact, there are no solutions.\n          return [];\n        } // linear solution:\n\n\n        return [-c / b].filter(reduce);\n      } // quadratic solution:\n\n\n      var _q = sqrt(b * b - 4 * a * c),\n          a2 = 2 * a;\n\n      return [(_q - b) / a2, (-b - _q) / a2].filter(reduce);\n    } // at this point, we know we need a cubic solution:\n\n\n    a /= d;\n    b /= d;\n    c /= d;\n    var p = (3 * b - a * a) / 3,\n        p3 = p / 3,\n        q = (2 * a * a * a - 9 * a * b + 27 * c) / 27,\n        q2 = q / 2,\n        discriminant = q2 * q2 + p3 * p3 * p3;\n    var u1, v1, x1, x2, x3;\n\n    if (discriminant < 0) {\n      var mp3 = -p / 3,\n          mp33 = mp3 * mp3 * mp3,\n          r = sqrt(mp33),\n          t = -q / (2 * r),\n          cosphi = t < -1 ? -1 : t > 1 ? 1 : t,\n          phi = acos(cosphi),\n          crtr = crt(r),\n          t1 = 2 * crtr;\n      x1 = t1 * cos(phi / 3) - a / 3;\n      x2 = t1 * cos((phi + tau) / 3) - a / 3;\n      x3 = t1 * cos((phi + 2 * tau) / 3) - a / 3;\n      return [x1, x2, x3].filter(reduce);\n    } else if (discriminant === 0) {\n      u1 = q2 < 0 ? crt(-q2) : -crt(q2);\n      x1 = 2 * u1 - a / 3;\n      x2 = -u1 - a / 3;\n      return [x1, x2].filter(reduce);\n    } else {\n      var sd = sqrt(discriminant);\n      u1 = crt(-q2 + sd);\n      v1 = crt(q2 + sd);\n      return [u1 - v1 - a / 3].filter(reduce);\n    }\n  },\n  droots: function droots(p) {\n    // quadratic roots are easy\n    if (p.length === 3) {\n      var a = p[0],\n          b = p[1],\n          c = p[2],\n          d = a - 2 * b + c;\n\n      if (d !== 0) {\n        var m1 = -sqrt(b * b - a * c),\n            m2 = -a + b,\n            v1 = -(m1 + m2) / d,\n            v2 = -(-m1 + m2) / d;\n        return [v1, v2];\n      } else if (b !== c && d === 0) {\n        return [(2 * b - c) / (2 * (b - c))];\n      }\n\n      return [];\n    } // linear roots are even easier\n\n\n    if (p.length === 2) {\n      var _a2 = p[0],\n          _b2 = p[1];\n\n      if (_a2 !== _b2) {\n        return [_a2 / (_a2 - _b2)];\n      }\n\n      return [];\n    }\n\n    return [];\n  },\n  curvature: function curvature(t, d1, d2, _3d, kOnly) {\n    var num,\n        dnm,\n        adk,\n        dk,\n        k = 0,\n        r = 0; //\n    // We're using the following formula for curvature:\n    //\n    //              x'y\" - y'x\"\n    //   k(t) = ------------------\n    //           (x'² + y'²)^(3/2)\n    //\n    // from https://en.wikipedia.org/wiki/Radius_of_curvature#Definition\n    //\n    // With it corresponding 3D counterpart:\n    //\n    //          sqrt( (y'z\" - y\"z')² + (z'x\" - z\"x')² + (x'y\" - x\"y')²)\n    //   k(t) = -------------------------------------------------------\n    //                     (x'² + y'² + z'²)^(3/2)\n    //\n\n    var d = utils.compute(t, d1);\n    var dd = utils.compute(t, d2);\n    var qdsum = d.x * d.x + d.y * d.y;\n\n    if (_3d) {\n      num = sqrt(pow(d.y * dd.z - dd.y * d.z, 2) + pow(d.z * dd.x - dd.z * d.x, 2) + pow(d.x * dd.y - dd.x * d.y, 2));\n      dnm = pow(qdsum + d.z * d.z, 3 / 2);\n    } else {\n      num = d.x * dd.y - d.y * dd.x;\n      dnm = pow(qdsum, 3 / 2);\n    }\n\n    if (num === 0 || dnm === 0) {\n      return {\n        k: 0,\n        r: 0\n      };\n    }\n\n    k = num / dnm;\n    r = dnm / num; // We're also computing the derivative of kappa, because\n    // there is value in knowing the rate of change for the\n    // curvature along the curve. And we're just going to\n    // ballpark it based on an epsilon.\n\n    if (!kOnly) {\n      // compute k'(t) based on the interval before, and after it,\n      // to at least try to not introduce forward/backward pass bias.\n      var pk = utils.curvature(t - 0.001, d1, d2, _3d, true).k;\n      var nk = utils.curvature(t + 0.001, d1, d2, _3d, true).k;\n      dk = (nk - k + (k - pk)) / 2;\n      adk = (abs(nk - k) + abs(k - pk)) / 2;\n    }\n\n    return {\n      k: k,\n      r: r,\n      dk: dk,\n      adk: adk\n    };\n  },\n  inflections: function inflections(points) {\n    if (points.length < 4) return []; // FIXME: TODO: add in inflection abstraction for quartic+ curves?\n\n    var p = utils.align(points, {\n      p1: points[0],\n      p2: points.slice(-1)[0]\n    }),\n        a = p[2].x * p[1].y,\n        b = p[3].x * p[1].y,\n        c = p[1].x * p[2].y,\n        d = p[3].x * p[2].y,\n        v1 = 18 * (-3 * a + 2 * b + 3 * c - d),\n        v2 = 18 * (3 * a - b - 3 * c),\n        v3 = 18 * (c - a);\n\n    if (utils.approximately(v1, 0)) {\n      if (!utils.approximately(v2, 0)) {\n        var t = -v3 / v2;\n        if (0 <= t && t <= 1) return [t];\n      }\n\n      return [];\n    }\n\n    var d2 = 2 * v1;\n    if (utils.approximately(d2, 0)) return [];\n    var trm = v2 * v2 - 4 * v1 * v3;\n    if (trm < 0) return [];\n    var sq = Math.sqrt(trm);\n    return [(sq - v2) / d2, -(v2 + sq) / d2].filter(function (r) {\n      return 0 <= r && r <= 1;\n    });\n  },\n  bboxoverlap: function bboxoverlap(b1, b2) {\n    var dims = [\"x\", \"y\"],\n        len = dims.length;\n\n    for (var i = 0, dim, l, t, d; i < len; i++) {\n      dim = dims[i];\n      l = b1[dim].mid;\n      t = b2[dim].mid;\n      d = (b1[dim].size + b2[dim].size) / 2;\n      if (abs(l - t) >= d) return false;\n    }\n\n    return true;\n  },\n  expandbox: function expandbox(bbox, _bbox) {\n    if (_bbox.x.min < bbox.x.min) {\n      bbox.x.min = _bbox.x.min;\n    }\n\n    if (_bbox.y.min < bbox.y.min) {\n      bbox.y.min = _bbox.y.min;\n    }\n\n    if (_bbox.z && _bbox.z.min < bbox.z.min) {\n      bbox.z.min = _bbox.z.min;\n    }\n\n    if (_bbox.x.max > bbox.x.max) {\n      bbox.x.max = _bbox.x.max;\n    }\n\n    if (_bbox.y.max > bbox.y.max) {\n      bbox.y.max = _bbox.y.max;\n    }\n\n    if (_bbox.z && _bbox.z.max > bbox.z.max) {\n      bbox.z.max = _bbox.z.max;\n    }\n\n    bbox.x.mid = (bbox.x.min + bbox.x.max) / 2;\n    bbox.y.mid = (bbox.y.min + bbox.y.max) / 2;\n\n    if (bbox.z) {\n      bbox.z.mid = (bbox.z.min + bbox.z.max) / 2;\n    }\n\n    bbox.x.size = bbox.x.max - bbox.x.min;\n    bbox.y.size = bbox.y.max - bbox.y.min;\n\n    if (bbox.z) {\n      bbox.z.size = bbox.z.max - bbox.z.min;\n    }\n  },\n  pairiteration: function pairiteration(c1, c2, curveIntersectionThreshold) {\n    var c1b = c1.bbox(),\n        c2b = c2.bbox(),\n        r = 100000,\n        threshold = curveIntersectionThreshold || 0.5;\n\n    if (c1b.x.size + c1b.y.size < threshold && c2b.x.size + c2b.y.size < threshold) {\n      return [(r * (c1._t1 + c1._t2) / 2 | 0) / r + \"/\" + (r * (c2._t1 + c2._t2) / 2 | 0) / r];\n    }\n\n    var cc1 = c1.split(0.5),\n        cc2 = c2.split(0.5),\n        pairs = [{\n      left: cc1.left,\n      right: cc2.left\n    }, {\n      left: cc1.left,\n      right: cc2.right\n    }, {\n      left: cc1.right,\n      right: cc2.right\n    }, {\n      left: cc1.right,\n      right: cc2.left\n    }];\n    pairs = pairs.filter(function (pair) {\n      return utils.bboxoverlap(pair.left.bbox(), pair.right.bbox());\n    });\n    var results = [];\n    if (pairs.length === 0) return results;\n    pairs.forEach(function (pair) {\n      results = results.concat(utils.pairiteration(pair.left, pair.right, threshold));\n    });\n    results = results.filter(function (v, i) {\n      return results.indexOf(v) === i;\n    });\n    return results;\n  },\n  getccenter: function getccenter(p1, p2, p3) {\n    var dx1 = p2.x - p1.x,\n        dy1 = p2.y - p1.y,\n        dx2 = p3.x - p2.x,\n        dy2 = p3.y - p2.y,\n        dx1p = dx1 * cos(quart) - dy1 * sin(quart),\n        dy1p = dx1 * sin(quart) + dy1 * cos(quart),\n        dx2p = dx2 * cos(quart) - dy2 * sin(quart),\n        dy2p = dx2 * sin(quart) + dy2 * cos(quart),\n        // chord midpoints\n    mx1 = (p1.x + p2.x) / 2,\n        my1 = (p1.y + p2.y) / 2,\n        mx2 = (p2.x + p3.x) / 2,\n        my2 = (p2.y + p3.y) / 2,\n        // midpoint offsets\n    mx1n = mx1 + dx1p,\n        my1n = my1 + dy1p,\n        mx2n = mx2 + dx2p,\n        my2n = my2 + dy2p,\n        // intersection of these lines:\n    arc = utils.lli8(mx1, my1, mx1n, my1n, mx2, my2, mx2n, my2n),\n        r = utils.dist(arc, p1); // arc start/end values, over mid point:\n\n    var s = atan2(p1.y - arc.y, p1.x - arc.x),\n        m = atan2(p2.y - arc.y, p2.x - arc.x),\n        e = atan2(p3.y - arc.y, p3.x - arc.x),\n        _; // determine arc direction (cw/ccw correction)\n\n\n    if (s < e) {\n      // if s<m<e, arc(s, e)\n      // if m<s<e, arc(e, s + tau)\n      // if s<e<m, arc(e, s + tau)\n      if (s > m || m > e) {\n        s += tau;\n      }\n\n      if (s > e) {\n        _ = e;\n        e = s;\n        s = _;\n      }\n    } else {\n      // if e<m<s, arc(e, s)\n      // if m<e<s, arc(s, e + tau)\n      // if e<s<m, arc(s, e + tau)\n      if (e < m && m < s) {\n        _ = e;\n        e = s;\n        s = _;\n      } else {\n        e += tau;\n      }\n    } // assign and done.\n\n\n    arc.s = s;\n    arc.e = e;\n    arc.r = r;\n    return arc;\n  },\n  numberSort: function numberSort(a, b) {\n    return a - b;\n  }\n};\nexport { utils };","map":{"version":3,"names":["Bezier","abs","Math","cos","sin","acos","atan2","sqrt","pow","crt","v","pi","PI","tau","quart","epsilon","nMax","Number","MAX_SAFE_INTEGER","nMin","MIN_SAFE_INTEGER","ZERO","x","y","z","utils","Tvalues","Cvalues","arcfn","t","derivativeFn","d","l","compute","points","_3d","order","length","mt","p","ret","mt2","t2","a","b","c","dCpts","JSON","parse","stringify","i","splice","computeWithRatios","ratios","r","f1","f2","f3","f4","derive","dpoints","list","j","dpt","push","between","m","M","approximately","precision","len","sum","map","ds","de","ts","te","d1","d2","v2","lerp","v1","undefined","pointToString","s","pointsToString","join","copy","obj","angle","o","dx1","dy1","dx2","dy2","cross","dot","round","pos","indexOf","parseFloat","substring","dist","p1","p2","dx","dy","closest","LUT","point","mdist","mpos","forEach","idx","abcratio","n","bottom","top","projectionratio","lli8","x1","y1","x2","y2","x3","y3","x4","y4","nx","ny","lli4","p3","p4","lli","makeline","findbbox","sections","mx","my","MX","MY","bbox","min","max","mid","size","shapeintersections","s1","bbox1","s2","bbox2","curveIntersectionThreshold","bboxoverlap","intersections","a1","startcap","forward","back","endcap","a2","l1","virtual","l2","iss","intersects","c1","c2","makeshape","bpl","fpl","start","end","shape","getminmax","curve","concat","get","align","line","tx","ty","roots","aligned","reduce","m1","m2","filter","pa","pb","pc","pd","q","q2","discriminant","u1","mp3","mp33","cosphi","phi","crtr","t1","sd","droots","curvature","kOnly","num","dnm","adk","dk","k","dd","qdsum","pk","nk","inflections","slice","v3","trm","sq","b1","b2","dims","dim","expandbox","_bbox","pairiteration","c1b","c2b","threshold","_t1","_t2","cc1","split","cc2","pairs","left","right","pair","results","getccenter","dx1p","dy1p","dx2p","dy2p","mx1","my1","mx2","my2","mx1n","my1n","mx2n","my2n","arc","e","_","numberSort"],"sources":["X:/Project/graph/node_modules/bezier-js/src/utils.js"],"sourcesContent":["import { Bezier } from \"./bezier.js\";\n\n// math-inlining.\nconst { abs, cos, sin, acos, atan2, sqrt, pow } = Math;\n\n// cube root function yielding real roots\nfunction crt(v) {\n  return v < 0 ? -pow(-v, 1 / 3) : pow(v, 1 / 3);\n}\n\n// trig constants\nconst pi = Math.PI,\n  tau = 2 * pi,\n  quart = pi / 2,\n  // float precision significant decimal\n  epsilon = 0.000001,\n  // extremas used in bbox calculation and similar algorithms\n  nMax = Number.MAX_SAFE_INTEGER || 9007199254740991,\n  nMin = Number.MIN_SAFE_INTEGER || -9007199254740991,\n  // a zero coordinate, which is surprisingly useful\n  ZERO = { x: 0, y: 0, z: 0 };\n\n// Bezier utility functions\nconst utils = {\n  // Legendre-Gauss abscissae with n=24 (x_i values, defined at i=n as the roots of the nth order Legendre polynomial Pn(x))\n  Tvalues: [\n    -0.0640568928626056260850430826247450385909,\n    0.0640568928626056260850430826247450385909,\n    -0.1911188674736163091586398207570696318404,\n    0.1911188674736163091586398207570696318404,\n    -0.3150426796961633743867932913198102407864,\n    0.3150426796961633743867932913198102407864,\n    -0.4337935076260451384870842319133497124524,\n    0.4337935076260451384870842319133497124524,\n    -0.5454214713888395356583756172183723700107,\n    0.5454214713888395356583756172183723700107,\n    -0.6480936519369755692524957869107476266696,\n    0.6480936519369755692524957869107476266696,\n    -0.7401241915785543642438281030999784255232,\n    0.7401241915785543642438281030999784255232,\n    -0.8200019859739029219539498726697452080761,\n    0.8200019859739029219539498726697452080761,\n    -0.8864155270044010342131543419821967550873,\n    0.8864155270044010342131543419821967550873,\n    -0.9382745520027327585236490017087214496548,\n    0.9382745520027327585236490017087214496548,\n    -0.9747285559713094981983919930081690617411,\n    0.9747285559713094981983919930081690617411,\n    -0.9951872199970213601799974097007368118745,\n    0.9951872199970213601799974097007368118745,\n  ],\n\n  // Legendre-Gauss weights with n=24 (w_i values, defined by a function linked to in the Bezier primer article)\n  Cvalues: [\n    0.1279381953467521569740561652246953718517,\n    0.1279381953467521569740561652246953718517,\n    0.1258374563468282961213753825111836887264,\n    0.1258374563468282961213753825111836887264,\n    0.121670472927803391204463153476262425607,\n    0.121670472927803391204463153476262425607,\n    0.1155056680537256013533444839067835598622,\n    0.1155056680537256013533444839067835598622,\n    0.1074442701159656347825773424466062227946,\n    0.1074442701159656347825773424466062227946,\n    0.0976186521041138882698806644642471544279,\n    0.0976186521041138882698806644642471544279,\n    0.086190161531953275917185202983742667185,\n    0.086190161531953275917185202983742667185,\n    0.0733464814110803057340336152531165181193,\n    0.0733464814110803057340336152531165181193,\n    0.0592985849154367807463677585001085845412,\n    0.0592985849154367807463677585001085845412,\n    0.0442774388174198061686027482113382288593,\n    0.0442774388174198061686027482113382288593,\n    0.0285313886289336631813078159518782864491,\n    0.0285313886289336631813078159518782864491,\n    0.0123412297999871995468056670700372915759,\n    0.0123412297999871995468056670700372915759,\n  ],\n\n  arcfn: function (t, derivativeFn) {\n    const d = derivativeFn(t);\n    let l = d.x * d.x + d.y * d.y;\n    if (typeof d.z !== \"undefined\") {\n      l += d.z * d.z;\n    }\n    return sqrt(l);\n  },\n\n  compute: function (t, points, _3d) {\n    // shortcuts\n    if (t === 0) {\n      points[0].t = 0;\n      return points[0];\n    }\n\n    const order = points.length - 1;\n\n    if (t === 1) {\n      points[order].t = 1;\n      return points[order];\n    }\n\n    const mt = 1 - t;\n    let p = points;\n\n    // constant?\n    if (order === 0) {\n      points[0].t = t;\n      return points[0];\n    }\n\n    // linear?\n    if (order === 1) {\n      const ret = {\n        x: mt * p[0].x + t * p[1].x,\n        y: mt * p[0].y + t * p[1].y,\n        t: t,\n      };\n      if (_3d) {\n        ret.z = mt * p[0].z + t * p[1].z;\n      }\n      return ret;\n    }\n\n    // quadratic/cubic curve?\n    if (order < 4) {\n      let mt2 = mt * mt,\n        t2 = t * t,\n        a,\n        b,\n        c,\n        d = 0;\n      if (order === 2) {\n        p = [p[0], p[1], p[2], ZERO];\n        a = mt2;\n        b = mt * t * 2;\n        c = t2;\n      } else if (order === 3) {\n        a = mt2 * mt;\n        b = mt2 * t * 3;\n        c = mt * t2 * 3;\n        d = t * t2;\n      }\n      const ret = {\n        x: a * p[0].x + b * p[1].x + c * p[2].x + d * p[3].x,\n        y: a * p[0].y + b * p[1].y + c * p[2].y + d * p[3].y,\n        t: t,\n      };\n      if (_3d) {\n        ret.z = a * p[0].z + b * p[1].z + c * p[2].z + d * p[3].z;\n      }\n      return ret;\n    }\n\n    // higher order curves: use de Casteljau's computation\n    const dCpts = JSON.parse(JSON.stringify(points));\n    while (dCpts.length > 1) {\n      for (let i = 0; i < dCpts.length - 1; i++) {\n        dCpts[i] = {\n          x: dCpts[i].x + (dCpts[i + 1].x - dCpts[i].x) * t,\n          y: dCpts[i].y + (dCpts[i + 1].y - dCpts[i].y) * t,\n        };\n        if (typeof dCpts[i].z !== \"undefined\") {\n          dCpts[i] = dCpts[i].z + (dCpts[i + 1].z - dCpts[i].z) * t;\n        }\n      }\n      dCpts.splice(dCpts.length - 1, 1);\n    }\n    dCpts[0].t = t;\n    return dCpts[0];\n  },\n\n  computeWithRatios: function (t, points, ratios, _3d) {\n    const mt = 1 - t,\n      r = ratios,\n      p = points;\n\n    let f1 = r[0],\n      f2 = r[1],\n      f3 = r[2],\n      f4 = r[3],\n      d;\n\n    // spec for linear\n    f1 *= mt;\n    f2 *= t;\n\n    if (p.length === 2) {\n      d = f1 + f2;\n      return {\n        x: (f1 * p[0].x + f2 * p[1].x) / d,\n        y: (f1 * p[0].y + f2 * p[1].y) / d,\n        z: !_3d ? false : (f1 * p[0].z + f2 * p[1].z) / d,\n        t: t,\n      };\n    }\n\n    // upgrade to quadratic\n    f1 *= mt;\n    f2 *= 2 * mt;\n    f3 *= t * t;\n\n    if (p.length === 3) {\n      d = f1 + f2 + f3;\n      return {\n        x: (f1 * p[0].x + f2 * p[1].x + f3 * p[2].x) / d,\n        y: (f1 * p[0].y + f2 * p[1].y + f3 * p[2].y) / d,\n        z: !_3d ? false : (f1 * p[0].z + f2 * p[1].z + f3 * p[2].z) / d,\n        t: t,\n      };\n    }\n\n    // upgrade to cubic\n    f1 *= mt;\n    f2 *= 1.5 * mt;\n    f3 *= 3 * mt;\n    f4 *= t * t * t;\n\n    if (p.length === 4) {\n      d = f1 + f2 + f3 + f4;\n      return {\n        x: (f1 * p[0].x + f2 * p[1].x + f3 * p[2].x + f4 * p[3].x) / d,\n        y: (f1 * p[0].y + f2 * p[1].y + f3 * p[2].y + f4 * p[3].y) / d,\n        z: !_3d\n          ? false\n          : (f1 * p[0].z + f2 * p[1].z + f3 * p[2].z + f4 * p[3].z) / d,\n        t: t,\n      };\n    }\n  },\n\n  derive: function (points, _3d) {\n    const dpoints = [];\n    for (let p = points, d = p.length, c = d - 1; d > 1; d--, c--) {\n      const list = [];\n      for (let j = 0, dpt; j < c; j++) {\n        dpt = {\n          x: c * (p[j + 1].x - p[j].x),\n          y: c * (p[j + 1].y - p[j].y),\n        };\n        if (_3d) {\n          dpt.z = c * (p[j + 1].z - p[j].z);\n        }\n        list.push(dpt);\n      }\n      dpoints.push(list);\n      p = list;\n    }\n    return dpoints;\n  },\n\n  between: function (v, m, M) {\n    return (\n      (m <= v && v <= M) ||\n      utils.approximately(v, m) ||\n      utils.approximately(v, M)\n    );\n  },\n\n  approximately: function (a, b, precision) {\n    return abs(a - b) <= (precision || epsilon);\n  },\n\n  length: function (derivativeFn) {\n    const z = 0.5,\n      len = utils.Tvalues.length;\n\n    let sum = 0;\n\n    for (let i = 0, t; i < len; i++) {\n      t = z * utils.Tvalues[i] + z;\n      sum += utils.Cvalues[i] * utils.arcfn(t, derivativeFn);\n    }\n    return z * sum;\n  },\n\n  map: function (v, ds, de, ts, te) {\n    const d1 = de - ds,\n      d2 = te - ts,\n      v2 = v - ds,\n      r = v2 / d1;\n    return ts + d2 * r;\n  },\n\n  lerp: function (r, v1, v2) {\n    const ret = {\n      x: v1.x + r * (v2.x - v1.x),\n      y: v1.y + r * (v2.y - v1.y),\n    };\n    if (v1.z !== undefined && v2.z !== undefined) {\n      ret.z = v1.z + r * (v2.z - v1.z);\n    }\n    return ret;\n  },\n\n  pointToString: function (p) {\n    let s = p.x + \"/\" + p.y;\n    if (typeof p.z !== \"undefined\") {\n      s += \"/\" + p.z;\n    }\n    return s;\n  },\n\n  pointsToString: function (points) {\n    return \"[\" + points.map(utils.pointToString).join(\", \") + \"]\";\n  },\n\n  copy: function (obj) {\n    return JSON.parse(JSON.stringify(obj));\n  },\n\n  angle: function (o, v1, v2) {\n    const dx1 = v1.x - o.x,\n      dy1 = v1.y - o.y,\n      dx2 = v2.x - o.x,\n      dy2 = v2.y - o.y,\n      cross = dx1 * dy2 - dy1 * dx2,\n      dot = dx1 * dx2 + dy1 * dy2;\n    return atan2(cross, dot);\n  },\n\n  // round as string, to avoid rounding errors\n  round: function (v, d) {\n    const s = \"\" + v;\n    const pos = s.indexOf(\".\");\n    return parseFloat(s.substring(0, pos + 1 + d));\n  },\n\n  dist: function (p1, p2) {\n    const dx = p1.x - p2.x,\n      dy = p1.y - p2.y;\n    return sqrt(dx * dx + dy * dy);\n  },\n\n  closest: function (LUT, point) {\n    let mdist = pow(2, 63),\n      mpos,\n      d;\n    LUT.forEach(function (p, idx) {\n      d = utils.dist(point, p);\n      if (d < mdist) {\n        mdist = d;\n        mpos = idx;\n      }\n    });\n    return { mdist: mdist, mpos: mpos };\n  },\n\n  abcratio: function (t, n) {\n    // see ratio(t) note on http://pomax.github.io/bezierinfo/#abc\n    if (n !== 2 && n !== 3) {\n      return false;\n    }\n    if (typeof t === \"undefined\") {\n      t = 0.5;\n    } else if (t === 0 || t === 1) {\n      return t;\n    }\n    const bottom = pow(t, n) + pow(1 - t, n),\n      top = bottom - 1;\n    return abs(top / bottom);\n  },\n\n  projectionratio: function (t, n) {\n    // see u(t) note on http://pomax.github.io/bezierinfo/#abc\n    if (n !== 2 && n !== 3) {\n      return false;\n    }\n    if (typeof t === \"undefined\") {\n      t = 0.5;\n    } else if (t === 0 || t === 1) {\n      return t;\n    }\n    const top = pow(1 - t, n),\n      bottom = pow(t, n) + top;\n    return top / bottom;\n  },\n\n  lli8: function (x1, y1, x2, y2, x3, y3, x4, y4) {\n    const nx =\n        (x1 * y2 - y1 * x2) * (x3 - x4) - (x1 - x2) * (x3 * y4 - y3 * x4),\n      ny = (x1 * y2 - y1 * x2) * (y3 - y4) - (y1 - y2) * (x3 * y4 - y3 * x4),\n      d = (x1 - x2) * (y3 - y4) - (y1 - y2) * (x3 - x4);\n    if (d == 0) {\n      return false;\n    }\n    return { x: nx / d, y: ny / d };\n  },\n\n  lli4: function (p1, p2, p3, p4) {\n    const x1 = p1.x,\n      y1 = p1.y,\n      x2 = p2.x,\n      y2 = p2.y,\n      x3 = p3.x,\n      y3 = p3.y,\n      x4 = p4.x,\n      y4 = p4.y;\n    return utils.lli8(x1, y1, x2, y2, x3, y3, x4, y4);\n  },\n\n  lli: function (v1, v2) {\n    return utils.lli4(v1, v1.c, v2, v2.c);\n  },\n\n  makeline: function (p1, p2) {\n    return new Bezier(\n      p1.x,\n      p1.y,\n      (p1.x + p2.x) / 2,\n      (p1.y + p2.y) / 2,\n      p2.x,\n      p2.y\n    );\n  },\n\n  findbbox: function (sections) {\n    let mx = nMax,\n      my = nMax,\n      MX = nMin,\n      MY = nMin;\n    sections.forEach(function (s) {\n      const bbox = s.bbox();\n      if (mx > bbox.x.min) mx = bbox.x.min;\n      if (my > bbox.y.min) my = bbox.y.min;\n      if (MX < bbox.x.max) MX = bbox.x.max;\n      if (MY < bbox.y.max) MY = bbox.y.max;\n    });\n    return {\n      x: { min: mx, mid: (mx + MX) / 2, max: MX, size: MX - mx },\n      y: { min: my, mid: (my + MY) / 2, max: MY, size: MY - my },\n    };\n  },\n\n  shapeintersections: function (\n    s1,\n    bbox1,\n    s2,\n    bbox2,\n    curveIntersectionThreshold\n  ) {\n    if (!utils.bboxoverlap(bbox1, bbox2)) return [];\n    const intersections = [];\n    const a1 = [s1.startcap, s1.forward, s1.back, s1.endcap];\n    const a2 = [s2.startcap, s2.forward, s2.back, s2.endcap];\n    a1.forEach(function (l1) {\n      if (l1.virtual) return;\n      a2.forEach(function (l2) {\n        if (l2.virtual) return;\n        const iss = l1.intersects(l2, curveIntersectionThreshold);\n        if (iss.length > 0) {\n          iss.c1 = l1;\n          iss.c2 = l2;\n          iss.s1 = s1;\n          iss.s2 = s2;\n          intersections.push(iss);\n        }\n      });\n    });\n    return intersections;\n  },\n\n  makeshape: function (forward, back, curveIntersectionThreshold) {\n    const bpl = back.points.length;\n    const fpl = forward.points.length;\n    const start = utils.makeline(back.points[bpl - 1], forward.points[0]);\n    const end = utils.makeline(forward.points[fpl - 1], back.points[0]);\n    const shape = {\n      startcap: start,\n      forward: forward,\n      back: back,\n      endcap: end,\n      bbox: utils.findbbox([start, forward, back, end]),\n    };\n    shape.intersections = function (s2) {\n      return utils.shapeintersections(\n        shape,\n        shape.bbox,\n        s2,\n        s2.bbox,\n        curveIntersectionThreshold\n      );\n    };\n    return shape;\n  },\n\n  getminmax: function (curve, d, list) {\n    if (!list) return { min: 0, max: 0 };\n    let min = nMax,\n      max = nMin,\n      t,\n      c;\n    if (list.indexOf(0) === -1) {\n      list = [0].concat(list);\n    }\n    if (list.indexOf(1) === -1) {\n      list.push(1);\n    }\n    for (let i = 0, len = list.length; i < len; i++) {\n      t = list[i];\n      c = curve.get(t);\n      if (c[d] < min) {\n        min = c[d];\n      }\n      if (c[d] > max) {\n        max = c[d];\n      }\n    }\n    return { min: min, mid: (min + max) / 2, max: max, size: max - min };\n  },\n\n  align: function (points, line) {\n    const tx = line.p1.x,\n      ty = line.p1.y,\n      a = -atan2(line.p2.y - ty, line.p2.x - tx),\n      d = function (v) {\n        return {\n          x: (v.x - tx) * cos(a) - (v.y - ty) * sin(a),\n          y: (v.x - tx) * sin(a) + (v.y - ty) * cos(a),\n        };\n      };\n    return points.map(d);\n  },\n\n  roots: function (points, line) {\n    line = line || { p1: { x: 0, y: 0 }, p2: { x: 1, y: 0 } };\n\n    const order = points.length - 1;\n    const aligned = utils.align(points, line);\n    const reduce = function (t) {\n      return 0 <= t && t <= 1;\n    };\n\n    if (order === 2) {\n      const a = aligned[0].y,\n        b = aligned[1].y,\n        c = aligned[2].y,\n        d = a - 2 * b + c;\n      if (d !== 0) {\n        const m1 = -sqrt(b * b - a * c),\n          m2 = -a + b,\n          v1 = -(m1 + m2) / d,\n          v2 = -(-m1 + m2) / d;\n        return [v1, v2].filter(reduce);\n      } else if (b !== c && d === 0) {\n        return [(2 * b - c) / (2 * b - 2 * c)].filter(reduce);\n      }\n      return [];\n    }\n\n    // see http://www.trans4mind.com/personal_development/mathematics/polynomials/cubicAlgebra.htm\n    const pa = aligned[0].y,\n      pb = aligned[1].y,\n      pc = aligned[2].y,\n      pd = aligned[3].y;\n\n    let d = -pa + 3 * pb - 3 * pc + pd,\n      a = 3 * pa - 6 * pb + 3 * pc,\n      b = -3 * pa + 3 * pb,\n      c = pa;\n\n    if (utils.approximately(d, 0)) {\n      // this is not a cubic curve.\n      if (utils.approximately(a, 0)) {\n        // in fact, this is not a quadratic curve either.\n        if (utils.approximately(b, 0)) {\n          // in fact in fact, there are no solutions.\n          return [];\n        }\n        // linear solution:\n        return [-c / b].filter(reduce);\n      }\n      // quadratic solution:\n      const q = sqrt(b * b - 4 * a * c),\n        a2 = 2 * a;\n      return [(q - b) / a2, (-b - q) / a2].filter(reduce);\n    }\n\n    // at this point, we know we need a cubic solution:\n\n    a /= d;\n    b /= d;\n    c /= d;\n\n    const p = (3 * b - a * a) / 3,\n      p3 = p / 3,\n      q = (2 * a * a * a - 9 * a * b + 27 * c) / 27,\n      q2 = q / 2,\n      discriminant = q2 * q2 + p3 * p3 * p3;\n\n    let u1, v1, x1, x2, x3;\n    if (discriminant < 0) {\n      const mp3 = -p / 3,\n        mp33 = mp3 * mp3 * mp3,\n        r = sqrt(mp33),\n        t = -q / (2 * r),\n        cosphi = t < -1 ? -1 : t > 1 ? 1 : t,\n        phi = acos(cosphi),\n        crtr = crt(r),\n        t1 = 2 * crtr;\n      x1 = t1 * cos(phi / 3) - a / 3;\n      x2 = t1 * cos((phi + tau) / 3) - a / 3;\n      x3 = t1 * cos((phi + 2 * tau) / 3) - a / 3;\n      return [x1, x2, x3].filter(reduce);\n    } else if (discriminant === 0) {\n      u1 = q2 < 0 ? crt(-q2) : -crt(q2);\n      x1 = 2 * u1 - a / 3;\n      x2 = -u1 - a / 3;\n      return [x1, x2].filter(reduce);\n    } else {\n      const sd = sqrt(discriminant);\n      u1 = crt(-q2 + sd);\n      v1 = crt(q2 + sd);\n      return [u1 - v1 - a / 3].filter(reduce);\n    }\n  },\n\n  droots: function (p) {\n    // quadratic roots are easy\n    if (p.length === 3) {\n      const a = p[0],\n        b = p[1],\n        c = p[2],\n        d = a - 2 * b + c;\n      if (d !== 0) {\n        const m1 = -sqrt(b * b - a * c),\n          m2 = -a + b,\n          v1 = -(m1 + m2) / d,\n          v2 = -(-m1 + m2) / d;\n        return [v1, v2];\n      } else if (b !== c && d === 0) {\n        return [(2 * b - c) / (2 * (b - c))];\n      }\n      return [];\n    }\n\n    // linear roots are even easier\n    if (p.length === 2) {\n      const a = p[0],\n        b = p[1];\n      if (a !== b) {\n        return [a / (a - b)];\n      }\n      return [];\n    }\n\n    return [];\n  },\n\n  curvature: function (t, d1, d2, _3d, kOnly) {\n    let num,\n      dnm,\n      adk,\n      dk,\n      k = 0,\n      r = 0;\n\n    //\n    // We're using the following formula for curvature:\n    //\n    //              x'y\" - y'x\"\n    //   k(t) = ------------------\n    //           (x'² + y'²)^(3/2)\n    //\n    // from https://en.wikipedia.org/wiki/Radius_of_curvature#Definition\n    //\n    // With it corresponding 3D counterpart:\n    //\n    //          sqrt( (y'z\" - y\"z')² + (z'x\" - z\"x')² + (x'y\" - x\"y')²)\n    //   k(t) = -------------------------------------------------------\n    //                     (x'² + y'² + z'²)^(3/2)\n    //\n\n    const d = utils.compute(t, d1);\n    const dd = utils.compute(t, d2);\n    const qdsum = d.x * d.x + d.y * d.y;\n\n    if (_3d) {\n      num = sqrt(\n        pow(d.y * dd.z - dd.y * d.z, 2) +\n          pow(d.z * dd.x - dd.z * d.x, 2) +\n          pow(d.x * dd.y - dd.x * d.y, 2)\n      );\n      dnm = pow(qdsum + d.z * d.z, 3 / 2);\n    } else {\n      num = d.x * dd.y - d.y * dd.x;\n      dnm = pow(qdsum, 3 / 2);\n    }\n\n    if (num === 0 || dnm === 0) {\n      return { k: 0, r: 0 };\n    }\n\n    k = num / dnm;\n    r = dnm / num;\n\n    // We're also computing the derivative of kappa, because\n    // there is value in knowing the rate of change for the\n    // curvature along the curve. And we're just going to\n    // ballpark it based on an epsilon.\n    if (!kOnly) {\n      // compute k'(t) based on the interval before, and after it,\n      // to at least try to not introduce forward/backward pass bias.\n      const pk = utils.curvature(t - 0.001, d1, d2, _3d, true).k;\n      const nk = utils.curvature(t + 0.001, d1, d2, _3d, true).k;\n      dk = (nk - k + (k - pk)) / 2;\n      adk = (abs(nk - k) + abs(k - pk)) / 2;\n    }\n\n    return { k: k, r: r, dk: dk, adk: adk };\n  },\n\n  inflections: function (points) {\n    if (points.length < 4) return [];\n\n    // FIXME: TODO: add in inflection abstraction for quartic+ curves?\n\n    const p = utils.align(points, { p1: points[0], p2: points.slice(-1)[0] }),\n      a = p[2].x * p[1].y,\n      b = p[3].x * p[1].y,\n      c = p[1].x * p[2].y,\n      d = p[3].x * p[2].y,\n      v1 = 18 * (-3 * a + 2 * b + 3 * c - d),\n      v2 = 18 * (3 * a - b - 3 * c),\n      v3 = 18 * (c - a);\n\n    if (utils.approximately(v1, 0)) {\n      if (!utils.approximately(v2, 0)) {\n        let t = -v3 / v2;\n        if (0 <= t && t <= 1) return [t];\n      }\n      return [];\n    }\n\n    const d2 = 2 * v1;\n\n    if (utils.approximately(d2, 0)) return [];\n\n    const trm = v2 * v2 - 4 * v1 * v3;\n\n    if (trm < 0) return [];\n\n    const sq = Math.sqrt(trm);\n\n    return [(sq - v2) / d2, -(v2 + sq) / d2].filter(function (r) {\n      return 0 <= r && r <= 1;\n    });\n  },\n\n  bboxoverlap: function (b1, b2) {\n    const dims = [\"x\", \"y\"],\n      len = dims.length;\n\n    for (let i = 0, dim, l, t, d; i < len; i++) {\n      dim = dims[i];\n      l = b1[dim].mid;\n      t = b2[dim].mid;\n      d = (b1[dim].size + b2[dim].size) / 2;\n      if (abs(l - t) >= d) return false;\n    }\n    return true;\n  },\n\n  expandbox: function (bbox, _bbox) {\n    if (_bbox.x.min < bbox.x.min) {\n      bbox.x.min = _bbox.x.min;\n    }\n    if (_bbox.y.min < bbox.y.min) {\n      bbox.y.min = _bbox.y.min;\n    }\n    if (_bbox.z && _bbox.z.min < bbox.z.min) {\n      bbox.z.min = _bbox.z.min;\n    }\n    if (_bbox.x.max > bbox.x.max) {\n      bbox.x.max = _bbox.x.max;\n    }\n    if (_bbox.y.max > bbox.y.max) {\n      bbox.y.max = _bbox.y.max;\n    }\n    if (_bbox.z && _bbox.z.max > bbox.z.max) {\n      bbox.z.max = _bbox.z.max;\n    }\n    bbox.x.mid = (bbox.x.min + bbox.x.max) / 2;\n    bbox.y.mid = (bbox.y.min + bbox.y.max) / 2;\n    if (bbox.z) {\n      bbox.z.mid = (bbox.z.min + bbox.z.max) / 2;\n    }\n    bbox.x.size = bbox.x.max - bbox.x.min;\n    bbox.y.size = bbox.y.max - bbox.y.min;\n    if (bbox.z) {\n      bbox.z.size = bbox.z.max - bbox.z.min;\n    }\n  },\n\n  pairiteration: function (c1, c2, curveIntersectionThreshold) {\n    const c1b = c1.bbox(),\n      c2b = c2.bbox(),\n      r = 100000,\n      threshold = curveIntersectionThreshold || 0.5;\n\n    if (\n      c1b.x.size + c1b.y.size < threshold &&\n      c2b.x.size + c2b.y.size < threshold\n    ) {\n      return [\n        (((r * (c1._t1 + c1._t2)) / 2) | 0) / r +\n          \"/\" +\n          (((r * (c2._t1 + c2._t2)) / 2) | 0) / r,\n      ];\n    }\n\n    let cc1 = c1.split(0.5),\n      cc2 = c2.split(0.5),\n      pairs = [\n        { left: cc1.left, right: cc2.left },\n        { left: cc1.left, right: cc2.right },\n        { left: cc1.right, right: cc2.right },\n        { left: cc1.right, right: cc2.left },\n      ];\n\n    pairs = pairs.filter(function (pair) {\n      return utils.bboxoverlap(pair.left.bbox(), pair.right.bbox());\n    });\n\n    let results = [];\n\n    if (pairs.length === 0) return results;\n\n    pairs.forEach(function (pair) {\n      results = results.concat(\n        utils.pairiteration(pair.left, pair.right, threshold)\n      );\n    });\n\n    results = results.filter(function (v, i) {\n      return results.indexOf(v) === i;\n    });\n\n    return results;\n  },\n\n  getccenter: function (p1, p2, p3) {\n    const dx1 = p2.x - p1.x,\n      dy1 = p2.y - p1.y,\n      dx2 = p3.x - p2.x,\n      dy2 = p3.y - p2.y,\n      dx1p = dx1 * cos(quart) - dy1 * sin(quart),\n      dy1p = dx1 * sin(quart) + dy1 * cos(quart),\n      dx2p = dx2 * cos(quart) - dy2 * sin(quart),\n      dy2p = dx2 * sin(quart) + dy2 * cos(quart),\n      // chord midpoints\n      mx1 = (p1.x + p2.x) / 2,\n      my1 = (p1.y + p2.y) / 2,\n      mx2 = (p2.x + p3.x) / 2,\n      my2 = (p2.y + p3.y) / 2,\n      // midpoint offsets\n      mx1n = mx1 + dx1p,\n      my1n = my1 + dy1p,\n      mx2n = mx2 + dx2p,\n      my2n = my2 + dy2p,\n      // intersection of these lines:\n      arc = utils.lli8(mx1, my1, mx1n, my1n, mx2, my2, mx2n, my2n),\n      r = utils.dist(arc, p1);\n\n    // arc start/end values, over mid point:\n    let s = atan2(p1.y - arc.y, p1.x - arc.x),\n      m = atan2(p2.y - arc.y, p2.x - arc.x),\n      e = atan2(p3.y - arc.y, p3.x - arc.x),\n      _;\n\n    // determine arc direction (cw/ccw correction)\n    if (s < e) {\n      // if s<m<e, arc(s, e)\n      // if m<s<e, arc(e, s + tau)\n      // if s<e<m, arc(e, s + tau)\n      if (s > m || m > e) {\n        s += tau;\n      }\n      if (s > e) {\n        _ = e;\n        e = s;\n        s = _;\n      }\n    } else {\n      // if e<m<s, arc(e, s)\n      // if m<e<s, arc(s, e + tau)\n      // if e<s<m, arc(s, e + tau)\n      if (e < m && m < s) {\n        _ = e;\n        e = s;\n        s = _;\n      } else {\n        e += tau;\n      }\n    }\n    // assign and done.\n    arc.s = s;\n    arc.e = e;\n    arc.r = r;\n    return arc;\n  },\n\n  numberSort: function (a, b) {\n    return a - b;\n  },\n};\n\nexport { utils };\n"],"mappings":"AAAA,SAASA,MAAT,QAAuB,aAAvB,C,CAEA;;AACA,IAAQC,GAAR,GAAkDC,IAAlD,CAAQD,GAAR;AAAA,IAAaE,GAAb,GAAkDD,IAAlD,CAAaC,GAAb;AAAA,IAAkBC,GAAlB,GAAkDF,IAAlD,CAAkBE,GAAlB;AAAA,IAAuBC,IAAvB,GAAkDH,IAAlD,CAAuBG,IAAvB;AAAA,IAA6BC,KAA7B,GAAkDJ,IAAlD,CAA6BI,KAA7B;AAAA,IAAoCC,IAApC,GAAkDL,IAAlD,CAAoCK,IAApC;AAAA,IAA0CC,GAA1C,GAAkDN,IAAlD,CAA0CM,GAA1C,C,CAEA;;AACA,SAASC,GAAT,CAAaC,CAAb,EAAgB;EACd,OAAOA,CAAC,GAAG,CAAJ,GAAQ,CAACF,GAAG,CAAC,CAACE,CAAF,EAAK,IAAI,CAAT,CAAZ,GAA0BF,GAAG,CAACE,CAAD,EAAI,IAAI,CAAR,CAApC;AACD,C,CAED;;;AACA,IAAMC,EAAE,GAAGT,IAAI,CAACU,EAAhB;AAAA,IACEC,GAAG,GAAG,IAAIF,EADZ;AAAA,IAEEG,KAAK,GAAGH,EAAE,GAAG,CAFf;AAAA,IAGE;AACAI,OAAO,GAAG,QAJZ;AAAA,IAKE;AACAC,IAAI,GAAGC,MAAM,CAACC,gBAAP,IAA2B,gBANpC;AAAA,IAOEC,IAAI,GAAGF,MAAM,CAACG,gBAAP,IAA2B,CAAC,gBAPrC;AAAA,IAQE;AACAC,IAAI,GAAG;EAAEC,CAAC,EAAE,CAAL;EAAQC,CAAC,EAAE,CAAX;EAAcC,CAAC,EAAE;AAAjB,CATT,C,CAWA;;AACA,IAAMC,KAAK,GAAG;EACZ;EACAC,OAAO,EAAE,CACP,CAAC,0CADM,EAEP,0CAFO,EAGP,CAAC,0CAHM,EAIP,0CAJO,EAKP,CAAC,0CALM,EAMP,0CANO,EAOP,CAAC,0CAPM,EAQP,0CARO,EASP,CAAC,0CATM,EAUP,0CAVO,EAWP,CAAC,0CAXM,EAYP,0CAZO,EAaP,CAAC,0CAbM,EAcP,0CAdO,EAeP,CAAC,0CAfM,EAgBP,0CAhBO,EAiBP,CAAC,0CAjBM,EAkBP,0CAlBO,EAmBP,CAAC,0CAnBM,EAoBP,0CApBO,EAqBP,CAAC,0CArBM,EAsBP,0CAtBO,EAuBP,CAAC,0CAvBM,EAwBP,0CAxBO,CAFG;EA6BZ;EACAC,OAAO,EAAE,CACP,0CADO,EAEP,0CAFO,EAGP,0CAHO,EAIP,0CAJO,EAKP,yCALO,EAMP,yCANO,EAOP,0CAPO,EAQP,0CARO,EASP,0CATO,EAUP,0CAVO,EAWP,0CAXO,EAYP,0CAZO,EAaP,yCAbO,EAcP,yCAdO,EAeP,0CAfO,EAgBP,0CAhBO,EAiBP,0CAjBO,EAkBP,0CAlBO,EAmBP,0CAnBO,EAoBP,0CApBO,EAqBP,0CArBO,EAsBP,0CAtBO,EAuBP,0CAvBO,EAwBP,0CAxBO,CA9BG;EAyDZC,KAAK,EAAE,eAAUC,CAAV,EAAaC,YAAb,EAA2B;IAChC,IAAMC,CAAC,GAAGD,YAAY,CAACD,CAAD,CAAtB;IACA,IAAIG,CAAC,GAAGD,CAAC,CAACT,CAAF,GAAMS,CAAC,CAACT,CAAR,GAAYS,CAAC,CAACR,CAAF,GAAMQ,CAAC,CAACR,CAA5B;;IACA,IAAI,OAAOQ,CAAC,CAACP,CAAT,KAAe,WAAnB,EAAgC;MAC9BQ,CAAC,IAAID,CAAC,CAACP,CAAF,GAAMO,CAAC,CAACP,CAAb;IACD;;IACD,OAAOjB,IAAI,CAACyB,CAAD,CAAX;EACD,CAhEW;EAkEZC,OAAO,EAAE,iBAAUJ,CAAV,EAAaK,MAAb,EAAqBC,GAArB,EAA0B;IACjC;IACA,IAAIN,CAAC,KAAK,CAAV,EAAa;MACXK,MAAM,CAAC,CAAD,CAAN,CAAUL,CAAV,GAAc,CAAd;MACA,OAAOK,MAAM,CAAC,CAAD,CAAb;IACD;;IAED,IAAME,KAAK,GAAGF,MAAM,CAACG,MAAP,GAAgB,CAA9B;;IAEA,IAAIR,CAAC,KAAK,CAAV,EAAa;MACXK,MAAM,CAACE,KAAD,CAAN,CAAcP,CAAd,GAAkB,CAAlB;MACA,OAAOK,MAAM,CAACE,KAAD,CAAb;IACD;;IAED,IAAME,EAAE,GAAG,IAAIT,CAAf;IACA,IAAIU,CAAC,GAAGL,MAAR,CAfiC,CAiBjC;;IACA,IAAIE,KAAK,KAAK,CAAd,EAAiB;MACfF,MAAM,CAAC,CAAD,CAAN,CAAUL,CAAV,GAAcA,CAAd;MACA,OAAOK,MAAM,CAAC,CAAD,CAAb;IACD,CArBgC,CAuBjC;;;IACA,IAAIE,KAAK,KAAK,CAAd,EAAiB;MACf,IAAMI,GAAG,GAAG;QACVlB,CAAC,EAAEgB,EAAE,GAAGC,CAAC,CAAC,CAAD,CAAD,CAAKjB,CAAV,GAAcO,CAAC,GAAGU,CAAC,CAAC,CAAD,CAAD,CAAKjB,CADhB;QAEVC,CAAC,EAAEe,EAAE,GAAGC,CAAC,CAAC,CAAD,CAAD,CAAKhB,CAAV,GAAcM,CAAC,GAAGU,CAAC,CAAC,CAAD,CAAD,CAAKhB,CAFhB;QAGVM,CAAC,EAAEA;MAHO,CAAZ;;MAKA,IAAIM,GAAJ,EAAS;QACPK,GAAG,CAAChB,CAAJ,GAAQc,EAAE,GAAGC,CAAC,CAAC,CAAD,CAAD,CAAKf,CAAV,GAAcK,CAAC,GAAGU,CAAC,CAAC,CAAD,CAAD,CAAKf,CAA/B;MACD;;MACD,OAAOgB,GAAP;IACD,CAlCgC,CAoCjC;;;IACA,IAAIJ,KAAK,GAAG,CAAZ,EAAe;MACb,IAAIK,GAAG,GAAGH,EAAE,GAAGA,EAAf;MAAA,IACEI,EAAE,GAAGb,CAAC,GAAGA,CADX;MAAA,IAEEc,CAFF;MAAA,IAGEC,CAHF;MAAA,IAIEC,CAJF;MAAA,IAKEd,CAAC,GAAG,CALN;;MAMA,IAAIK,KAAK,KAAK,CAAd,EAAiB;QACfG,CAAC,GAAG,CAACA,CAAC,CAAC,CAAD,CAAF,EAAOA,CAAC,CAAC,CAAD,CAAR,EAAaA,CAAC,CAAC,CAAD,CAAd,EAAmBlB,IAAnB,CAAJ;QACAsB,CAAC,GAAGF,GAAJ;QACAG,CAAC,GAAGN,EAAE,GAAGT,CAAL,GAAS,CAAb;QACAgB,CAAC,GAAGH,EAAJ;MACD,CALD,MAKO,IAAIN,KAAK,KAAK,CAAd,EAAiB;QACtBO,CAAC,GAAGF,GAAG,GAAGH,EAAV;QACAM,CAAC,GAAGH,GAAG,GAAGZ,CAAN,GAAU,CAAd;QACAgB,CAAC,GAAGP,EAAE,GAAGI,EAAL,GAAU,CAAd;QACAX,CAAC,GAAGF,CAAC,GAAGa,EAAR;MACD;;MACD,IAAMF,IAAG,GAAG;QACVlB,CAAC,EAAEqB,CAAC,GAAGJ,CAAC,CAAC,CAAD,CAAD,CAAKjB,CAAT,GAAasB,CAAC,GAAGL,CAAC,CAAC,CAAD,CAAD,CAAKjB,CAAtB,GAA0BuB,CAAC,GAAGN,CAAC,CAAC,CAAD,CAAD,CAAKjB,CAAnC,GAAuCS,CAAC,GAAGQ,CAAC,CAAC,CAAD,CAAD,CAAKjB,CADzC;QAEVC,CAAC,EAAEoB,CAAC,GAAGJ,CAAC,CAAC,CAAD,CAAD,CAAKhB,CAAT,GAAaqB,CAAC,GAAGL,CAAC,CAAC,CAAD,CAAD,CAAKhB,CAAtB,GAA0BsB,CAAC,GAAGN,CAAC,CAAC,CAAD,CAAD,CAAKhB,CAAnC,GAAuCQ,CAAC,GAAGQ,CAAC,CAAC,CAAD,CAAD,CAAKhB,CAFzC;QAGVM,CAAC,EAAEA;MAHO,CAAZ;;MAKA,IAAIM,GAAJ,EAAS;QACPK,IAAG,CAAChB,CAAJ,GAAQmB,CAAC,GAAGJ,CAAC,CAAC,CAAD,CAAD,CAAKf,CAAT,GAAaoB,CAAC,GAAGL,CAAC,CAAC,CAAD,CAAD,CAAKf,CAAtB,GAA0BqB,CAAC,GAAGN,CAAC,CAAC,CAAD,CAAD,CAAKf,CAAnC,GAAuCO,CAAC,GAAGQ,CAAC,CAAC,CAAD,CAAD,CAAKf,CAAxD;MACD;;MACD,OAAOgB,IAAP;IACD,CAhEgC,CAkEjC;;;IACA,IAAMM,KAAK,GAAGC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,SAAL,CAAef,MAAf,CAAX,CAAd;;IACA,OAAOY,KAAK,CAACT,MAAN,GAAe,CAAtB,EAAyB;MACvB,KAAK,IAAIa,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGJ,KAAK,CAACT,MAAN,GAAe,CAAnC,EAAsCa,CAAC,EAAvC,EAA2C;QACzCJ,KAAK,CAACI,CAAD,CAAL,GAAW;UACT5B,CAAC,EAAEwB,KAAK,CAACI,CAAD,CAAL,CAAS5B,CAAT,GAAa,CAACwB,KAAK,CAACI,CAAC,GAAG,CAAL,CAAL,CAAa5B,CAAb,GAAiBwB,KAAK,CAACI,CAAD,CAAL,CAAS5B,CAA3B,IAAgCO,CADvC;UAETN,CAAC,EAAEuB,KAAK,CAACI,CAAD,CAAL,CAAS3B,CAAT,GAAa,CAACuB,KAAK,CAACI,CAAC,GAAG,CAAL,CAAL,CAAa3B,CAAb,GAAiBuB,KAAK,CAACI,CAAD,CAAL,CAAS3B,CAA3B,IAAgCM;QAFvC,CAAX;;QAIA,IAAI,OAAOiB,KAAK,CAACI,CAAD,CAAL,CAAS1B,CAAhB,KAAsB,WAA1B,EAAuC;UACrCsB,KAAK,CAACI,CAAD,CAAL,GAAWJ,KAAK,CAACI,CAAD,CAAL,CAAS1B,CAAT,GAAa,CAACsB,KAAK,CAACI,CAAC,GAAG,CAAL,CAAL,CAAa1B,CAAb,GAAiBsB,KAAK,CAACI,CAAD,CAAL,CAAS1B,CAA3B,IAAgCK,CAAxD;QACD;MACF;;MACDiB,KAAK,CAACK,MAAN,CAAaL,KAAK,CAACT,MAAN,GAAe,CAA5B,EAA+B,CAA/B;IACD;;IACDS,KAAK,CAAC,CAAD,CAAL,CAASjB,CAAT,GAAaA,CAAb;IACA,OAAOiB,KAAK,CAAC,CAAD,CAAZ;EACD,CApJW;EAsJZM,iBAAiB,EAAE,2BAAUvB,CAAV,EAAaK,MAAb,EAAqBmB,MAArB,EAA6BlB,GAA7B,EAAkC;IACnD,IAAMG,EAAE,GAAG,IAAIT,CAAf;IAAA,IACEyB,CAAC,GAAGD,MADN;IAAA,IAEEd,CAAC,GAAGL,MAFN;IAIA,IAAIqB,EAAE,GAAGD,CAAC,CAAC,CAAD,CAAV;IAAA,IACEE,EAAE,GAAGF,CAAC,CAAC,CAAD,CADR;IAAA,IAEEG,EAAE,GAAGH,CAAC,CAAC,CAAD,CAFR;IAAA,IAGEI,EAAE,GAAGJ,CAAC,CAAC,CAAD,CAHR;IAAA,IAIEvB,CAJF,CALmD,CAWnD;;IACAwB,EAAE,IAAIjB,EAAN;IACAkB,EAAE,IAAI3B,CAAN;;IAEA,IAAIU,CAAC,CAACF,MAAF,KAAa,CAAjB,EAAoB;MAClBN,CAAC,GAAGwB,EAAE,GAAGC,EAAT;MACA,OAAO;QACLlC,CAAC,EAAE,CAACiC,EAAE,GAAGhB,CAAC,CAAC,CAAD,CAAD,CAAKjB,CAAV,GAAckC,EAAE,GAAGjB,CAAC,CAAC,CAAD,CAAD,CAAKjB,CAAzB,IAA8BS,CAD5B;QAELR,CAAC,EAAE,CAACgC,EAAE,GAAGhB,CAAC,CAAC,CAAD,CAAD,CAAKhB,CAAV,GAAciC,EAAE,GAAGjB,CAAC,CAAC,CAAD,CAAD,CAAKhB,CAAzB,IAA8BQ,CAF5B;QAGLP,CAAC,EAAE,CAACW,GAAD,GAAO,KAAP,GAAe,CAACoB,EAAE,GAAGhB,CAAC,CAAC,CAAD,CAAD,CAAKf,CAAV,GAAcgC,EAAE,GAAGjB,CAAC,CAAC,CAAD,CAAD,CAAKf,CAAzB,IAA8BO,CAH3C;QAILF,CAAC,EAAEA;MAJE,CAAP;IAMD,CAvBkD,CAyBnD;;;IACA0B,EAAE,IAAIjB,EAAN;IACAkB,EAAE,IAAI,IAAIlB,EAAV;IACAmB,EAAE,IAAI5B,CAAC,GAAGA,CAAV;;IAEA,IAAIU,CAAC,CAACF,MAAF,KAAa,CAAjB,EAAoB;MAClBN,CAAC,GAAGwB,EAAE,GAAGC,EAAL,GAAUC,EAAd;MACA,OAAO;QACLnC,CAAC,EAAE,CAACiC,EAAE,GAAGhB,CAAC,CAAC,CAAD,CAAD,CAAKjB,CAAV,GAAckC,EAAE,GAAGjB,CAAC,CAAC,CAAD,CAAD,CAAKjB,CAAxB,GAA4BmC,EAAE,GAAGlB,CAAC,CAAC,CAAD,CAAD,CAAKjB,CAAvC,IAA4CS,CAD1C;QAELR,CAAC,EAAE,CAACgC,EAAE,GAAGhB,CAAC,CAAC,CAAD,CAAD,CAAKhB,CAAV,GAAciC,EAAE,GAAGjB,CAAC,CAAC,CAAD,CAAD,CAAKhB,CAAxB,GAA4BkC,EAAE,GAAGlB,CAAC,CAAC,CAAD,CAAD,CAAKhB,CAAvC,IAA4CQ,CAF1C;QAGLP,CAAC,EAAE,CAACW,GAAD,GAAO,KAAP,GAAe,CAACoB,EAAE,GAAGhB,CAAC,CAAC,CAAD,CAAD,CAAKf,CAAV,GAAcgC,EAAE,GAAGjB,CAAC,CAAC,CAAD,CAAD,CAAKf,CAAxB,GAA4BiC,EAAE,GAAGlB,CAAC,CAAC,CAAD,CAAD,CAAKf,CAAvC,IAA4CO,CAHzD;QAILF,CAAC,EAAEA;MAJE,CAAP;IAMD,CAtCkD,CAwCnD;;;IACA0B,EAAE,IAAIjB,EAAN;IACAkB,EAAE,IAAI,MAAMlB,EAAZ;IACAmB,EAAE,IAAI,IAAInB,EAAV;IACAoB,EAAE,IAAI7B,CAAC,GAAGA,CAAJ,GAAQA,CAAd;;IAEA,IAAIU,CAAC,CAACF,MAAF,KAAa,CAAjB,EAAoB;MAClBN,CAAC,GAAGwB,EAAE,GAAGC,EAAL,GAAUC,EAAV,GAAeC,EAAnB;MACA,OAAO;QACLpC,CAAC,EAAE,CAACiC,EAAE,GAAGhB,CAAC,CAAC,CAAD,CAAD,CAAKjB,CAAV,GAAckC,EAAE,GAAGjB,CAAC,CAAC,CAAD,CAAD,CAAKjB,CAAxB,GAA4BmC,EAAE,GAAGlB,CAAC,CAAC,CAAD,CAAD,CAAKjB,CAAtC,GAA0CoC,EAAE,GAAGnB,CAAC,CAAC,CAAD,CAAD,CAAKjB,CAArD,IAA0DS,CADxD;QAELR,CAAC,EAAE,CAACgC,EAAE,GAAGhB,CAAC,CAAC,CAAD,CAAD,CAAKhB,CAAV,GAAciC,EAAE,GAAGjB,CAAC,CAAC,CAAD,CAAD,CAAKhB,CAAxB,GAA4BkC,EAAE,GAAGlB,CAAC,CAAC,CAAD,CAAD,CAAKhB,CAAtC,GAA0CmC,EAAE,GAAGnB,CAAC,CAAC,CAAD,CAAD,CAAKhB,CAArD,IAA0DQ,CAFxD;QAGLP,CAAC,EAAE,CAACW,GAAD,GACC,KADD,GAEC,CAACoB,EAAE,GAAGhB,CAAC,CAAC,CAAD,CAAD,CAAKf,CAAV,GAAcgC,EAAE,GAAGjB,CAAC,CAAC,CAAD,CAAD,CAAKf,CAAxB,GAA4BiC,EAAE,GAAGlB,CAAC,CAAC,CAAD,CAAD,CAAKf,CAAtC,GAA0CkC,EAAE,GAAGnB,CAAC,CAAC,CAAD,CAAD,CAAKf,CAArD,IAA0DO,CALzD;QAMLF,CAAC,EAAEA;MANE,CAAP;IAQD;EACF,CA/MW;EAiNZ8B,MAAM,EAAE,gBAAUzB,MAAV,EAAkBC,GAAlB,EAAuB;IAC7B,IAAMyB,OAAO,GAAG,EAAhB;;IACA,KAAK,IAAIrB,CAAC,GAAGL,MAAR,EAAgBH,CAAC,GAAGQ,CAAC,CAACF,MAAtB,EAA8BQ,CAAC,GAAGd,CAAC,GAAG,CAA3C,EAA8CA,CAAC,GAAG,CAAlD,EAAqDA,CAAC,IAAIc,CAAC,EAA3D,EAA+D;MAC7D,IAAMgB,IAAI,GAAG,EAAb;;MACA,KAAK,IAAIC,CAAC,GAAG,CAAR,EAAWC,GAAhB,EAAqBD,CAAC,GAAGjB,CAAzB,EAA4BiB,CAAC,EAA7B,EAAiC;QAC/BC,GAAG,GAAG;UACJzC,CAAC,EAAEuB,CAAC,IAAIN,CAAC,CAACuB,CAAC,GAAG,CAAL,CAAD,CAASxC,CAAT,GAAaiB,CAAC,CAACuB,CAAD,CAAD,CAAKxC,CAAtB,CADA;UAEJC,CAAC,EAAEsB,CAAC,IAAIN,CAAC,CAACuB,CAAC,GAAG,CAAL,CAAD,CAASvC,CAAT,GAAagB,CAAC,CAACuB,CAAD,CAAD,CAAKvC,CAAtB;QAFA,CAAN;;QAIA,IAAIY,GAAJ,EAAS;UACP4B,GAAG,CAACvC,CAAJ,GAAQqB,CAAC,IAAIN,CAAC,CAACuB,CAAC,GAAG,CAAL,CAAD,CAAStC,CAAT,GAAae,CAAC,CAACuB,CAAD,CAAD,CAAKtC,CAAtB,CAAT;QACD;;QACDqC,IAAI,CAACG,IAAL,CAAUD,GAAV;MACD;;MACDH,OAAO,CAACI,IAAR,CAAaH,IAAb;MACAtB,CAAC,GAAGsB,IAAJ;IACD;;IACD,OAAOD,OAAP;EACD,CAnOW;EAqOZK,OAAO,EAAE,iBAAUvD,CAAV,EAAawD,CAAb,EAAgBC,CAAhB,EAAmB;IAC1B,OACGD,CAAC,IAAIxD,CAAL,IAAUA,CAAC,IAAIyD,CAAhB,IACA1C,KAAK,CAAC2C,aAAN,CAAoB1D,CAApB,EAAuBwD,CAAvB,CADA,IAEAzC,KAAK,CAAC2C,aAAN,CAAoB1D,CAApB,EAAuByD,CAAvB,CAHF;EAKD,CA3OW;EA6OZC,aAAa,EAAE,uBAAUzB,CAAV,EAAaC,CAAb,EAAgByB,SAAhB,EAA2B;IACxC,OAAOpE,GAAG,CAAC0C,CAAC,GAAGC,CAAL,CAAH,KAAeyB,SAAS,IAAItD,OAA5B,CAAP;EACD,CA/OW;EAiPZsB,MAAM,EAAE,gBAAUP,YAAV,EAAwB;IAC9B,IAAMN,CAAC,GAAG,GAAV;IAAA,IACE8C,GAAG,GAAG7C,KAAK,CAACC,OAAN,CAAcW,MADtB;IAGA,IAAIkC,GAAG,GAAG,CAAV;;IAEA,KAAK,IAAIrB,CAAC,GAAG,CAAR,EAAWrB,CAAhB,EAAmBqB,CAAC,GAAGoB,GAAvB,EAA4BpB,CAAC,EAA7B,EAAiC;MAC/BrB,CAAC,GAAGL,CAAC,GAAGC,KAAK,CAACC,OAAN,CAAcwB,CAAd,CAAJ,GAAuB1B,CAA3B;MACA+C,GAAG,IAAI9C,KAAK,CAACE,OAAN,CAAcuB,CAAd,IAAmBzB,KAAK,CAACG,KAAN,CAAYC,CAAZ,EAAeC,YAAf,CAA1B;IACD;;IACD,OAAON,CAAC,GAAG+C,GAAX;EACD,CA5PW;EA8PZC,GAAG,EAAE,aAAU9D,CAAV,EAAa+D,EAAb,EAAiBC,EAAjB,EAAqBC,EAArB,EAAyBC,EAAzB,EAA6B;IAChC,IAAMC,EAAE,GAAGH,EAAE,GAAGD,EAAhB;IAAA,IACEK,EAAE,GAAGF,EAAE,GAAGD,EADZ;IAAA,IAEEI,EAAE,GAAGrE,CAAC,GAAG+D,EAFX;IAAA,IAGEnB,CAAC,GAAGyB,EAAE,GAAGF,EAHX;IAIA,OAAOF,EAAE,GAAGG,EAAE,GAAGxB,CAAjB;EACD,CApQW;EAsQZ0B,IAAI,EAAE,cAAU1B,CAAV,EAAa2B,EAAb,EAAiBF,EAAjB,EAAqB;IACzB,IAAMvC,GAAG,GAAG;MACVlB,CAAC,EAAE2D,EAAE,CAAC3D,CAAH,GAAOgC,CAAC,IAAIyB,EAAE,CAACzD,CAAH,GAAO2D,EAAE,CAAC3D,CAAd,CADD;MAEVC,CAAC,EAAE0D,EAAE,CAAC1D,CAAH,GAAO+B,CAAC,IAAIyB,EAAE,CAACxD,CAAH,GAAO0D,EAAE,CAAC1D,CAAd;IAFD,CAAZ;;IAIA,IAAI0D,EAAE,CAACzD,CAAH,KAAS0D,SAAT,IAAsBH,EAAE,CAACvD,CAAH,KAAS0D,SAAnC,EAA8C;MAC5C1C,GAAG,CAAChB,CAAJ,GAAQyD,EAAE,CAACzD,CAAH,GAAO8B,CAAC,IAAIyB,EAAE,CAACvD,CAAH,GAAOyD,EAAE,CAACzD,CAAd,CAAhB;IACD;;IACD,OAAOgB,GAAP;EACD,CA/QW;EAiRZ2C,aAAa,EAAE,uBAAU5C,CAAV,EAAa;IAC1B,IAAI6C,CAAC,GAAG7C,CAAC,CAACjB,CAAF,GAAM,GAAN,GAAYiB,CAAC,CAAChB,CAAtB;;IACA,IAAI,OAAOgB,CAAC,CAACf,CAAT,KAAe,WAAnB,EAAgC;MAC9B4D,CAAC,IAAI,MAAM7C,CAAC,CAACf,CAAb;IACD;;IACD,OAAO4D,CAAP;EACD,CAvRW;EAyRZC,cAAc,EAAE,wBAAUnD,MAAV,EAAkB;IAChC,OAAO,MAAMA,MAAM,CAACsC,GAAP,CAAW/C,KAAK,CAAC0D,aAAjB,EAAgCG,IAAhC,CAAqC,IAArC,CAAN,GAAmD,GAA1D;EACD,CA3RW;EA6RZC,IAAI,EAAE,cAAUC,GAAV,EAAe;IACnB,OAAOzC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,SAAL,CAAeuC,GAAf,CAAX,CAAP;EACD,CA/RW;EAiSZC,KAAK,EAAE,eAAUC,CAAV,EAAaT,EAAb,EAAiBF,EAAjB,EAAqB;IAC1B,IAAMY,GAAG,GAAGV,EAAE,CAAC3D,CAAH,GAAOoE,CAAC,CAACpE,CAArB;IAAA,IACEsE,GAAG,GAAGX,EAAE,CAAC1D,CAAH,GAAOmE,CAAC,CAACnE,CADjB;IAAA,IAEEsE,GAAG,GAAGd,EAAE,CAACzD,CAAH,GAAOoE,CAAC,CAACpE,CAFjB;IAAA,IAGEwE,GAAG,GAAGf,EAAE,CAACxD,CAAH,GAAOmE,CAAC,CAACnE,CAHjB;IAAA,IAIEwE,KAAK,GAAGJ,GAAG,GAAGG,GAAN,GAAYF,GAAG,GAAGC,GAJ5B;IAAA,IAKEG,GAAG,GAAGL,GAAG,GAAGE,GAAN,GAAYD,GAAG,GAAGE,GAL1B;IAMA,OAAOxF,KAAK,CAACyF,KAAD,EAAQC,GAAR,CAAZ;EACD,CAzSW;EA2SZ;EACAC,KAAK,EAAE,eAAUvF,CAAV,EAAaqB,CAAb,EAAgB;IACrB,IAAMqD,CAAC,GAAG,KAAK1E,CAAf;IACA,IAAMwF,GAAG,GAAGd,CAAC,CAACe,OAAF,CAAU,GAAV,CAAZ;IACA,OAAOC,UAAU,CAAChB,CAAC,CAACiB,SAAF,CAAY,CAAZ,EAAeH,GAAG,GAAG,CAAN,GAAUnE,CAAzB,CAAD,CAAjB;EACD,CAhTW;EAkTZuE,IAAI,EAAE,cAAUC,EAAV,EAAcC,EAAd,EAAkB;IACtB,IAAMC,EAAE,GAAGF,EAAE,CAACjF,CAAH,GAAOkF,EAAE,CAAClF,CAArB;IAAA,IACEoF,EAAE,GAAGH,EAAE,CAAChF,CAAH,GAAOiF,EAAE,CAACjF,CADjB;IAEA,OAAOhB,IAAI,CAACkG,EAAE,GAAGA,EAAL,GAAUC,EAAE,GAAGA,EAAhB,CAAX;EACD,CAtTW;EAwTZC,OAAO,EAAE,iBAAUC,GAAV,EAAeC,KAAf,EAAsB;IAC7B,IAAIC,KAAK,GAAGtG,GAAG,CAAC,CAAD,EAAI,EAAJ,CAAf;IAAA,IACEuG,IADF;IAAA,IAEEhF,CAFF;IAGA6E,GAAG,CAACI,OAAJ,CAAY,UAAUzE,CAAV,EAAa0E,GAAb,EAAkB;MAC5BlF,CAAC,GAAGN,KAAK,CAAC6E,IAAN,CAAWO,KAAX,EAAkBtE,CAAlB,CAAJ;;MACA,IAAIR,CAAC,GAAG+E,KAAR,EAAe;QACbA,KAAK,GAAG/E,CAAR;QACAgF,IAAI,GAAGE,GAAP;MACD;IACF,CAND;IAOA,OAAO;MAAEH,KAAK,EAAEA,KAAT;MAAgBC,IAAI,EAAEA;IAAtB,CAAP;EACD,CApUW;EAsUZG,QAAQ,EAAE,kBAAUrF,CAAV,EAAasF,CAAb,EAAgB;IACxB;IACA,IAAIA,CAAC,KAAK,CAAN,IAAWA,CAAC,KAAK,CAArB,EAAwB;MACtB,OAAO,KAAP;IACD;;IACD,IAAI,OAAOtF,CAAP,KAAa,WAAjB,EAA8B;MAC5BA,CAAC,GAAG,GAAJ;IACD,CAFD,MAEO,IAAIA,CAAC,KAAK,CAAN,IAAWA,CAAC,KAAK,CAArB,EAAwB;MAC7B,OAAOA,CAAP;IACD;;IACD,IAAMuF,MAAM,GAAG5G,GAAG,CAACqB,CAAD,EAAIsF,CAAJ,CAAH,GAAY3G,GAAG,CAAC,IAAIqB,CAAL,EAAQsF,CAAR,CAA9B;IAAA,IACEE,GAAG,GAAGD,MAAM,GAAG,CADjB;IAEA,OAAOnH,GAAG,CAACoH,GAAG,GAAGD,MAAP,CAAV;EACD,CAnVW;EAqVZE,eAAe,EAAE,yBAAUzF,CAAV,EAAasF,CAAb,EAAgB;IAC/B;IACA,IAAIA,CAAC,KAAK,CAAN,IAAWA,CAAC,KAAK,CAArB,EAAwB;MACtB,OAAO,KAAP;IACD;;IACD,IAAI,OAAOtF,CAAP,KAAa,WAAjB,EAA8B;MAC5BA,CAAC,GAAG,GAAJ;IACD,CAFD,MAEO,IAAIA,CAAC,KAAK,CAAN,IAAWA,CAAC,KAAK,CAArB,EAAwB;MAC7B,OAAOA,CAAP;IACD;;IACD,IAAMwF,GAAG,GAAG7G,GAAG,CAAC,IAAIqB,CAAL,EAAQsF,CAAR,CAAf;IAAA,IACEC,MAAM,GAAG5G,GAAG,CAACqB,CAAD,EAAIsF,CAAJ,CAAH,GAAYE,GADvB;IAEA,OAAOA,GAAG,GAAGD,MAAb;EACD,CAlWW;EAoWZG,IAAI,EAAE,cAAUC,EAAV,EAAcC,EAAd,EAAkBC,EAAlB,EAAsBC,EAAtB,EAA0BC,EAA1B,EAA8BC,EAA9B,EAAkCC,EAAlC,EAAsCC,EAAtC,EAA0C;IAC9C,IAAMC,EAAE,GACJ,CAACR,EAAE,GAAGG,EAAL,GAAUF,EAAE,GAAGC,EAAhB,KAAuBE,EAAE,GAAGE,EAA5B,IAAkC,CAACN,EAAE,GAAGE,EAAN,KAAaE,EAAE,GAAGG,EAAL,GAAUF,EAAE,GAAGC,EAA5B,CADtC;IAAA,IAEEG,EAAE,GAAG,CAACT,EAAE,GAAGG,EAAL,GAAUF,EAAE,GAAGC,EAAhB,KAAuBG,EAAE,GAAGE,EAA5B,IAAkC,CAACN,EAAE,GAAGE,EAAN,KAAaC,EAAE,GAAGG,EAAL,GAAUF,EAAE,GAAGC,EAA5B,CAFzC;IAAA,IAGE/F,CAAC,GAAG,CAACyF,EAAE,GAAGE,EAAN,KAAaG,EAAE,GAAGE,EAAlB,IAAwB,CAACN,EAAE,GAAGE,EAAN,KAAaC,EAAE,GAAGE,EAAlB,CAH9B;;IAIA,IAAI/F,CAAC,IAAI,CAAT,EAAY;MACV,OAAO,KAAP;IACD;;IACD,OAAO;MAAET,CAAC,EAAE0G,EAAE,GAAGjG,CAAV;MAAaR,CAAC,EAAE0G,EAAE,GAAGlG;IAArB,CAAP;EACD,CA7WW;EA+WZmG,IAAI,EAAE,cAAU3B,EAAV,EAAcC,EAAd,EAAkB2B,EAAlB,EAAsBC,EAAtB,EAA0B;IAC9B,IAAMZ,EAAE,GAAGjB,EAAE,CAACjF,CAAd;IAAA,IACEmG,EAAE,GAAGlB,EAAE,CAAChF,CADV;IAAA,IAEEmG,EAAE,GAAGlB,EAAE,CAAClF,CAFV;IAAA,IAGEqG,EAAE,GAAGnB,EAAE,CAACjF,CAHV;IAAA,IAIEqG,EAAE,GAAGO,EAAE,CAAC7G,CAJV;IAAA,IAKEuG,EAAE,GAAGM,EAAE,CAAC5G,CALV;IAAA,IAMEuG,EAAE,GAAGM,EAAE,CAAC9G,CANV;IAAA,IAOEyG,EAAE,GAAGK,EAAE,CAAC7G,CAPV;IAQA,OAAOE,KAAK,CAAC8F,IAAN,CAAWC,EAAX,EAAeC,EAAf,EAAmBC,EAAnB,EAAuBC,EAAvB,EAA2BC,EAA3B,EAA+BC,EAA/B,EAAmCC,EAAnC,EAAuCC,EAAvC,CAAP;EACD,CAzXW;EA2XZM,GAAG,EAAE,aAAUpD,EAAV,EAAcF,EAAd,EAAkB;IACrB,OAAOtD,KAAK,CAACyG,IAAN,CAAWjD,EAAX,EAAeA,EAAE,CAACpC,CAAlB,EAAqBkC,EAArB,EAAyBA,EAAE,CAAClC,CAA5B,CAAP;EACD,CA7XW;EA+XZyF,QAAQ,EAAE,kBAAU/B,EAAV,EAAcC,EAAd,EAAkB;IAC1B,OAAO,IAAIxG,MAAJ,CACLuG,EAAE,CAACjF,CADE,EAELiF,EAAE,CAAChF,CAFE,EAGL,CAACgF,EAAE,CAACjF,CAAH,GAAOkF,EAAE,CAAClF,CAAX,IAAgB,CAHX,EAIL,CAACiF,EAAE,CAAChF,CAAH,GAAOiF,EAAE,CAACjF,CAAX,IAAgB,CAJX,EAKLiF,EAAE,CAAClF,CALE,EAMLkF,EAAE,CAACjF,CANE,CAAP;EAQD,CAxYW;EA0YZgH,QAAQ,EAAE,kBAAUC,QAAV,EAAoB;IAC5B,IAAIC,EAAE,GAAGzH,IAAT;IAAA,IACE0H,EAAE,GAAG1H,IADP;IAAA,IAEE2H,EAAE,GAAGxH,IAFP;IAAA,IAGEyH,EAAE,GAAGzH,IAHP;IAIAqH,QAAQ,CAACxB,OAAT,CAAiB,UAAU5B,CAAV,EAAa;MAC5B,IAAMyD,IAAI,GAAGzD,CAAC,CAACyD,IAAF,EAAb;MACA,IAAIJ,EAAE,GAAGI,IAAI,CAACvH,CAAL,CAAOwH,GAAhB,EAAqBL,EAAE,GAAGI,IAAI,CAACvH,CAAL,CAAOwH,GAAZ;MACrB,IAAIJ,EAAE,GAAGG,IAAI,CAACtH,CAAL,CAAOuH,GAAhB,EAAqBJ,EAAE,GAAGG,IAAI,CAACtH,CAAL,CAAOuH,GAAZ;MACrB,IAAIH,EAAE,GAAGE,IAAI,CAACvH,CAAL,CAAOyH,GAAhB,EAAqBJ,EAAE,GAAGE,IAAI,CAACvH,CAAL,CAAOyH,GAAZ;MACrB,IAAIH,EAAE,GAAGC,IAAI,CAACtH,CAAL,CAAOwH,GAAhB,EAAqBH,EAAE,GAAGC,IAAI,CAACtH,CAAL,CAAOwH,GAAZ;IACtB,CAND;IAOA,OAAO;MACLzH,CAAC,EAAE;QAAEwH,GAAG,EAAEL,EAAP;QAAWO,GAAG,EAAE,CAACP,EAAE,GAAGE,EAAN,IAAY,CAA5B;QAA+BI,GAAG,EAAEJ,EAApC;QAAwCM,IAAI,EAAEN,EAAE,GAAGF;MAAnD,CADE;MAELlH,CAAC,EAAE;QAAEuH,GAAG,EAAEJ,EAAP;QAAWM,GAAG,EAAE,CAACN,EAAE,GAAGE,EAAN,IAAY,CAA5B;QAA+BG,GAAG,EAAEH,EAApC;QAAwCK,IAAI,EAAEL,EAAE,GAAGF;MAAnD;IAFE,CAAP;EAID,CA1ZW;EA4ZZQ,kBAAkB,EAAE,4BAClBC,EADkB,EAElBC,KAFkB,EAGlBC,EAHkB,EAIlBC,KAJkB,EAKlBC,0BALkB,EAMlB;IACA,IAAI,CAAC9H,KAAK,CAAC+H,WAAN,CAAkBJ,KAAlB,EAAyBE,KAAzB,CAAL,EAAsC,OAAO,EAAP;IACtC,IAAMG,aAAa,GAAG,EAAtB;IACA,IAAMC,EAAE,GAAG,CAACP,EAAE,CAACQ,QAAJ,EAAcR,EAAE,CAACS,OAAjB,EAA0BT,EAAE,CAACU,IAA7B,EAAmCV,EAAE,CAACW,MAAtC,CAAX;IACA,IAAMC,EAAE,GAAG,CAACV,EAAE,CAACM,QAAJ,EAAcN,EAAE,CAACO,OAAjB,EAA0BP,EAAE,CAACQ,IAA7B,EAAmCR,EAAE,CAACS,MAAtC,CAAX;IACAJ,EAAE,CAAC1C,OAAH,CAAW,UAAUgD,EAAV,EAAc;MACvB,IAAIA,EAAE,CAACC,OAAP,EAAgB;MAChBF,EAAE,CAAC/C,OAAH,CAAW,UAAUkD,EAAV,EAAc;QACvB,IAAIA,EAAE,CAACD,OAAP,EAAgB;QAChB,IAAME,GAAG,GAAGH,EAAE,CAACI,UAAH,CAAcF,EAAd,EAAkBX,0BAAlB,CAAZ;;QACA,IAAIY,GAAG,CAAC9H,MAAJ,GAAa,CAAjB,EAAoB;UAClB8H,GAAG,CAACE,EAAJ,GAASL,EAAT;UACAG,GAAG,CAACG,EAAJ,GAASJ,EAAT;UACAC,GAAG,CAAChB,EAAJ,GAASA,EAAT;UACAgB,GAAG,CAACd,EAAJ,GAASA,EAAT;UACAI,aAAa,CAACzF,IAAd,CAAmBmG,GAAnB;QACD;MACF,CAVD;IAWD,CAbD;IAcA,OAAOV,aAAP;EACD,CAtbW;EAwbZc,SAAS,EAAE,mBAAUX,OAAV,EAAmBC,IAAnB,EAAyBN,0BAAzB,EAAqD;IAC9D,IAAMiB,GAAG,GAAGX,IAAI,CAAC3H,MAAL,CAAYG,MAAxB;IACA,IAAMoI,GAAG,GAAGb,OAAO,CAAC1H,MAAR,CAAeG,MAA3B;IACA,IAAMqI,KAAK,GAAGjJ,KAAK,CAAC6G,QAAN,CAAeuB,IAAI,CAAC3H,MAAL,CAAYsI,GAAG,GAAG,CAAlB,CAAf,EAAqCZ,OAAO,CAAC1H,MAAR,CAAe,CAAf,CAArC,CAAd;IACA,IAAMyI,GAAG,GAAGlJ,KAAK,CAAC6G,QAAN,CAAesB,OAAO,CAAC1H,MAAR,CAAeuI,GAAG,GAAG,CAArB,CAAf,EAAwCZ,IAAI,CAAC3H,MAAL,CAAY,CAAZ,CAAxC,CAAZ;IACA,IAAM0I,KAAK,GAAG;MACZjB,QAAQ,EAAEe,KADE;MAEZd,OAAO,EAAEA,OAFG;MAGZC,IAAI,EAAEA,IAHM;MAIZC,MAAM,EAAEa,GAJI;MAKZ9B,IAAI,EAAEpH,KAAK,CAAC8G,QAAN,CAAe,CAACmC,KAAD,EAAQd,OAAR,EAAiBC,IAAjB,EAAuBc,GAAvB,CAAf;IALM,CAAd;;IAOAC,KAAK,CAACnB,aAAN,GAAsB,UAAUJ,EAAV,EAAc;MAClC,OAAO5H,KAAK,CAACyH,kBAAN,CACL0B,KADK,EAELA,KAAK,CAAC/B,IAFD,EAGLQ,EAHK,EAILA,EAAE,CAACR,IAJE,EAKLU,0BALK,CAAP;IAOD,CARD;;IASA,OAAOqB,KAAP;EACD,CA9cW;EAgdZC,SAAS,EAAE,mBAAUC,KAAV,EAAiB/I,CAAjB,EAAoB8B,IAApB,EAA0B;IACnC,IAAI,CAACA,IAAL,EAAW,OAAO;MAAEiF,GAAG,EAAE,CAAP;MAAUC,GAAG,EAAE;IAAf,CAAP;IACX,IAAID,GAAG,GAAG9H,IAAV;IAAA,IACE+H,GAAG,GAAG5H,IADR;IAAA,IAEEU,CAFF;IAAA,IAGEgB,CAHF;;IAIA,IAAIgB,IAAI,CAACsC,OAAL,CAAa,CAAb,MAAoB,CAAC,CAAzB,EAA4B;MAC1BtC,IAAI,GAAG,CAAC,CAAD,EAAIkH,MAAJ,CAAWlH,IAAX,CAAP;IACD;;IACD,IAAIA,IAAI,CAACsC,OAAL,CAAa,CAAb,MAAoB,CAAC,CAAzB,EAA4B;MAC1BtC,IAAI,CAACG,IAAL,CAAU,CAAV;IACD;;IACD,KAAK,IAAId,CAAC,GAAG,CAAR,EAAWoB,GAAG,GAAGT,IAAI,CAACxB,MAA3B,EAAmCa,CAAC,GAAGoB,GAAvC,EAA4CpB,CAAC,EAA7C,EAAiD;MAC/CrB,CAAC,GAAGgC,IAAI,CAACX,CAAD,CAAR;MACAL,CAAC,GAAGiI,KAAK,CAACE,GAAN,CAAUnJ,CAAV,CAAJ;;MACA,IAAIgB,CAAC,CAACd,CAAD,CAAD,GAAO+G,GAAX,EAAgB;QACdA,GAAG,GAAGjG,CAAC,CAACd,CAAD,CAAP;MACD;;MACD,IAAIc,CAAC,CAACd,CAAD,CAAD,GAAOgH,GAAX,EAAgB;QACdA,GAAG,GAAGlG,CAAC,CAACd,CAAD,CAAP;MACD;IACF;;IACD,OAAO;MAAE+G,GAAG,EAAEA,GAAP;MAAYE,GAAG,EAAE,CAACF,GAAG,GAAGC,GAAP,IAAc,CAA/B;MAAkCA,GAAG,EAAEA,GAAvC;MAA4CE,IAAI,EAAEF,GAAG,GAAGD;IAAxD,CAAP;EACD,CAveW;EAyeZmC,KAAK,EAAE,eAAU/I,MAAV,EAAkBgJ,IAAlB,EAAwB;IAC7B,IAAMC,EAAE,GAAGD,IAAI,CAAC3E,EAAL,CAAQjF,CAAnB;IAAA,IACE8J,EAAE,GAAGF,IAAI,CAAC3E,EAAL,CAAQhF,CADf;IAAA,IAEEoB,CAAC,GAAG,CAACrC,KAAK,CAAC4K,IAAI,CAAC1E,EAAL,CAAQjF,CAAR,GAAY6J,EAAb,EAAiBF,IAAI,CAAC1E,EAAL,CAAQlF,CAAR,GAAY6J,EAA7B,CAFZ;IAAA,IAGEpJ,CAAC,GAAG,SAAJA,CAAI,CAAUrB,CAAV,EAAa;MACf,OAAO;QACLY,CAAC,EAAE,CAACZ,CAAC,CAACY,CAAF,GAAM6J,EAAP,IAAahL,GAAG,CAACwC,CAAD,CAAhB,GAAsB,CAACjC,CAAC,CAACa,CAAF,GAAM6J,EAAP,IAAahL,GAAG,CAACuC,CAAD,CADpC;QAELpB,CAAC,EAAE,CAACb,CAAC,CAACY,CAAF,GAAM6J,EAAP,IAAa/K,GAAG,CAACuC,CAAD,CAAhB,GAAsB,CAACjC,CAAC,CAACa,CAAF,GAAM6J,EAAP,IAAajL,GAAG,CAACwC,CAAD;MAFpC,CAAP;IAID,CARH;;IASA,OAAOT,MAAM,CAACsC,GAAP,CAAWzC,CAAX,CAAP;EACD,CApfW;EAsfZsJ,KAAK,EAAE,eAAUnJ,MAAV,EAAkBgJ,IAAlB,EAAwB;IAC7BA,IAAI,GAAGA,IAAI,IAAI;MAAE3E,EAAE,EAAE;QAAEjF,CAAC,EAAE,CAAL;QAAQC,CAAC,EAAE;MAAX,CAAN;MAAsBiF,EAAE,EAAE;QAAElF,CAAC,EAAE,CAAL;QAAQC,CAAC,EAAE;MAAX;IAA1B,CAAf;IAEA,IAAMa,KAAK,GAAGF,MAAM,CAACG,MAAP,GAAgB,CAA9B;IACA,IAAMiJ,OAAO,GAAG7J,KAAK,CAACwJ,KAAN,CAAY/I,MAAZ,EAAoBgJ,IAApB,CAAhB;;IACA,IAAMK,MAAM,GAAG,SAATA,MAAS,CAAU1J,CAAV,EAAa;MAC1B,OAAO,KAAKA,CAAL,IAAUA,CAAC,IAAI,CAAtB;IACD,CAFD;;IAIA,IAAIO,KAAK,KAAK,CAAd,EAAiB;MACf,IAAMO,EAAC,GAAG2I,OAAO,CAAC,CAAD,CAAP,CAAW/J,CAArB;MAAA,IACEqB,EAAC,GAAG0I,OAAO,CAAC,CAAD,CAAP,CAAW/J,CADjB;MAAA,IAEEsB,EAAC,GAAGyI,OAAO,CAAC,CAAD,CAAP,CAAW/J,CAFjB;MAAA,IAGEQ,EAAC,GAAGY,EAAC,GAAG,IAAIC,EAAR,GAAYC,EAHlB;;MAIA,IAAId,EAAC,KAAK,CAAV,EAAa;QACX,IAAMyJ,EAAE,GAAG,CAACjL,IAAI,CAACqC,EAAC,GAAGA,EAAJ,GAAQD,EAAC,GAAGE,EAAb,CAAhB;QAAA,IACE4I,EAAE,GAAG,CAAC9I,EAAD,GAAKC,EADZ;QAAA,IAEEqC,EAAE,GAAG,EAAEuG,EAAE,GAAGC,EAAP,IAAa1J,EAFpB;QAAA,IAGEgD,EAAE,GAAG,EAAE,CAACyG,EAAD,GAAMC,EAAR,IAAc1J,EAHrB;;QAIA,OAAO,CAACkD,EAAD,EAAKF,EAAL,EAAS2G,MAAT,CAAgBH,MAAhB,CAAP;MACD,CAND,MAMO,IAAI3I,EAAC,KAAKC,EAAN,IAAWd,EAAC,KAAK,CAArB,EAAwB;QAC7B,OAAO,CAAC,CAAC,IAAIa,EAAJ,GAAQC,EAAT,KAAe,IAAID,EAAJ,GAAQ,IAAIC,EAA3B,CAAD,EAAgC6I,MAAhC,CAAuCH,MAAvC,CAAP;MACD;;MACD,OAAO,EAAP;IACD,CAxB4B,CA0B7B;;;IACA,IAAMI,EAAE,GAAGL,OAAO,CAAC,CAAD,CAAP,CAAW/J,CAAtB;IAAA,IACEqK,EAAE,GAAGN,OAAO,CAAC,CAAD,CAAP,CAAW/J,CADlB;IAAA,IAEEsK,EAAE,GAAGP,OAAO,CAAC,CAAD,CAAP,CAAW/J,CAFlB;IAAA,IAGEuK,EAAE,GAAGR,OAAO,CAAC,CAAD,CAAP,CAAW/J,CAHlB;IAKA,IAAIQ,CAAC,GAAG,CAAC4J,EAAD,GAAM,IAAIC,EAAV,GAAe,IAAIC,EAAnB,GAAwBC,EAAhC;IAAA,IACEnJ,CAAC,GAAG,IAAIgJ,EAAJ,GAAS,IAAIC,EAAb,GAAkB,IAAIC,EAD5B;IAAA,IAEEjJ,CAAC,GAAG,CAAC,CAAD,GAAK+I,EAAL,GAAU,IAAIC,EAFpB;IAAA,IAGE/I,CAAC,GAAG8I,EAHN;;IAKA,IAAIlK,KAAK,CAAC2C,aAAN,CAAoBrC,CAApB,EAAuB,CAAvB,CAAJ,EAA+B;MAC7B;MACA,IAAIN,KAAK,CAAC2C,aAAN,CAAoBzB,CAApB,EAAuB,CAAvB,CAAJ,EAA+B;QAC7B;QACA,IAAIlB,KAAK,CAAC2C,aAAN,CAAoBxB,CAApB,EAAuB,CAAvB,CAAJ,EAA+B;UAC7B;UACA,OAAO,EAAP;QACD,CAL4B,CAM7B;;;QACA,OAAO,CAAC,CAACC,CAAD,GAAKD,CAAN,EAAS8I,MAAT,CAAgBH,MAAhB,CAAP;MACD,CAV4B,CAW7B;;;MACA,IAAMQ,EAAC,GAAGxL,IAAI,CAACqC,CAAC,GAAGA,CAAJ,GAAQ,IAAID,CAAJ,GAAQE,CAAjB,CAAd;MAAA,IACEkH,EAAE,GAAG,IAAIpH,CADX;;MAEA,OAAO,CAAC,CAACoJ,EAAC,GAAGnJ,CAAL,IAAUmH,EAAX,EAAe,CAAC,CAACnH,CAAD,GAAKmJ,EAAN,IAAWhC,EAA1B,EAA8B2B,MAA9B,CAAqCH,MAArC,CAAP;IACD,CApD4B,CAsD7B;;;IAEA5I,CAAC,IAAIZ,CAAL;IACAa,CAAC,IAAIb,CAAL;IACAc,CAAC,IAAId,CAAL;IAEA,IAAMQ,CAAC,GAAG,CAAC,IAAIK,CAAJ,GAAQD,CAAC,GAAGA,CAAb,IAAkB,CAA5B;IAAA,IACEwF,EAAE,GAAG5F,CAAC,GAAG,CADX;IAAA,IAEEwJ,CAAC,GAAG,CAAC,IAAIpJ,CAAJ,GAAQA,CAAR,GAAYA,CAAZ,GAAgB,IAAIA,CAAJ,GAAQC,CAAxB,GAA4B,KAAKC,CAAlC,IAAuC,EAF7C;IAAA,IAGEmJ,EAAE,GAAGD,CAAC,GAAG,CAHX;IAAA,IAIEE,YAAY,GAAGD,EAAE,GAAGA,EAAL,GAAU7D,EAAE,GAAGA,EAAL,GAAUA,EAJrC;IAMA,IAAI+D,EAAJ,EAAQjH,EAAR,EAAYuC,EAAZ,EAAgBE,EAAhB,EAAoBE,EAApB;;IACA,IAAIqE,YAAY,GAAG,CAAnB,EAAsB;MACpB,IAAME,GAAG,GAAG,CAAC5J,CAAD,GAAK,CAAjB;MAAA,IACE6J,IAAI,GAAGD,GAAG,GAAGA,GAAN,GAAYA,GADrB;MAAA,IAEE7I,CAAC,GAAG/C,IAAI,CAAC6L,IAAD,CAFV;MAAA,IAGEvK,CAAC,GAAG,CAACkK,CAAD,IAAM,IAAIzI,CAAV,CAHN;MAAA,IAIE+I,MAAM,GAAGxK,CAAC,GAAG,CAAC,CAAL,GAAS,CAAC,CAAV,GAAcA,CAAC,GAAG,CAAJ,GAAQ,CAAR,GAAYA,CAJrC;MAAA,IAKEyK,GAAG,GAAGjM,IAAI,CAACgM,MAAD,CALZ;MAAA,IAMEE,IAAI,GAAG9L,GAAG,CAAC6C,CAAD,CANZ;MAAA,IAOEkJ,EAAE,GAAG,IAAID,IAPX;MAQA/E,EAAE,GAAGgF,EAAE,GAAGrM,GAAG,CAACmM,GAAG,GAAG,CAAP,CAAR,GAAoB3J,CAAC,GAAG,CAA7B;MACA+E,EAAE,GAAG8E,EAAE,GAAGrM,GAAG,CAAC,CAACmM,GAAG,GAAGzL,GAAP,IAAc,CAAf,CAAR,GAA4B8B,CAAC,GAAG,CAArC;MACAiF,EAAE,GAAG4E,EAAE,GAAGrM,GAAG,CAAC,CAACmM,GAAG,GAAG,IAAIzL,GAAX,IAAkB,CAAnB,CAAR,GAAgC8B,CAAC,GAAG,CAAzC;MACA,OAAO,CAAC6E,EAAD,EAAKE,EAAL,EAASE,EAAT,EAAa8D,MAAb,CAAoBH,MAApB,CAAP;IACD,CAbD,MAaO,IAAIU,YAAY,KAAK,CAArB,EAAwB;MAC7BC,EAAE,GAAGF,EAAE,GAAG,CAAL,GAASvL,GAAG,CAAC,CAACuL,EAAF,CAAZ,GAAoB,CAACvL,GAAG,CAACuL,EAAD,CAA7B;MACAxE,EAAE,GAAG,IAAI0E,EAAJ,GAASvJ,CAAC,GAAG,CAAlB;MACA+E,EAAE,GAAG,CAACwE,EAAD,GAAMvJ,CAAC,GAAG,CAAf;MACA,OAAO,CAAC6E,EAAD,EAAKE,EAAL,EAASgE,MAAT,CAAgBH,MAAhB,CAAP;IACD,CALM,MAKA;MACL,IAAMkB,EAAE,GAAGlM,IAAI,CAAC0L,YAAD,CAAf;MACAC,EAAE,GAAGzL,GAAG,CAAC,CAACuL,EAAD,GAAMS,EAAP,CAAR;MACAxH,EAAE,GAAGxE,GAAG,CAACuL,EAAE,GAAGS,EAAN,CAAR;MACA,OAAO,CAACP,EAAE,GAAGjH,EAAL,GAAUtC,CAAC,GAAG,CAAf,EAAkB+I,MAAlB,CAAyBH,MAAzB,CAAP;IACD;EACF,CAjlBW;EAmlBZmB,MAAM,EAAE,gBAAUnK,CAAV,EAAa;IACnB;IACA,IAAIA,CAAC,CAACF,MAAF,KAAa,CAAjB,EAAoB;MAClB,IAAMM,CAAC,GAAGJ,CAAC,CAAC,CAAD,CAAX;MAAA,IACEK,CAAC,GAAGL,CAAC,CAAC,CAAD,CADP;MAAA,IAEEM,CAAC,GAAGN,CAAC,CAAC,CAAD,CAFP;MAAA,IAGER,CAAC,GAAGY,CAAC,GAAG,IAAIC,CAAR,GAAYC,CAHlB;;MAIA,IAAId,CAAC,KAAK,CAAV,EAAa;QACX,IAAMyJ,EAAE,GAAG,CAACjL,IAAI,CAACqC,CAAC,GAAGA,CAAJ,GAAQD,CAAC,GAAGE,CAAb,CAAhB;QAAA,IACE4I,EAAE,GAAG,CAAC9I,CAAD,GAAKC,CADZ;QAAA,IAEEqC,EAAE,GAAG,EAAEuG,EAAE,GAAGC,EAAP,IAAa1J,CAFpB;QAAA,IAGEgD,EAAE,GAAG,EAAE,CAACyG,EAAD,GAAMC,EAAR,IAAc1J,CAHrB;QAIA,OAAO,CAACkD,EAAD,EAAKF,EAAL,CAAP;MACD,CAND,MAMO,IAAInC,CAAC,KAAKC,CAAN,IAAWd,CAAC,KAAK,CAArB,EAAwB;QAC7B,OAAO,CAAC,CAAC,IAAIa,CAAJ,GAAQC,CAAT,KAAe,KAAKD,CAAC,GAAGC,CAAT,CAAf,CAAD,CAAP;MACD;;MACD,OAAO,EAAP;IACD,CAjBkB,CAmBnB;;;IACA,IAAIN,CAAC,CAACF,MAAF,KAAa,CAAjB,EAAoB;MAClB,IAAMM,GAAC,GAAGJ,CAAC,CAAC,CAAD,CAAX;MAAA,IACEK,GAAC,GAAGL,CAAC,CAAC,CAAD,CADP;;MAEA,IAAII,GAAC,KAAKC,GAAV,EAAa;QACX,OAAO,CAACD,GAAC,IAAIA,GAAC,GAAGC,GAAR,CAAF,CAAP;MACD;;MACD,OAAO,EAAP;IACD;;IAED,OAAO,EAAP;EACD,CAjnBW;EAmnBZ+J,SAAS,EAAE,mBAAU9K,CAAV,EAAagD,EAAb,EAAiBC,EAAjB,EAAqB3C,GAArB,EAA0ByK,KAA1B,EAAiC;IAC1C,IAAIC,GAAJ;IAAA,IACEC,GADF;IAAA,IAEEC,GAFF;IAAA,IAGEC,EAHF;IAAA,IAIEC,CAAC,GAAG,CAJN;IAAA,IAKE3J,CAAC,GAAG,CALN,CAD0C,CAQ1C;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;;IAEA,IAAMvB,CAAC,GAAGN,KAAK,CAACQ,OAAN,CAAcJ,CAAd,EAAiBgD,EAAjB,CAAV;IACA,IAAMqI,EAAE,GAAGzL,KAAK,CAACQ,OAAN,CAAcJ,CAAd,EAAiBiD,EAAjB,CAAX;IACA,IAAMqI,KAAK,GAAGpL,CAAC,CAACT,CAAF,GAAMS,CAAC,CAACT,CAAR,GAAYS,CAAC,CAACR,CAAF,GAAMQ,CAAC,CAACR,CAAlC;;IAEA,IAAIY,GAAJ,EAAS;MACP0K,GAAG,GAAGtM,IAAI,CACRC,GAAG,CAACuB,CAAC,CAACR,CAAF,GAAM2L,EAAE,CAAC1L,CAAT,GAAa0L,EAAE,CAAC3L,CAAH,GAAOQ,CAAC,CAACP,CAAvB,EAA0B,CAA1B,CAAH,GACEhB,GAAG,CAACuB,CAAC,CAACP,CAAF,GAAM0L,EAAE,CAAC5L,CAAT,GAAa4L,EAAE,CAAC1L,CAAH,GAAOO,CAAC,CAACT,CAAvB,EAA0B,CAA1B,CADL,GAEEd,GAAG,CAACuB,CAAC,CAACT,CAAF,GAAM4L,EAAE,CAAC3L,CAAT,GAAa2L,EAAE,CAAC5L,CAAH,GAAOS,CAAC,CAACR,CAAvB,EAA0B,CAA1B,CAHG,CAAV;MAKAuL,GAAG,GAAGtM,GAAG,CAAC2M,KAAK,GAAGpL,CAAC,CAACP,CAAF,GAAMO,CAAC,CAACP,CAAjB,EAAoB,IAAI,CAAxB,CAAT;IACD,CAPD,MAOO;MACLqL,GAAG,GAAG9K,CAAC,CAACT,CAAF,GAAM4L,EAAE,CAAC3L,CAAT,GAAaQ,CAAC,CAACR,CAAF,GAAM2L,EAAE,CAAC5L,CAA5B;MACAwL,GAAG,GAAGtM,GAAG,CAAC2M,KAAD,EAAQ,IAAI,CAAZ,CAAT;IACD;;IAED,IAAIN,GAAG,KAAK,CAAR,IAAaC,GAAG,KAAK,CAAzB,EAA4B;MAC1B,OAAO;QAAEG,CAAC,EAAE,CAAL;QAAQ3J,CAAC,EAAE;MAAX,CAAP;IACD;;IAED2J,CAAC,GAAGJ,GAAG,GAAGC,GAAV;IACAxJ,CAAC,GAAGwJ,GAAG,GAAGD,GAAV,CA7C0C,CA+C1C;IACA;IACA;IACA;;IACA,IAAI,CAACD,KAAL,EAAY;MACV;MACA;MACA,IAAMQ,EAAE,GAAG3L,KAAK,CAACkL,SAAN,CAAgB9K,CAAC,GAAG,KAApB,EAA2BgD,EAA3B,EAA+BC,EAA/B,EAAmC3C,GAAnC,EAAwC,IAAxC,EAA8C8K,CAAzD;MACA,IAAMI,EAAE,GAAG5L,KAAK,CAACkL,SAAN,CAAgB9K,CAAC,GAAG,KAApB,EAA2BgD,EAA3B,EAA+BC,EAA/B,EAAmC3C,GAAnC,EAAwC,IAAxC,EAA8C8K,CAAzD;MACAD,EAAE,GAAG,CAACK,EAAE,GAAGJ,CAAL,IAAUA,CAAC,GAAGG,EAAd,CAAD,IAAsB,CAA3B;MACAL,GAAG,GAAG,CAAC9M,GAAG,CAACoN,EAAE,GAAGJ,CAAN,CAAH,GAAchN,GAAG,CAACgN,CAAC,GAAGG,EAAL,CAAlB,IAA8B,CAApC;IACD;;IAED,OAAO;MAAEH,CAAC,EAAEA,CAAL;MAAQ3J,CAAC,EAAEA,CAAX;MAAc0J,EAAE,EAAEA,EAAlB;MAAsBD,GAAG,EAAEA;IAA3B,CAAP;EACD,CAhrBW;EAkrBZO,WAAW,EAAE,qBAAUpL,MAAV,EAAkB;IAC7B,IAAIA,MAAM,CAACG,MAAP,GAAgB,CAApB,EAAuB,OAAO,EAAP,CADM,CAG7B;;IAEA,IAAME,CAAC,GAAGd,KAAK,CAACwJ,KAAN,CAAY/I,MAAZ,EAAoB;MAAEqE,EAAE,EAAErE,MAAM,CAAC,CAAD,CAAZ;MAAiBsE,EAAE,EAAEtE,MAAM,CAACqL,KAAP,CAAa,CAAC,CAAd,EAAiB,CAAjB;IAArB,CAApB,CAAV;IAAA,IACE5K,CAAC,GAAGJ,CAAC,CAAC,CAAD,CAAD,CAAKjB,CAAL,GAASiB,CAAC,CAAC,CAAD,CAAD,CAAKhB,CADpB;IAAA,IAEEqB,CAAC,GAAGL,CAAC,CAAC,CAAD,CAAD,CAAKjB,CAAL,GAASiB,CAAC,CAAC,CAAD,CAAD,CAAKhB,CAFpB;IAAA,IAGEsB,CAAC,GAAGN,CAAC,CAAC,CAAD,CAAD,CAAKjB,CAAL,GAASiB,CAAC,CAAC,CAAD,CAAD,CAAKhB,CAHpB;IAAA,IAIEQ,CAAC,GAAGQ,CAAC,CAAC,CAAD,CAAD,CAAKjB,CAAL,GAASiB,CAAC,CAAC,CAAD,CAAD,CAAKhB,CAJpB;IAAA,IAKE0D,EAAE,GAAG,MAAM,CAAC,CAAD,GAAKtC,CAAL,GAAS,IAAIC,CAAb,GAAiB,IAAIC,CAArB,GAAyBd,CAA/B,CALP;IAAA,IAMEgD,EAAE,GAAG,MAAM,IAAIpC,CAAJ,GAAQC,CAAR,GAAY,IAAIC,CAAtB,CANP;IAAA,IAOE2K,EAAE,GAAG,MAAM3K,CAAC,GAAGF,CAAV,CAPP;;IASA,IAAIlB,KAAK,CAAC2C,aAAN,CAAoBa,EAApB,EAAwB,CAAxB,CAAJ,EAAgC;MAC9B,IAAI,CAACxD,KAAK,CAAC2C,aAAN,CAAoBW,EAApB,EAAwB,CAAxB,CAAL,EAAiC;QAC/B,IAAIlD,CAAC,GAAG,CAAC2L,EAAD,GAAMzI,EAAd;QACA,IAAI,KAAKlD,CAAL,IAAUA,CAAC,IAAI,CAAnB,EAAsB,OAAO,CAACA,CAAD,CAAP;MACvB;;MACD,OAAO,EAAP;IACD;;IAED,IAAMiD,EAAE,GAAG,IAAIG,EAAf;IAEA,IAAIxD,KAAK,CAAC2C,aAAN,CAAoBU,EAApB,EAAwB,CAAxB,CAAJ,EAAgC,OAAO,EAAP;IAEhC,IAAM2I,GAAG,GAAG1I,EAAE,GAAGA,EAAL,GAAU,IAAIE,EAAJ,GAASuI,EAA/B;IAEA,IAAIC,GAAG,GAAG,CAAV,EAAa,OAAO,EAAP;IAEb,IAAMC,EAAE,GAAGxN,IAAI,CAACK,IAAL,CAAUkN,GAAV,CAAX;IAEA,OAAO,CAAC,CAACC,EAAE,GAAG3I,EAAN,IAAYD,EAAb,EAAiB,EAAEC,EAAE,GAAG2I,EAAP,IAAa5I,EAA9B,EAAkC4G,MAAlC,CAAyC,UAAUpI,CAAV,EAAa;MAC3D,OAAO,KAAKA,CAAL,IAAUA,CAAC,IAAI,CAAtB;IACD,CAFM,CAAP;EAGD,CArtBW;EAutBZkG,WAAW,EAAE,qBAAUmE,EAAV,EAAcC,EAAd,EAAkB;IAC7B,IAAMC,IAAI,GAAG,CAAC,GAAD,EAAM,GAAN,CAAb;IAAA,IACEvJ,GAAG,GAAGuJ,IAAI,CAACxL,MADb;;IAGA,KAAK,IAAIa,CAAC,GAAG,CAAR,EAAW4K,GAAX,EAAgB9L,CAAhB,EAAmBH,CAAnB,EAAsBE,CAA3B,EAA8BmB,CAAC,GAAGoB,GAAlC,EAAuCpB,CAAC,EAAxC,EAA4C;MAC1C4K,GAAG,GAAGD,IAAI,CAAC3K,CAAD,CAAV;MACAlB,CAAC,GAAG2L,EAAE,CAACG,GAAD,CAAF,CAAQ9E,GAAZ;MACAnH,CAAC,GAAG+L,EAAE,CAACE,GAAD,CAAF,CAAQ9E,GAAZ;MACAjH,CAAC,GAAG,CAAC4L,EAAE,CAACG,GAAD,CAAF,CAAQ7E,IAAR,GAAe2E,EAAE,CAACE,GAAD,CAAF,CAAQ7E,IAAxB,IAAgC,CAApC;MACA,IAAIhJ,GAAG,CAAC+B,CAAC,GAAGH,CAAL,CAAH,IAAcE,CAAlB,EAAqB,OAAO,KAAP;IACtB;;IACD,OAAO,IAAP;EACD,CAnuBW;EAquBZgM,SAAS,EAAE,mBAAUlF,IAAV,EAAgBmF,KAAhB,EAAuB;IAChC,IAAIA,KAAK,CAAC1M,CAAN,CAAQwH,GAAR,GAAcD,IAAI,CAACvH,CAAL,CAAOwH,GAAzB,EAA8B;MAC5BD,IAAI,CAACvH,CAAL,CAAOwH,GAAP,GAAakF,KAAK,CAAC1M,CAAN,CAAQwH,GAArB;IACD;;IACD,IAAIkF,KAAK,CAACzM,CAAN,CAAQuH,GAAR,GAAcD,IAAI,CAACtH,CAAL,CAAOuH,GAAzB,EAA8B;MAC5BD,IAAI,CAACtH,CAAL,CAAOuH,GAAP,GAAakF,KAAK,CAACzM,CAAN,CAAQuH,GAArB;IACD;;IACD,IAAIkF,KAAK,CAACxM,CAAN,IAAWwM,KAAK,CAACxM,CAAN,CAAQsH,GAAR,GAAcD,IAAI,CAACrH,CAAL,CAAOsH,GAApC,EAAyC;MACvCD,IAAI,CAACrH,CAAL,CAAOsH,GAAP,GAAakF,KAAK,CAACxM,CAAN,CAAQsH,GAArB;IACD;;IACD,IAAIkF,KAAK,CAAC1M,CAAN,CAAQyH,GAAR,GAAcF,IAAI,CAACvH,CAAL,CAAOyH,GAAzB,EAA8B;MAC5BF,IAAI,CAACvH,CAAL,CAAOyH,GAAP,GAAaiF,KAAK,CAAC1M,CAAN,CAAQyH,GAArB;IACD;;IACD,IAAIiF,KAAK,CAACzM,CAAN,CAAQwH,GAAR,GAAcF,IAAI,CAACtH,CAAL,CAAOwH,GAAzB,EAA8B;MAC5BF,IAAI,CAACtH,CAAL,CAAOwH,GAAP,GAAaiF,KAAK,CAACzM,CAAN,CAAQwH,GAArB;IACD;;IACD,IAAIiF,KAAK,CAACxM,CAAN,IAAWwM,KAAK,CAACxM,CAAN,CAAQuH,GAAR,GAAcF,IAAI,CAACrH,CAAL,CAAOuH,GAApC,EAAyC;MACvCF,IAAI,CAACrH,CAAL,CAAOuH,GAAP,GAAaiF,KAAK,CAACxM,CAAN,CAAQuH,GAArB;IACD;;IACDF,IAAI,CAACvH,CAAL,CAAO0H,GAAP,GAAa,CAACH,IAAI,CAACvH,CAAL,CAAOwH,GAAP,GAAaD,IAAI,CAACvH,CAAL,CAAOyH,GAArB,IAA4B,CAAzC;IACAF,IAAI,CAACtH,CAAL,CAAOyH,GAAP,GAAa,CAACH,IAAI,CAACtH,CAAL,CAAOuH,GAAP,GAAaD,IAAI,CAACtH,CAAL,CAAOwH,GAArB,IAA4B,CAAzC;;IACA,IAAIF,IAAI,CAACrH,CAAT,EAAY;MACVqH,IAAI,CAACrH,CAAL,CAAOwH,GAAP,GAAa,CAACH,IAAI,CAACrH,CAAL,CAAOsH,GAAP,GAAaD,IAAI,CAACrH,CAAL,CAAOuH,GAArB,IAA4B,CAAzC;IACD;;IACDF,IAAI,CAACvH,CAAL,CAAO2H,IAAP,GAAcJ,IAAI,CAACvH,CAAL,CAAOyH,GAAP,GAAaF,IAAI,CAACvH,CAAL,CAAOwH,GAAlC;IACAD,IAAI,CAACtH,CAAL,CAAO0H,IAAP,GAAcJ,IAAI,CAACtH,CAAL,CAAOwH,GAAP,GAAaF,IAAI,CAACtH,CAAL,CAAOuH,GAAlC;;IACA,IAAID,IAAI,CAACrH,CAAT,EAAY;MACVqH,IAAI,CAACrH,CAAL,CAAOyH,IAAP,GAAcJ,IAAI,CAACrH,CAAL,CAAOuH,GAAP,GAAaF,IAAI,CAACrH,CAAL,CAAOsH,GAAlC;IACD;EACF,CAlwBW;EAowBZmF,aAAa,EAAE,uBAAU5D,EAAV,EAAcC,EAAd,EAAkBf,0BAAlB,EAA8C;IAC3D,IAAM2E,GAAG,GAAG7D,EAAE,CAACxB,IAAH,EAAZ;IAAA,IACEsF,GAAG,GAAG7D,EAAE,CAACzB,IAAH,EADR;IAAA,IAEEvF,CAAC,GAAG,MAFN;IAAA,IAGE8K,SAAS,GAAG7E,0BAA0B,IAAI,GAH5C;;IAKA,IACE2E,GAAG,CAAC5M,CAAJ,CAAM2H,IAAN,GAAaiF,GAAG,CAAC3M,CAAJ,CAAM0H,IAAnB,GAA0BmF,SAA1B,IACAD,GAAG,CAAC7M,CAAJ,CAAM2H,IAAN,GAAakF,GAAG,CAAC5M,CAAJ,CAAM0H,IAAnB,GAA0BmF,SAF5B,EAGE;MACA,OAAO,CACL,CAAG9K,CAAC,IAAI+G,EAAE,CAACgE,GAAH,GAAShE,EAAE,CAACiE,GAAhB,CAAF,GAA0B,CAA3B,GAAgC,CAAjC,IAAsChL,CAAtC,GACE,GADF,GAEE,CAAGA,CAAC,IAAIgH,EAAE,CAAC+D,GAAH,GAAS/D,EAAE,CAACgE,GAAhB,CAAF,GAA0B,CAA3B,GAAgC,CAAjC,IAAsChL,CAHnC,CAAP;IAKD;;IAED,IAAIiL,GAAG,GAAGlE,EAAE,CAACmE,KAAH,CAAS,GAAT,CAAV;IAAA,IACEC,GAAG,GAAGnE,EAAE,CAACkE,KAAH,CAAS,GAAT,CADR;IAAA,IAEEE,KAAK,GAAG,CACN;MAAEC,IAAI,EAAEJ,GAAG,CAACI,IAAZ;MAAkBC,KAAK,EAAEH,GAAG,CAACE;IAA7B,CADM,EAEN;MAAEA,IAAI,EAAEJ,GAAG,CAACI,IAAZ;MAAkBC,KAAK,EAAEH,GAAG,CAACG;IAA7B,CAFM,EAGN;MAAED,IAAI,EAAEJ,GAAG,CAACK,KAAZ;MAAmBA,KAAK,EAAEH,GAAG,CAACG;IAA9B,CAHM,EAIN;MAAED,IAAI,EAAEJ,GAAG,CAACK,KAAZ;MAAmBA,KAAK,EAAEH,GAAG,CAACE;IAA9B,CAJM,CAFV;IASAD,KAAK,GAAGA,KAAK,CAAChD,MAAN,CAAa,UAAUmD,IAAV,EAAgB;MACnC,OAAOpN,KAAK,CAAC+H,WAAN,CAAkBqF,IAAI,CAACF,IAAL,CAAU9F,IAAV,EAAlB,EAAoCgG,IAAI,CAACD,KAAL,CAAW/F,IAAX,EAApC,CAAP;IACD,CAFO,CAAR;IAIA,IAAIiG,OAAO,GAAG,EAAd;IAEA,IAAIJ,KAAK,CAACrM,MAAN,KAAiB,CAArB,EAAwB,OAAOyM,OAAP;IAExBJ,KAAK,CAAC1H,OAAN,CAAc,UAAU6H,IAAV,EAAgB;MAC5BC,OAAO,GAAGA,OAAO,CAAC/D,MAAR,CACRtJ,KAAK,CAACwM,aAAN,CAAoBY,IAAI,CAACF,IAAzB,EAA+BE,IAAI,CAACD,KAApC,EAA2CR,SAA3C,CADQ,CAAV;IAGD,CAJD;IAMAU,OAAO,GAAGA,OAAO,CAACpD,MAAR,CAAe,UAAUhL,CAAV,EAAawC,CAAb,EAAgB;MACvC,OAAO4L,OAAO,CAAC3I,OAAR,CAAgBzF,CAAhB,MAAuBwC,CAA9B;IACD,CAFS,CAAV;IAIA,OAAO4L,OAAP;EACD,CAjzBW;EAmzBZC,UAAU,EAAE,oBAAUxI,EAAV,EAAcC,EAAd,EAAkB2B,EAAlB,EAAsB;IAChC,IAAMxC,GAAG,GAAGa,EAAE,CAAClF,CAAH,GAAOiF,EAAE,CAACjF,CAAtB;IAAA,IACEsE,GAAG,GAAGY,EAAE,CAACjF,CAAH,GAAOgF,EAAE,CAAChF,CADlB;IAAA,IAEEsE,GAAG,GAAGsC,EAAE,CAAC7G,CAAH,GAAOkF,EAAE,CAAClF,CAFlB;IAAA,IAGEwE,GAAG,GAAGqC,EAAE,CAAC5G,CAAH,GAAOiF,EAAE,CAACjF,CAHlB;IAAA,IAIEyN,IAAI,GAAGrJ,GAAG,GAAGxF,GAAG,CAACW,KAAD,CAAT,GAAmB8E,GAAG,GAAGxF,GAAG,CAACU,KAAD,CAJrC;IAAA,IAKEmO,IAAI,GAAGtJ,GAAG,GAAGvF,GAAG,CAACU,KAAD,CAAT,GAAmB8E,GAAG,GAAGzF,GAAG,CAACW,KAAD,CALrC;IAAA,IAMEoO,IAAI,GAAGrJ,GAAG,GAAG1F,GAAG,CAACW,KAAD,CAAT,GAAmBgF,GAAG,GAAG1F,GAAG,CAACU,KAAD,CANrC;IAAA,IAOEqO,IAAI,GAAGtJ,GAAG,GAAGzF,GAAG,CAACU,KAAD,CAAT,GAAmBgF,GAAG,GAAG3F,GAAG,CAACW,KAAD,CAPrC;IAAA,IAQE;IACAsO,GAAG,GAAG,CAAC7I,EAAE,CAACjF,CAAH,GAAOkF,EAAE,CAAClF,CAAX,IAAgB,CATxB;IAAA,IAUE+N,GAAG,GAAG,CAAC9I,EAAE,CAAChF,CAAH,GAAOiF,EAAE,CAACjF,CAAX,IAAgB,CAVxB;IAAA,IAWE+N,GAAG,GAAG,CAAC9I,EAAE,CAAClF,CAAH,GAAO6G,EAAE,CAAC7G,CAAX,IAAgB,CAXxB;IAAA,IAYEiO,GAAG,GAAG,CAAC/I,EAAE,CAACjF,CAAH,GAAO4G,EAAE,CAAC5G,CAAX,IAAgB,CAZxB;IAAA,IAaE;IACAiO,IAAI,GAAGJ,GAAG,GAAGJ,IAdf;IAAA,IAeES,IAAI,GAAGJ,GAAG,GAAGJ,IAff;IAAA,IAgBES,IAAI,GAAGJ,GAAG,GAAGJ,IAhBf;IAAA,IAiBES,IAAI,GAAGJ,GAAG,GAAGJ,IAjBf;IAAA,IAkBE;IACAS,GAAG,GAAGnO,KAAK,CAAC8F,IAAN,CAAW6H,GAAX,EAAgBC,GAAhB,EAAqBG,IAArB,EAA2BC,IAA3B,EAAiCH,GAAjC,EAAsCC,GAAtC,EAA2CG,IAA3C,EAAiDC,IAAjD,CAnBR;IAAA,IAoBErM,CAAC,GAAG7B,KAAK,CAAC6E,IAAN,CAAWsJ,GAAX,EAAgBrJ,EAAhB,CApBN,CADgC,CAuBhC;;IACA,IAAInB,CAAC,GAAG9E,KAAK,CAACiG,EAAE,CAAChF,CAAH,GAAOqO,GAAG,CAACrO,CAAZ,EAAegF,EAAE,CAACjF,CAAH,GAAOsO,GAAG,CAACtO,CAA1B,CAAb;IAAA,IACE4C,CAAC,GAAG5D,KAAK,CAACkG,EAAE,CAACjF,CAAH,GAAOqO,GAAG,CAACrO,CAAZ,EAAeiF,EAAE,CAAClF,CAAH,GAAOsO,GAAG,CAACtO,CAA1B,CADX;IAAA,IAEEuO,CAAC,GAAGvP,KAAK,CAAC6H,EAAE,CAAC5G,CAAH,GAAOqO,GAAG,CAACrO,CAAZ,EAAe4G,EAAE,CAAC7G,CAAH,GAAOsO,GAAG,CAACtO,CAA1B,CAFX;IAAA,IAGEwO,CAHF,CAxBgC,CA6BhC;;;IACA,IAAI1K,CAAC,GAAGyK,CAAR,EAAW;MACT;MACA;MACA;MACA,IAAIzK,CAAC,GAAGlB,CAAJ,IAASA,CAAC,GAAG2L,CAAjB,EAAoB;QAClBzK,CAAC,IAAIvE,GAAL;MACD;;MACD,IAAIuE,CAAC,GAAGyK,CAAR,EAAW;QACTC,CAAC,GAAGD,CAAJ;QACAA,CAAC,GAAGzK,CAAJ;QACAA,CAAC,GAAG0K,CAAJ;MACD;IACF,CAZD,MAYO;MACL;MACA;MACA;MACA,IAAID,CAAC,GAAG3L,CAAJ,IAASA,CAAC,GAAGkB,CAAjB,EAAoB;QAClB0K,CAAC,GAAGD,CAAJ;QACAA,CAAC,GAAGzK,CAAJ;QACAA,CAAC,GAAG0K,CAAJ;MACD,CAJD,MAIO;QACLD,CAAC,IAAIhP,GAAL;MACD;IACF,CArD+B,CAsDhC;;;IACA+O,GAAG,CAACxK,CAAJ,GAAQA,CAAR;IACAwK,GAAG,CAACC,CAAJ,GAAQA,CAAR;IACAD,GAAG,CAACtM,CAAJ,GAAQA,CAAR;IACA,OAAOsM,GAAP;EACD,CA92BW;EAg3BZG,UAAU,EAAE,oBAAUpN,CAAV,EAAaC,CAAb,EAAgB;IAC1B,OAAOD,CAAC,GAAGC,CAAX;EACD;AAl3BW,CAAd;AAq3BA,SAASnB,KAAT"},"metadata":{},"sourceType":"module"}